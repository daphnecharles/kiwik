{"ast":null,"code":"var __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\n      ar.push(r.value);\n    }\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nvar __spread = this && this.__spread || function () {\n  for (var ar = [], i = 0; i < arguments.length; i++) {\n    ar = ar.concat(__read(arguments[i]));\n  }\n\n  return ar;\n};\n\nvar QueryStore = function () {\n  function QueryStore(key, storage, maxSize) {\n    if (maxSize === void 0) {\n      maxSize = null;\n    }\n\n    this.key = key;\n    this.storage = storage;\n    this.maxSize = maxSize;\n    this.items = this.fetchAll();\n  }\n\n  Object.defineProperty(QueryStore.prototype, \"length\", {\n    get: function get() {\n      return this.items.length;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  QueryStore.prototype.contains = function (item) {\n    return this.items.some(function (x) {\n      return x.query === item.query && x.variables === item.variables && x.headers === item.headers && x.operationName === item.operationName;\n    });\n  };\n\n  QueryStore.prototype.edit = function (item) {\n    var itemIndex = this.items.findIndex(function (x) {\n      return x.query === item.query && x.variables === item.variables && x.headers === item.headers && x.operationName === item.operationName;\n    });\n\n    if (itemIndex !== -1) {\n      this.items.splice(itemIndex, 1, item);\n      this.save();\n    }\n  };\n\n  QueryStore.prototype.delete = function (item) {\n    var itemIndex = this.items.findIndex(function (x) {\n      return x.query === item.query && x.variables === item.variables && x.headers === item.headers && x.operationName === item.operationName;\n    });\n\n    if (itemIndex !== -1) {\n      this.items.splice(itemIndex, 1);\n      this.save();\n    }\n  };\n\n  QueryStore.prototype.fetchRecent = function () {\n    return this.items[this.items.length - 1];\n  };\n\n  QueryStore.prototype.fetchAll = function () {\n    var raw = this.storage.get(this.key);\n\n    if (raw) {\n      return JSON.parse(raw)[this.key];\n    }\n\n    return [];\n  };\n\n  QueryStore.prototype.push = function (item) {\n    var _a;\n\n    var items = __spread(this.items, [item]);\n\n    if (this.maxSize && items.length > this.maxSize) {\n      items.shift();\n    }\n\n    for (var attempts = 0; attempts < 5; attempts++) {\n      var response = this.storage.set(this.key, JSON.stringify((_a = {}, _a[this.key] = items, _a)));\n\n      if (!response || !response.error) {\n        this.items = items;\n      } else if (response.isQuotaError && this.maxSize) {\n        items.shift();\n      } else {\n        return;\n      }\n    }\n  };\n\n  QueryStore.prototype.save = function () {\n    var _a;\n\n    this.storage.set(this.key, JSON.stringify((_a = {}, _a[this.key] = this.items, _a)));\n  };\n\n  return QueryStore;\n}();\n\nexport default QueryStore;","map":{"version":3,"sources":["../../src/utility/QueryStore.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["var __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spread = (this && this.__spread) || function () {\n    for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\n    return ar;\n};\nvar QueryStore = (function () {\n    function QueryStore(key, storage, maxSize) {\n        if (maxSize === void 0) { maxSize = null; }\n        this.key = key;\n        this.storage = storage;\n        this.maxSize = maxSize;\n        this.items = this.fetchAll();\n    }\n    Object.defineProperty(QueryStore.prototype, \"length\", {\n        get: function () {\n            return this.items.length;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    QueryStore.prototype.contains = function (item) {\n        return this.items.some(function (x) {\n            return x.query === item.query &&\n                x.variables === item.variables &&\n                x.headers === item.headers &&\n                x.operationName === item.operationName;\n        });\n    };\n    QueryStore.prototype.edit = function (item) {\n        var itemIndex = this.items.findIndex(function (x) {\n            return x.query === item.query &&\n                x.variables === item.variables &&\n                x.headers === item.headers &&\n                x.operationName === item.operationName;\n        });\n        if (itemIndex !== -1) {\n            this.items.splice(itemIndex, 1, item);\n            this.save();\n        }\n    };\n    QueryStore.prototype.delete = function (item) {\n        var itemIndex = this.items.findIndex(function (x) {\n            return x.query === item.query &&\n                x.variables === item.variables &&\n                x.headers === item.headers &&\n                x.operationName === item.operationName;\n        });\n        if (itemIndex !== -1) {\n            this.items.splice(itemIndex, 1);\n            this.save();\n        }\n    };\n    QueryStore.prototype.fetchRecent = function () {\n        return this.items[this.items.length - 1];\n    };\n    QueryStore.prototype.fetchAll = function () {\n        var raw = this.storage.get(this.key);\n        if (raw) {\n            return JSON.parse(raw)[this.key];\n        }\n        return [];\n    };\n    QueryStore.prototype.push = function (item) {\n        var _a;\n        var items = __spread(this.items, [item]);\n        if (this.maxSize && items.length > this.maxSize) {\n            items.shift();\n        }\n        for (var attempts = 0; attempts < 5; attempts++) {\n            var response = this.storage.set(this.key, JSON.stringify((_a = {}, _a[this.key] = items, _a)));\n            if (!response || !response.error) {\n                this.items = items;\n            }\n            else if (response.isQuotaError && this.maxSize) {\n                items.shift();\n            }\n            else {\n                return;\n            }\n        }\n    };\n    QueryStore.prototype.save = function () {\n        var _a;\n        this.storage.set(this.key, JSON.stringify((_a = {}, _a[this.key] = this.items, _a)));\n    };\n    return QueryStore;\n}());\nexport default QueryStore;\n//# sourceMappingURL=QueryStore.js.map"]},"metadata":{},"sourceType":"module"}