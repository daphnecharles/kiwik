{"ast":null,"code":"import { useRef, useEffect, useCallback } from 'react';\nvar DEBUG = false;\n/**\n * @see useOnRepetition for a newer implementation\n * helper hook to call a function regularly at time intervals when the block changes.\n * @param provider ethers/web3 provider\n * @param callbackFn any function\n * @param args function parameters\n */\n\nexport var useOnBlock = function useOnBlock(provider, callbackFn) {\n  for (var _len = arguments.length, args = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n    args[_key - 2] = arguments[_key];\n  }\n\n  // save the input function provided\n  var savedCallback = useRef();\n  useEffect(function () {\n    savedCallback.current = callbackFn;\n  }, [callbackFn]); // Turn on the listener if we have a function & a provider\n\n  var listener = useCallback(function (blockNumber) {\n    if (provider) {\n      if (DEBUG) console.log(blockNumber, callbackFn, args, provider.listeners());\n\n      if (savedCallback.current) {\n        if (args && args.length > 0) {\n          savedCallback.current.apply(savedCallback, args);\n        } else {\n          savedCallback.current();\n        }\n      }\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, []);\n  useEffect(function () {\n    if (provider) {\n      provider.on('block', listener);\n      return function () {\n        provider.off('block', listener);\n      };\n    } else {\n      return function () {\n        /* cleanup */\n      };\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, [provider]);\n};","map":{"version":3,"sources":["/Users/sam/Desktop/kiwik/node_modules/eth-hooks/useOnBlock.js"],"names":["useRef","useEffect","useCallback","DEBUG","useOnBlock","provider","callbackFn","args","savedCallback","current","listener","blockNumber","console","log","listeners","length","on","off"],"mappings":"AAAA,SAASA,MAAT,EAAiBC,SAAjB,EAA4BC,WAA5B,QAA+C,OAA/C;AACA,IAAMC,KAAK,GAAG,KAAd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,OAAO,IAAMC,UAAU,GAAG,SAAbA,UAAa,CAACC,QAAD,EAAWC,UAAX,EAAmC;AAAA,oCAATC,IAAS;AAATA,IAAAA,IAAS;AAAA;;AACzD;AACA,MAAMC,aAAa,GAAGR,MAAM,EAA5B;AACAC,EAAAA,SAAS,CAAC,YAAM;AACZO,IAAAA,aAAa,CAACC,OAAd,GAAwBH,UAAxB;AACH,GAFQ,EAEN,CAACA,UAAD,CAFM,CAAT,CAHyD,CAMzD;;AACA,MAAMI,QAAQ,GAAGR,WAAW,CAAC,UAACS,WAAD,EAAiB;AAC1C,QAAIN,QAAJ,EAAc;AACV,UAAIF,KAAJ,EACIS,OAAO,CAACC,GAAR,CAAYF,WAAZ,EAAyBL,UAAzB,EAAqCC,IAArC,EAA2CF,QAAQ,CAACS,SAAT,EAA3C;;AACJ,UAAIN,aAAa,CAACC,OAAlB,EAA2B;AACvB,YAAIF,IAAI,IAAIA,IAAI,CAACQ,MAAL,GAAc,CAA1B,EAA6B;AACzBP,UAAAA,aAAa,CAACC,OAAd,OAAAD,aAAa,EAAYD,IAAZ,CAAb;AACH,SAFD,MAGK;AACDC,UAAAA,aAAa,CAACC,OAAd;AACH;AACJ;AACJ,KAZyC,CAa1C;;AACH,GAd2B,EAczB,EAdyB,CAA5B;AAeAR,EAAAA,SAAS,CAAC,YAAM;AACZ,QAAII,QAAJ,EAAc;AACVA,MAAAA,QAAQ,CAACW,EAAT,CAAY,OAAZ,EAAqBN,QAArB;AACA,aAAO,YAAM;AACTL,QAAAA,QAAQ,CAACY,GAAT,CAAa,OAAb,EAAsBP,QAAtB;AACH,OAFD;AAGH,KALD,MAMK;AACD,aAAO,YAAM;AACT;AACH,OAFD;AAGH,KAXW,CAYZ;;AACH,GAbQ,EAaN,CAACL,QAAD,CAbM,CAAT;AAcH,CApCM","sourcesContent":["import { useRef, useEffect, useCallback } from 'react';\nconst DEBUG = false;\n/**\n * @see useOnRepetition for a newer implementation\n * helper hook to call a function regularly at time intervals when the block changes.\n * @param provider ethers/web3 provider\n * @param callbackFn any function\n * @param args function parameters\n */\nexport const useOnBlock = (provider, callbackFn, ...args) => {\n    // save the input function provided\n    const savedCallback = useRef();\n    useEffect(() => {\n        savedCallback.current = callbackFn;\n    }, [callbackFn]);\n    // Turn on the listener if we have a function & a provider\n    const listener = useCallback((blockNumber) => {\n        if (provider) {\n            if (DEBUG)\n                console.log(blockNumber, callbackFn, args, provider.listeners());\n            if (savedCallback.current) {\n                if (args && args.length > 0) {\n                    savedCallback.current(...args);\n                }\n                else {\n                    savedCallback.current();\n                }\n            }\n        }\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, []);\n    useEffect(() => {\n        if (provider) {\n            provider.on('block', listener);\n            return () => {\n                provider.off('block', listener);\n            };\n        }\n        else {\n            return () => {\n                /* cleanup */\n            };\n        }\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [provider]);\n};\n"]},"metadata":{},"sourceType":"module"}