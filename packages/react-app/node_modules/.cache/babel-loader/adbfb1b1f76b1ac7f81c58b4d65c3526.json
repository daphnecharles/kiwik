{"ast":null,"code":"import _slicedToArray from \"/Users/sam/Desktop/kiwik/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _regeneratorRuntime from \"/Users/sam/Desktop/kiwik/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/sam/Desktop/kiwik/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { utils } from 'ethers';\nimport { useState, useEffect } from 'react';\n\nvar lookupAddress = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(provider, address) {\n    var reportedName, resolvedAddress;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (!utils.isAddress(address)) {\n              _context.next = 18;\n              break;\n            }\n\n            _context.prev = 1;\n            _context.next = 4;\n            return provider.lookupAddress(address);\n\n          case 4:\n            reportedName = _context.sent;\n            _context.next = 7;\n            return provider.resolveName(reportedName);\n\n          case 7:\n            resolvedAddress = _context.sent;\n\n            if (!(address && utils.getAddress(address) === utils.getAddress(resolvedAddress))) {\n              _context.next = 12;\n              break;\n            }\n\n            return _context.abrupt(\"return\", reportedName);\n\n          case 12:\n            return _context.abrupt(\"return\", utils.getAddress(address));\n\n          case 13:\n            _context.next = 18;\n            break;\n\n          case 15:\n            _context.prev = 15;\n            _context.t0 = _context[\"catch\"](1);\n            return _context.abrupt(\"return\", utils.getAddress(address));\n\n          case 18:\n            return _context.abrupt(\"return\", '');\n\n          case 19:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[1, 15]]);\n  }));\n\n  return function lookupAddress(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\n/**\n * Gets ENS name from given address and provider\n * @param provider (TEthersProvider)\n * @param address (string)\n * @returns (string) ens name\n */\n\n\nexport var useLookupAddress = function useLookupAddress(provider, address) {\n  var _useState = useState(address),\n      _useState2 = _slicedToArray(_useState, 2),\n      ensName = _useState2[0],\n      setEnsName = _useState2[1];\n\n  useEffect(function () {\n    var storedData = window.localStorage.getItem('ensCache_' + address);\n    var cache = JSON.parse(storedData !== null && storedData !== void 0 ? storedData : '{}');\n\n    if (cache && (cache === null || cache === void 0 ? void 0 : cache.name) && (cache === null || cache === void 0 ? void 0 : cache.timestamp) > Date.now()) {\n      setEnsName(cache === null || cache === void 0 ? void 0 : cache.name);\n    } else if (provider) {\n      void lookupAddress(provider, address).then(function (name) {\n        if (name) {\n          setEnsName(name);\n          window.localStorage.setItem('ensCache_' + address, JSON.stringify({\n            timestamp: Date.now() + 360000,\n            name: name\n          }));\n        }\n      });\n    }\n  }, [address, provider, setEnsName]);\n  return ensName;\n};","map":{"version":3,"sources":["/Users/sam/Desktop/kiwik/node_modules/eth-hooks/dapps/ens/useLookupAddress.js"],"names":["utils","useState","useEffect","lookupAddress","provider","address","isAddress","reportedName","resolveName","resolvedAddress","getAddress","useLookupAddress","ensName","setEnsName","storedData","window","localStorage","getItem","cache","JSON","parse","name","timestamp","Date","now","then","setItem","stringify"],"mappings":";;;AAAA,SAASA,KAAT,QAAsB,QAAtB;AACA,SAASC,QAAT,EAAmBC,SAAnB,QAAoC,OAApC;;AACA,IAAMC,aAAa;AAAA,sEAAG,iBAAOC,QAAP,EAAiBC,OAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBACdL,KAAK,CAACM,SAAN,CAAgBD,OAAhB,CADc;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,mBAKiBD,QAAQ,CAACD,aAAT,CAAuBE,OAAvB,CALjB;;AAAA;AAKJE,YAAAA,YALI;AAAA;AAAA,mBAMoBH,QAAQ,CAACI,WAAT,CAAqBD,YAArB,CANpB;;AAAA;AAMJE,YAAAA,eANI;;AAAA,kBAONJ,OAAO,IAAIL,KAAK,CAACU,UAAN,CAAiBL,OAAjB,MAA8BL,KAAK,CAACU,UAAN,CAAiBD,eAAjB,CAPnC;AAAA;AAAA;AAAA;;AAAA,6CAQCF,YARD;;AAAA;AAAA,6CAWCP,KAAK,CAACU,UAAN,CAAiBL,OAAjB,CAXD;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA,6CAeHL,KAAK,CAACU,UAAN,CAAiBL,OAAjB,CAfG;;AAAA;AAAA,6CAkBX,EAlBW;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAbF,aAAa;AAAA;AAAA;AAAA,GAAnB;AAoBA;AACA;AACA;AACA;AACA;AACA;;;AACA,OAAO,IAAMQ,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACP,QAAD,EAAWC,OAAX,EAAuB;AACnD,kBAA8BJ,QAAQ,CAACI,OAAD,CAAtC;AAAA;AAAA,MAAOO,OAAP;AAAA,MAAgBC,UAAhB;;AACAX,EAAAA,SAAS,CAAC,YAAM;AACZ,QAAMY,UAAU,GAAGC,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,cAAcZ,OAA1C,CAAnB;AACA,QAAMa,KAAK,GAAGC,IAAI,CAACC,KAAL,CAAWN,UAAU,KAAK,IAAf,IAAuBA,UAAU,KAAK,KAAK,CAA3C,GAA+CA,UAA/C,GAA4D,IAAvE,CAAd;;AACA,QAAII,KAAK,KAAKA,KAAK,KAAK,IAAV,IAAkBA,KAAK,KAAK,KAAK,CAAjC,GAAqC,KAAK,CAA1C,GAA8CA,KAAK,CAACG,IAAzD,CAAL,IAAuE,CAACH,KAAK,KAAK,IAAV,IAAkBA,KAAK,KAAK,KAAK,CAAjC,GAAqC,KAAK,CAA1C,GAA8CA,KAAK,CAACI,SAArD,IAAkEC,IAAI,CAACC,GAAL,EAA7I,EAAyJ;AACrJX,MAAAA,UAAU,CAACK,KAAK,KAAK,IAAV,IAAkBA,KAAK,KAAK,KAAK,CAAjC,GAAqC,KAAK,CAA1C,GAA8CA,KAAK,CAACG,IAArD,CAAV;AACH,KAFD,MAGK,IAAIjB,QAAJ,EAAc;AACf,WAAKD,aAAa,CAACC,QAAD,EAAWC,OAAX,CAAb,CAAiCoB,IAAjC,CAAsC,UAACJ,IAAD,EAAU;AACjD,YAAIA,IAAJ,EAAU;AACNR,UAAAA,UAAU,CAACQ,IAAD,CAAV;AACAN,UAAAA,MAAM,CAACC,YAAP,CAAoBU,OAApB,CAA4B,cAAcrB,OAA1C,EAAmDc,IAAI,CAACQ,SAAL,CAAe;AAC9DL,YAAAA,SAAS,EAAEC,IAAI,CAACC,GAAL,KAAa,MADsC;AAE9DH,YAAAA,IAAI,EAAJA;AAF8D,WAAf,CAAnD;AAIH;AACJ,OARI,CAAL;AASH;AACJ,GAjBQ,EAiBN,CAAChB,OAAD,EAAUD,QAAV,EAAoBS,UAApB,CAjBM,CAAT;AAkBA,SAAOD,OAAP;AACH,CArBM","sourcesContent":["import { utils } from 'ethers';\nimport { useState, useEffect } from 'react';\nconst lookupAddress = async (provider, address) => {\n    if (utils.isAddress(address)) {\n        try {\n            // Accuracy of reverse resolution is not enforced.\n            // We then manually ensure that the reported ens name resolves to address\n            const reportedName = await provider.lookupAddress(address);\n            const resolvedAddress = await provider.resolveName(reportedName);\n            if (address && utils.getAddress(address) === utils.getAddress(resolvedAddress)) {\n                return reportedName;\n            }\n            else {\n                return utils.getAddress(address);\n            }\n        }\n        catch (e) {\n            return utils.getAddress(address);\n        }\n    }\n    return '';\n};\n/**\n * Gets ENS name from given address and provider\n * @param provider (TEthersProvider)\n * @param address (string)\n * @returns (string) ens name\n */\nexport const useLookupAddress = (provider, address) => {\n    const [ensName, setEnsName] = useState(address);\n    useEffect(() => {\n        const storedData = window.localStorage.getItem('ensCache_' + address);\n        const cache = JSON.parse(storedData !== null && storedData !== void 0 ? storedData : '{}');\n        if (cache && (cache === null || cache === void 0 ? void 0 : cache.name) && (cache === null || cache === void 0 ? void 0 : cache.timestamp) > Date.now()) {\n            setEnsName(cache === null || cache === void 0 ? void 0 : cache.name);\n        }\n        else if (provider) {\n            void lookupAddress(provider, address).then((name) => {\n                if (name) {\n                    setEnsName(name);\n                    window.localStorage.setItem('ensCache_' + address, JSON.stringify({\n                        timestamp: Date.now() + 360000,\n                        name,\n                    }));\n                }\n            });\n        }\n    }, [address, provider, setEnsName]);\n    return ensName;\n};\n"]},"metadata":{},"sourceType":"module"}