{"ast":null,"code":"/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\nvar _assign = function __assign() {\n  _assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return _assign.apply(this, arguments);\n};\n\nfunction __rest(s, e) {\n  var t = {};\n\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n}\n\nfunction __awaiter(thisArg, _arguments, P, generator) {\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : new P(function (resolve) {\n        resolve(result.value);\n      }).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n}\n\nfunction __generator(thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function sent() {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) {\n      try {\n        if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n        if (y = 0, t) op = [op[0] & 2, t.value];\n\n        switch (op[0]) {\n          case 0:\n          case 1:\n            t = op;\n            break;\n\n          case 4:\n            _.label++;\n            return {\n              value: op[1],\n              done: false\n            };\n\n          case 5:\n            _.label++;\n            y = op[1];\n            op = [0];\n            continue;\n\n          case 7:\n            op = _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n\n          default:\n            if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n              _ = 0;\n              continue;\n            }\n\n            if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n              _.label = op[1];\n              break;\n            }\n\n            if (op[0] === 6 && _.label < t[1]) {\n              _.label = t[1];\n              t = op;\n              break;\n            }\n\n            if (t && _.label < t[2]) {\n              _.label = t[2];\n\n              _.ops.push(op);\n\n              break;\n            }\n\n            if (t[2]) _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n        }\n\n        op = body.call(thisArg, _);\n      } catch (e) {\n        op = [6, e];\n        y = 0;\n      } finally {\n        f = t = 0;\n      }\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n}\n\nfunction __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) {\n    s += arguments[i].length;\n  }\n\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) {\n    for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) {\n      r[k] = a[j];\n    }\n  }\n\n  return r;\n}\n\nvar commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\nfunction unwrapExports(x) {\n  return x && x.__esModule && Object.prototype.hasOwnProperty.call(x, 'default') ? x['default'] : x;\n}\n\nfunction createCommonjsModule(fn, module) {\n  return module = {\n    exports: {}\n  }, fn(module, module.exports), module.exports;\n}\n\nvar bodyScrollLock_min = createCommonjsModule(function (module, exports) {\n  !function (e, t) {\n    t(exports);\n  }(commonjsGlobal, function (exports) {\n    function r(e) {\n      if (Array.isArray(e)) {\n        for (var t = 0, o = Array(e.length); t < e.length; t++) {\n          o[t] = e[t];\n        }\n\n        return o;\n      }\n\n      return Array.from(e);\n    }\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: !0\n    });\n    var l = !1;\n\n    if (\"undefined\" != typeof window) {\n      var e = {\n        get passive() {\n          l = !0;\n        }\n\n      };\n      window.addEventListener(\"testPassive\", null, e), window.removeEventListener(\"testPassive\", null, e);\n    }\n\n    var d = \"undefined\" != typeof window && window.navigator && window.navigator.platform && /iP(ad|hone|od)/.test(window.navigator.platform),\n        c = [],\n        u = !1,\n        a = -1,\n        s = void 0,\n        v = void 0,\n        f = function f(t) {\n      return c.some(function (e) {\n        return !(!e.options.allowTouchMove || !e.options.allowTouchMove(t));\n      });\n    },\n        m = function m(e) {\n      var t = e || window.event;\n      return !!f(t.target) || 1 < t.touches.length || (t.preventDefault && t.preventDefault(), !1);\n    },\n        o = function o() {\n      setTimeout(function () {\n        void 0 !== v && (document.body.style.paddingRight = v, v = void 0), void 0 !== s && (document.body.style.overflow = s, s = void 0);\n      });\n    };\n\n    exports.disableBodyScroll = function (i, e) {\n      if (d) {\n        if (!i) return void console.error(\"disableBodyScroll unsuccessful - targetElement must be provided when calling disableBodyScroll on IOS devices.\");\n\n        if (i && !c.some(function (e) {\n          return e.targetElement === i;\n        })) {\n          var t = {\n            targetElement: i,\n            options: e || {}\n          };\n          c = [].concat(r(c), [t]), i.ontouchstart = function (e) {\n            1 === e.targetTouches.length && (a = e.targetTouches[0].clientY);\n          }, i.ontouchmove = function (e) {\n            var t, o, n, r;\n            1 === e.targetTouches.length && (o = i, r = (t = e).targetTouches[0].clientY - a, !f(t.target) && (o && 0 === o.scrollTop && 0 < r ? m(t) : (n = o) && n.scrollHeight - n.scrollTop <= n.clientHeight && r < 0 ? m(t) : t.stopPropagation()));\n          }, u || (document.addEventListener(\"touchmove\", m, l ? {\n            passive: !1\n          } : void 0), u = !0);\n        }\n      } else {\n        n = e, setTimeout(function () {\n          if (void 0 === v) {\n            var e = !!n && !0 === n.reserveScrollBarGap,\n                t = window.innerWidth - document.documentElement.clientWidth;\n            e && 0 < t && (v = document.body.style.paddingRight, document.body.style.paddingRight = t + \"px\");\n          }\n\n          void 0 === s && (s = document.body.style.overflow, document.body.style.overflow = \"hidden\");\n        });\n        var o = {\n          targetElement: i,\n          options: e || {}\n        };\n        c = [].concat(r(c), [o]);\n      }\n\n      var n;\n    }, exports.clearAllBodyScrollLocks = function () {\n      d ? (c.forEach(function (e) {\n        e.targetElement.ontouchstart = null, e.targetElement.ontouchmove = null;\n      }), u && (document.removeEventListener(\"touchmove\", m, l ? {\n        passive: !1\n      } : void 0), u = !1), c = [], a = -1) : (o(), c = []);\n    }, exports.enableBodyScroll = function (t) {\n      if (d) {\n        if (!t) return void console.error(\"enableBodyScroll unsuccessful - targetElement must be provided when calling enableBodyScroll on IOS devices.\");\n        t.ontouchstart = null, t.ontouchmove = null, c = c.filter(function (e) {\n          return e.targetElement !== t;\n        }), u && 0 === c.length && (document.removeEventListener(\"touchmove\", m, l ? {\n          passive: !1\n        } : void 0), u = !1);\n      } else (c = c.filter(function (e) {\n        return e.targetElement !== t;\n      })).length || o();\n    };\n  });\n});\nvar bodyScrollLock = unwrapExports(bodyScrollLock_min);\nvar baseWidgetUrl = 'https://buy.ramp.network/';\nvar EventSeverity;\n\n(function (EventSeverity) {\n  EventSeverity[\"VERBOSE\"] = \"VERBOSE\";\n  EventSeverity[\"DEBUG\"] = \"DEBUG\";\n  EventSeverity[\"INFO\"] = \"INFO\";\n  EventSeverity[\"WARNING\"] = \"WARNING\";\n  EventSeverity[\"ERROR\"] = \"ERROR\";\n  EventSeverity[\"CRITICAL\"] = \"CRITICAL\";\n})(EventSeverity || (EventSeverity = {}));\n\nvar WidgetEventTypes;\n\n(function (WidgetEventTypes) {\n  WidgetEventTypes[\"WIDGET_CLOSE\"] = \"WIDGET_CLOSE\";\n  WidgetEventTypes[\"WIDGET_CONFIG_DONE\"] = \"WIDGET_CONFIG_DONE\";\n  WidgetEventTypes[\"WIDGET_CONFIG_FAILED\"] = \"WIDGET_CONFIG_FAILED\";\n  WidgetEventTypes[\"PURCHASE_CREATED\"] = \"PURCHASE_CREATED\";\n  WidgetEventTypes[\"PURCHASE_SUCCESSFUL\"] = \"PURCHASE_SUCCESSFUL\";\n  WidgetEventTypes[\"PURCHASE_FAILED\"] = \"PURCHASE_FAILED\";\n})(WidgetEventTypes || (WidgetEventTypes = {}));\n\nvar InternalEventTypes;\n\n(function (InternalEventTypes) {\n  InternalEventTypes[\"WIDGET_CLOSE_REQUEST\"] = \"WIDGET_CLOSE_REQUEST\";\n  InternalEventTypes[\"WIDGET_CLOSE_REQUEST_CANCELLED\"] = \"WIDGET_CLOSE_REQUEST_CANCELLED\";\n  InternalEventTypes[\"WIDGET_CLOSE_REQUEST_CONFIRMED\"] = \"WIDGET_CLOSE_REQUEST_CONFIRMED\";\n})(InternalEventTypes || (InternalEventTypes = {}));\n\nfunction getRandomIntString() {\n  try {\n    return String(crypto.getRandomValues(new Uint32Array(1))[0]);\n  } catch (_a) {\n    // if `crypto` is not supported, fall back to Math.random\n    // tslint:disable-next-line:no-magic-numbers\n    return String(Math.floor(Math.random() * 10000000));\n  }\n}\n\nvar widgetDesktopWidth = 895;\nvar widgetDesktopHeight = 590;\nvar minWidgetMobileWidth = 320;\nvar minWidgetMobileHeight = 667;\n\nfunction normalizeConfigAndLogErrorsOnInvalidFields(config) {\n  var errors = [];\n\n  var configCopy = _assign({}, config);\n\n  if (!['desktop', 'mobile', 'hosted-desktop', 'hosted-mobile', 'hosted-auto', 'auto', 'embedded-desktop', 'embedded-mobile'].includes(config.variant)) {\n    configCopy.variant = 'desktop';\n    errors.push({\n      fieldName: 'variant',\n      description: 'Invalid value for `variant` config field ',\n      exampleValue: \"'desktop'\",\n      severity: EventSeverity.WARNING\n    });\n  }\n\n  if (config.variant === 'embedded-desktop' || config.variant === 'embedded-mobile') {\n    validateContainerNode(config.containerNode, config.variant);\n  }\n\n  if (!['embedded-desktop', 'embedded-mobile'].includes(configCopy.variant)) {\n    delete configCopy.containerNode;\n  }\n\n  logErrors(errors);\n  return configCopy;\n}\n\nfunction logErrors(errors) {\n  if (!errors.length) {\n    return;\n  } // tslint:disable:no-console\n\n\n  console.group('Config errors');\n  errors.forEach(function (error) {\n    console.group(error.fieldName);\n    console.log(error.description);\n    console.log(\"Example expected value: \" + error.exampleValue);\n    console.log(\"Severity: \" + error.severity);\n    console.groupEnd();\n  });\n  console.groupEnd(); // tslint:enable:no-console\n}\n\nfunction initEventListenersDict() {\n  var widgetEventTypes = Array.from(Object.values(WidgetEventTypes));\n  var internalEventTypes = Array.from(Object.values(InternalEventTypes));\n  return __spreadArrays(widgetEventTypes, internalEventTypes).reduce(function (listenersDict, eventType) {\n    listenersDict[eventType] = [];\n    return listenersDict;\n  }, {});\n}\n\nfunction countListenersForEvent(listeners, event, internal) {\n  if (internal === void 0) {\n    internal = false;\n  }\n\n  return listeners[event].filter(function (handler) {\n    return handler.internal === internal;\n  }).length;\n}\n\nfunction determineWidgetVariant(config) {\n  var _a;\n\n  var mediaQuery = '(min-width: 920px) and (min-height: 630px)';\n  var variant = (_a = config.variant) === null || _a === void 0 ? void 0 : _a.toLocaleLowerCase();\n\n  if (variant === 'mobile' || variant === 'desktop' || variant === 'hosted-mobile' || variant === 'hosted-desktop' || variant === 'embedded-desktop' || variant === 'embedded-mobile') {\n    return variant;\n  }\n\n  var isDesktop = window.matchMedia(mediaQuery).matches;\n\n  if (variant === 'hosted-auto') {\n    return isDesktop ? 'hosted-desktop' : 'hosted-mobile';\n  }\n\n  return isDesktop ? 'desktop' : 'mobile';\n}\n\nfunction isHtmlElement(element) {\n  return typeof element.blur === 'function';\n}\n\nfunction validateContainerNode(containerNode, variant) {\n  if (!document.body) {\n    throw new Error(\"Couldn't find <body> element.\");\n  }\n\n  if (!(containerNode instanceof HTMLElement)) {\n    throw new Error('Container node has to be a proper HTML element.');\n  }\n\n  if (!document.body.contains(containerNode)) {\n    throw new Error('Container node must be attached to the document.');\n  }\n\n  var _a = containerNode.getBoundingClientRect(),\n      width = _a.width,\n      height = _a.height;\n\n  if (variant === 'embedded-desktop') {\n    if (width + 1 < widgetDesktopWidth) {\n      throw new Error(\"Container node must be at least \" + widgetDesktopWidth + \"px wide.\");\n    }\n\n    if (height + 1 < widgetDesktopHeight) {\n      throw new Error(\"Container node must be at least \" + widgetDesktopHeight + \"px tall.\");\n    }\n  } else if (variant === 'embedded-mobile') {\n    if (width + 1 < minWidgetMobileWidth) {\n      throw new Error(\"Container node must be at least \" + minWidgetMobileWidth + \"px wide.\");\n    }\n\n    if (height + 1 < minWidgetMobileHeight) {\n      throw new Error(\"Container node must be at least \" + minWidgetMobileHeight + \"px tall.\");\n    }\n  }\n}\n/**\r\n * Concatenates `base` with `path`, always treating `path` as a relative path. Ignores:\r\n *   - trailing slash in `base`\r\n *   - leading slash in `path`\r\n * @param base base URL, e.g.: 'http://example.com/api' or 'http://example.com/service/api/'\r\n * @param path path to append, e.g.: 'user/getByEmail' or '/swap'\r\n */\n\n\nfunction concatRelativePath(base, path) {\n  var normalizedBase = urlWithoutTrailingSlash(base instanceof URL ? base.href : base);\n  var normalizedPath = path.startsWith('/') ? path.substr(1) : path;\n  return new URL(normalizedBase + \"/\" + normalizedPath);\n}\n\nfunction urlWithoutTrailingSlash(url) {\n  return url.endsWith('/') ? url.slice(0, -1) : url;\n}\n\nfunction doFetchPurchase(apiUrl, purchaseExternalId, token) {\n  return __awaiter(this, void 0, void 0, function () {\n    var rawResponse, response, _a;\n\n    return __generator(this, function (_b) {\n      switch (_b.label) {\n        case 0:\n          _b.trys.push([0, 3,, 4]);\n\n          return [4\n          /*yield*/\n          , fetch(concatRelativePath(apiUrl, \"/host-api/purchase/\" + purchaseExternalId + \"?secret=\" + token).href, {\n            headers: {\n              'Content-Type': 'application/json'\n            }\n          })];\n\n        case 1:\n          rawResponse = _b.sent();\n\n          if (!rawResponse.ok) {\n            throw new Error(\"Request for purchase #\" + purchaseExternalId + \" failed\");\n          }\n\n          return [4\n          /*yield*/\n          , rawResponse.json()];\n\n        case 2:\n          response = _b.sent();\n          return [2\n          /*return*/\n          , response];\n\n        case 3:\n          _a = _b.sent();\n          return [2\n          /*return*/\n          , null];\n\n        case 4:\n          return [2\n          /*return*/\n          ];\n      }\n    });\n  });\n}\n\nfunction delay(ms) {\n  return __awaiter(this, void 0, void 0, function () {\n    return __generator(this, function (_a) {\n      return [2\n      /*return*/\n      , new Promise(function (resolve) {\n        return setTimeout(resolve, ms);\n      })];\n    });\n  });\n}\n\nfunction initWidgetIframeUrl(config) {\n  var baseUrl = new URL(config.url || baseWidgetUrl);\n  var hostUrl = window.location.origin;\n\n  var containerNode = config.containerNode,\n      url = config.url,\n      configWithoutIframeUrl = __rest(config, [\"containerNode\", \"url\"]);\n\n  var preparedConfig = _assign(_assign({}, configWithoutIframeUrl), {\n    hostUrl: hostUrl\n  });\n\n  Object.entries(preparedConfig).forEach(function (_a) {\n    var key = _a[0],\n        value = _a[1];\n\n    if (value) {\n      baseUrl.searchParams.append(key, value);\n    }\n  });\n  return baseUrl.toString();\n}\n\nfunction hideWebsiteBelow(parent, containerWidth) {\n  var backgroundWebsiteHider = document.createElement('div');\n  backgroundWebsiteHider.classList.add('background-hider');\n\n  if (containerWidth) {\n    backgroundWebsiteHider.style.maxWidth = containerWidth + \"px\";\n  }\n\n  parent.appendChild(backgroundWebsiteHider);\n}\n\nfunction initDOMNodeWithOverlay(url, dispatch, config) {\n  var body = document.querySelector('body');\n  var shadowHost = document.createElement('div');\n  shadowHost.style.width = '100%';\n  shadowHost.style.height = '100%';\n  var shadow = shadowHost.attachShadow({\n    mode: 'open'\n  });\n  shadow.appendChild(getStylesForShadowDom(config.variant));\n  var iframe = prepareIframeNode(url, config.variant);\n  var overlay = prepareOverlayNode(iframe, dispatch);\n  overlay.appendChild(iframe);\n  shadow.appendChild(overlay);\n  return {\n    body: body,\n    iframe: iframe,\n    overlay: overlay,\n    shadow: shadow,\n    shadowHost: shadowHost\n  };\n}\n\nfunction initDOMNodeWithoutOverlay(url, _dispatch, config) {\n  var body = document.querySelector('body');\n  var shadowHost = document.createElement('div');\n  shadowHost.style.width = '100%';\n  shadowHost.style.height = '100%';\n  var shadow = shadowHost.attachShadow({\n    mode: 'open'\n  });\n  var container = document.createElement('div');\n  container.classList.add('embedded-container');\n  shadow.appendChild(container);\n  var loader = document.createElement('div');\n  loader.classList.add('loader-container'); // tslint:disable:max-line-length\n\n  loader.innerHTML = \"\\n    <svg width=\\\"92\\\" height=\\\"60\\\" viewBox=\\\"0 0 51 32\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" class=\\\"loader\\\">\\n      <path d=\\\"M16.2232 18.8309L22.282 24.912C22.7953 25.4272 22.7948 26.2647 22.281 26.7792L17.651 31.4158C16.8619 32.1947 15.5719 32.1947 14.7828 31.4158L0.591812 17.4093C-0.197271 16.6305 -0.197271 15.3571 0.591812 14.5783L14.7828 0.584122C15.5719 -0.194707 16.8619 -0.194707 17.651 0.584122L22.281 5.22078C22.7948 5.73535 22.7953 6.57281 22.282 7.08795L16.2232 13.1691C14.645 14.7267 14.645 17.2733 16.2232 18.8309Z\\\" fill=\\\"#21BF73\\\"></path>\\n      <path d=\\\"M34.4433 18.8309L28.3845 24.912C27.8712 25.4272 27.8717 26.2647 28.3855 26.7792L33.0155 31.4158C33.8046 32.1947 35.0946 32.1947 35.8837 31.4158L50.0747 17.4093C50.8638 16.6305 50.8638 15.3571 50.0747 14.5783L35.8837 0.584122C35.0946 -0.194707 33.8046 -0.194707 33.0155 0.584122L28.3855 5.22078C27.8717 5.73535 27.8712 6.57281 28.3845 7.08795L34.4433 13.1691C36.0215 14.7267 36.0215 17.2733 34.4433 18.8309Z\\\" fill=\\\"#0A6E5C\\\"></path>\\n      <path d=\\\"M17.8128 17.157C17.1737 16.518 17.1737 15.482 17.8128 14.843L24.1765 8.47926C24.8155 7.84025 25.8515 7.84025 26.4905 8.47926L32.8542 14.843C33.4932 15.482 33.4932 16.518 32.8542 17.157L26.4905 23.5207C25.8515 24.1598 24.8155 24.1598 24.1765 23.5207L17.8128 17.157Z\\\" fill=\\\"#21BF73\\\"></path>\\n    </svg>\"; // tslint:enable:max-line-length\n\n  container.appendChild(loader);\n  shadow.appendChild(getStylesForShadowDom(config.variant));\n  var iframe = prepareIframeNode(url, config.variant, config.containerNode);\n  container.appendChild(iframe);\n  return {\n    body: body,\n    iframe: iframe,\n    overlay: null,\n    shadow: shadow,\n    shadowHost: shadowHost\n  };\n}\n\nfunction importFonts() {\n  if (document.querySelector('[data-ramp-font]')) {\n    return;\n  }\n\n  var font = document.createElement('link');\n  font.setAttribute('href', 'https://fonts.googleapis.com/css?family=Poppins:200,400,500,600,700&display=swap&subset=latin-ext');\n  font.setAttribute('rel', 'stylesheet');\n  font.setAttribute('data-ramp-font', '');\n  document.head.appendChild(font);\n}\n\nfunction prepareIframeNode(url, variant, containerNode) {\n  var iframe = document.createElement('iframe');\n  iframe.setAttribute('src', url);\n\n  if (containerNode) {\n    iframe.setAttribute('width', variant === 'desktop' || variant === 'embedded-desktop' ? widgetDesktopWidth.toString() : containerNode.getBoundingClientRect().width.toString());\n    iframe.setAttribute('height', variant === 'desktop' || variant === 'embedded-desktop' ? widgetDesktopHeight.toString() : containerNode.getBoundingClientRect().height.toString());\n  } else {\n    iframe.setAttribute('width', variant === 'desktop' || variant === 'embedded-desktop' ? widgetDesktopWidth.toString() : window.innerWidth.toString());\n    iframe.setAttribute('height', variant === 'desktop' || variant === 'embedded-desktop' ? widgetDesktopHeight.toString() : window.innerHeight.toString());\n  }\n\n  iframe.classList.add('iframe');\n  return iframe;\n}\n\nfunction prepareOverlayNode(iframe, dispatch) {\n  var overlay = document.createElement('div');\n  overlay.classList.add('overlay');\n  var loader = document.createElement('div');\n  loader.classList.add('loader-container'); // tslint:disable:max-line-length\n\n  loader.innerHTML = \"\\n    <svg width=\\\"92\\\" height=\\\"60\\\" viewBox=\\\"0 0 51 32\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" class=\\\"loader\\\">\\n      <path d=\\\"M16.2232 18.8309L22.282 24.912C22.7953 25.4272 22.7948 26.2647 22.281 26.7792L17.651 31.4158C16.8619 32.1947 15.5719 32.1947 14.7828 31.4158L0.591812 17.4093C-0.197271 16.6305 -0.197271 15.3571 0.591812 14.5783L14.7828 0.584122C15.5719 -0.194707 16.8619 -0.194707 17.651 0.584122L22.281 5.22078C22.7948 5.73535 22.7953 6.57281 22.282 7.08795L16.2232 13.1691C14.645 14.7267 14.645 17.2733 16.2232 18.8309Z\\\" fill=\\\"#21BF73\\\"></path>\\n      <path d=\\\"M34.4433 18.8309L28.3845 24.912C27.8712 25.4272 27.8717 26.2647 28.3855 26.7792L33.0155 31.4158C33.8046 32.1947 35.0946 32.1947 35.8837 31.4158L50.0747 17.4093C50.8638 16.6305 50.8638 15.3571 50.0747 14.5783L35.8837 0.584122C35.0946 -0.194707 33.8046 -0.194707 33.0155 0.584122L28.3855 5.22078C27.8717 5.73535 27.8712 6.57281 28.3845 7.08795L34.4433 13.1691C36.0215 14.7267 36.0215 17.2733 34.4433 18.8309Z\\\" fill=\\\"#0A6E5C\\\"></path>\\n      <path d=\\\"M17.8128 17.157C17.1737 16.518 17.1737 15.482 17.8128 14.843L24.1765 8.47926C24.8155 7.84025 25.8515 7.84025 26.4905 8.47926L32.8542 14.843C33.4932 15.482 33.4932 16.518 32.8542 17.157L26.4905 23.5207C25.8515 24.1598 24.8155 24.1598 24.1765 23.5207L17.8128 17.157Z\\\" fill=\\\"#21BF73\\\"></path>\\n    </svg>\"; // tslint:enable:max-line-length\n\n  overlay.appendChild(loader);\n  overlay.addEventListener('click', function (event) {\n    if (event.target !== iframe && !overlay.querySelectorAll('.close-modal').length) {\n      dispatch({\n        type: InternalEventTypes.WIDGET_CLOSE_REQUEST,\n        payload: null,\n        internal: true\n      });\n    }\n  });\n  return overlay;\n}\n\nfunction areUrlsEqual(url0, url1) {\n  return new URL(url0).toString() === new URL(url1).toString();\n}\n\nfunction isCloseModalAlreadyOpen(containerNode) {\n  return containerNode.querySelectorAll('.close-modal').length !== 0;\n}\n\nfunction prepareCloseModalNode(dispatch) {\n  var container = document.createElement('div');\n  container.classList.add('close-modal');\n  var textEl = document.createElement('div');\n  textEl.classList.add('close-modal__text');\n  textEl.textContent = 'Are you sure you want to exit Ramp Instant and abandon the transaction?';\n  var buttonContainer = document.createElement('div');\n  buttonContainer.classList.add('close-modal__button-container');\n  var cancelButton = document.createElement('button');\n  cancelButton.setAttribute('type', 'button');\n  cancelButton.classList.add('close-modal__button');\n  cancelButton.classList.add('close-modal__button--cancel');\n  cancelButton.textContent = 'Cancel';\n  cancelButton.addEventListener('click', function (event) {\n    event.stopPropagation();\n    dispatch({\n      type: InternalEventTypes.WIDGET_CLOSE_REQUEST_CANCELLED,\n      payload: null,\n      internal: true\n    });\n  });\n  var exitButton = document.createElement('button');\n  exitButton.setAttribute('type', 'button');\n  exitButton.classList.add('close-modal__button');\n  exitButton.classList.add('close-modal__button--exit');\n  exitButton.textContent = 'Exit';\n  exitButton.addEventListener('click', function (event) {\n    event.stopPropagation();\n    dispatch({\n      type: InternalEventTypes.WIDGET_CLOSE_REQUEST_CONFIRMED,\n      payload: null,\n      internal: true\n    });\n  });\n  buttonContainer.appendChild(cancelButton);\n  buttonContainer.appendChild(exitButton);\n  container.appendChild(textEl);\n  container.appendChild(buttonContainer);\n  return container;\n}\n\nfunction getStylesForShadowDom(variant) {\n  var styles = document.createElement('style');\n  var isMobile = variant === 'mobile' || variant === 'hosted-mobile' || variant === 'embedded-mobile';\n  var isEmbedded = variant === 'embedded-mobile' || variant === 'embedded-desktop';\n  styles.textContent = \"\\n\\n    .background-hider {\\n      content: '';\\n      height: 30vh;\\n      width: 100vw;\\n      position: fixed;\\n      bottom: 0;\\n      transform: translateY(50%);\\n      background-color: #f5f8fb;\\n      z-index: 999;\\n    }\\n\\n    .overlay {\\n      position: fixed;\\n      z-index: 1000;\\n      width: 100vw;\\n      height: \" + (isMobile ? '100%;' : '100vh;') + \"\\n      top: 0;\\n      left: 0;\\n      overflow: hidden;\\n      background-color: rgba(166, 174, 185, 0.7);\\n      display: flex;\\n      flex-flow: row nowrap;\\n      justify-content: center;\\n      \" + (isMobile ? 'align-items: flex-start;' : 'align-items: center;') + \"\\n    }\\n\\n    .embedded-container {\\n      z-index: 1000;\\n      position: relative;\\n      width: 100%;\\n      height: 100%;\\n      display: flex;\\n      flex-flow: row nowrap;\\n      justify-content: center;\\n      \" + (isMobile ? 'align-items: flex-start;' : 'align-items: center;') + \"\\n      min-width: \" + (isMobile ? minWidgetMobileWidth : widgetDesktopWidth) + \"px;\\n      min-height: \" + (isMobile ? minWidgetMobileHeight : widgetDesktopHeight) + \"px;\\n    }\\n\\n    .loader-container {\\n      align-self: center;\\n    }\\n\\n    .loader {\\n      transform-origin: center;\\n      animation: logoAnimation 4s linear infinite;\\n      width: 100px;\\n      height: auto;\\n      align-self: center;\\n    }\\n\\n    .loader path:nth-child(3) {\\n      transform-origin: center;\\n      position: relative;\\n    }\\n\\n    .loader path:nth-child(1) {\\n      transform-origin: center;\\n      position: relative;\\n      animation: box1Animation 4s linear infinite;\\n      transform: scale(0.4) translateX(6px);\\n    }\\n\\n    .loader path:nth-child(2) {\\n      transform-origin: center;\\n      position: relative;\\n      animation: box4Animation 4s linear infinite;\\n      transform: scale(0.4) translateX(-6px);\\n    }\\n\\n    @keyframes logoAnimation {\\n      10% {\\n        transform: rotate(180deg);\\n      }\\n      30%{\\n        transform: rotate(360deg);\\n      }\\n      70% {\\n        transform: rotate(360deg);\\n      }\\n      90% {\\n        transform: rotate(520deg);\\n      }\\n      100% {\\n        transform: rotate(720deg);\\n      }\\n    }\\n\\n    @keyframes box1Animation {\\n      0%, 10% {\\n        transform: scale(0.4) translateX(6px);\\n      }\\n      30%, 70% {\\n        transform: scale(1) translateX(0);\\n      }\\n      90% {\\n        transform: scale(0.4) translateX(6px);\\n      }\\n    }\\n\\n\\n    @keyframes box4Animation {\\n      0%, 10% {\\n        transform: scale(0.4) translateX(-6px);\\n      }\\n      30%, 70% {\\n        transform: scale(1) translateX(0);\\n      }\\n      90% {\\n        transform: scale(0.4) translateX(-6px);\\n      }\\n    }\\n\\n    .iframe {\\n      border: none;\\n      user-select: none;\\n      visibility: hidden;\\n      position: absolute;\\n    }\\n\\n    .iframe.visible {\\n      visibility: visible;\\n      \" + (!isEmbedded && isMobile ? \"\\n        width: 100vw;\\n        height: 100%;\\n      \" : '') + \"\\n    }\\n\\n    .close-modal {\\n      font-family: 'Poppins', sans-serif;\\n      width: 678px;\\n      height: 276px;\\n      position: absolute;\\n      left: 50%;\\n      top: 50%;\\n      transform: translate(-50%, -50%);\\n      z-index: 9999;\\n      box-shadow: 0px 54px 200px rgba(36, 37, 57, 0.2);\\n      display: flex;\\n      flex-flow: column nowrap;\\n      justify-content: flex-start;\\n      align-items: center;\\n      padding: 35px;\\n      border-radius: 8px;\\n      background: #fff;\\n\\n      box-sizing: border-box;\\n    }\\n\\n    .close-modal * {\\n      box-sizing: border-box;\\n    }\\n\\n    .close-modal__text {\\n      margin: 40px auto 30px;\\n      font-weight: 600;\\n      font-size: 24px;\\n      line-height: 36px;\\n      text-align: center;\\n\\n      color: #242539;\\n    }\\n\\n    .close-modal__button-container {\\n      width: 318px;\\n      display: flex;\\n      flex-flow: row nowrap;\\n      justify-content: space-between;\\n      align-items: center;\\n    }\\n\\n    .close-modal__button {\\n      background: #fff;\\n      border: 2px solid #EDEEF3;\\n      border-radius: 74px;\\n      width: 152px;\\n      height: 56px;\\n      cursor: pointer;\\n      font-weight: 600;\\n      font-size: 14px;\\n      line-height: 21px;\\n      color: #2B2D56;\\n      text-transform: uppercase;\\n    }\\n\\n    .close-modal__button--exit {\\n      background: #DD3E56;\\n      box-shadow: 0px 8px 34px rgba(221, 62, 86, 0.4);\\n      color: #fff;\\n      border-color: transparent;\\n    }\\n  \";\n  return styles;\n}\n\nvar RampInstantSDK = function () {\n  function RampInstantSDK(config) {\n    this._listeners = initEventListenersDict();\n    this._isVisible = false;\n    this._isPollingForSwapStatus = false;\n    this._purchasePollingCredentials = null;\n    importFonts();\n    this.unsubscribe = this.unsubscribe.bind(this);\n    this.on = this.on.bind(this);\n    this.show = this.show.bind(this);\n    this._handleEscapeClick = this._handleEscapeClick.bind(this);\n    this._dispatchEvent = this._dispatchEvent.bind(this);\n    this._subscribeToWidgetEvents = this._subscribeToWidgetEvents.bind(this);\n    this._on = this._on.bind(this);\n    this._processPurchasePollingLoop = this._processPurchasePollingLoop.bind(this);\n    this._registerSdkEventHandlers = this._registerSdkEventHandlers.bind(this);\n    this._runPostSubscribeHooks = this._runPostSubscribeHooks.bind(this);\n    this._subscribeToWidgetEvents = this._subscribeToWidgetEvents.bind(this);\n    this._rawNormalizedConfig = normalizeConfigAndLogErrorsOnInvalidFields(_assign({\n      variant: 'desktop'\n    }, config));\n    var widgetVariant = determineWidgetVariant(this._rawNormalizedConfig);\n    this._config = _assign(_assign({}, this._rawNormalizedConfig), {\n      variant: widgetVariant,\n      widgetInstanceId: getRandomIntString()\n    });\n  }\n\n  RampInstantSDK.prototype.show = function () {\n    if (this._isVisible) {\n      throw new Error('Widget is already visible - you can only call this once per instance');\n    }\n\n    if (document.activeElement && isHtmlElement(document.activeElement)) {\n      document.activeElement.blur();\n    }\n\n    this._registerSdkEventHandlers();\n\n    window.addEventListener('message', this._subscribeToWidgetEvents);\n\n    if (this._isConfiguredAsHosted()) {\n      this._showUsingHostedMode();\n    } else if (this._isConfiguredAsEmbedded()) {\n      this._showUsingEmbeddedMode();\n    } else if (this._isConfiguredWithOverlay()) {\n      this._showUsingOverlayMode();\n    }\n\n    window.addEventListener('keydown', this._handleEscapeClick, true);\n    return this;\n  };\n\n  RampInstantSDK.prototype.on = function (type, callback) {\n    this._on(type, callback, false);\n\n    return this;\n  };\n\n  RampInstantSDK.prototype.unsubscribe = function (type, callback) {\n    var _this = this;\n\n    if (type === '*') {\n      var allTypes = Object.entries(this._listeners);\n      allTypes.forEach(function (_a) {\n        var key = _a[0],\n            eventHandlers = _a[1];\n        var filteredHandlers = eventHandlers.filter(function (l) {\n          return l.callback !== callback;\n        });\n        _this._listeners[key] = filteredHandlers;\n      });\n    } else {\n      this._listeners[type] = this._listeners[type].filter(function (l) {\n        return l.callback !== callback;\n      });\n    }\n\n    return this;\n  };\n\n  RampInstantSDK.prototype._on = function (type, callback, internal) {\n    if (type !== '*' && !this._listeners[type]) {\n      // tslint:disable-next-line:no-console\n      console.warn(\"Unknown / unsupported event name - '\" + type + \"'. This listener will have no effect.\");\n    }\n\n    if (type === '*') {\n      var allTypes = Object.values(this._listeners);\n      allTypes.forEach(function (eventHandlers) {\n        return eventHandlers.push({\n          callback: callback,\n          internal: internal\n        });\n      });\n    } else {\n      this._listeners[type].push({\n        callback: callback,\n        internal: internal\n      });\n    }\n\n    this._runPostSubscribeHooks(type, internal);\n  };\n\n  RampInstantSDK.prototype._subscribeToWidgetEvents = function (event) {\n    if (!event.data) {\n      return;\n    }\n\n    if (!areUrlsEqual(event.origin, this._config.url || baseWidgetUrl)) {\n      return;\n    }\n\n    var eventData = event.data;\n\n    if (!eventData.widgetInstanceId || eventData.widgetInstanceId !== this._config.widgetInstanceId) {\n      return;\n    }\n\n    this._dispatchEvent(eventData);\n  };\n\n  RampInstantSDK.prototype._registerSdkEventHandlers = function () {\n    var _this = this;\n\n    this._on(WidgetEventTypes.WIDGET_CLOSE, function (_event) {\n      var _a, _b;\n\n      if (_this._isConfiguredAsHosted()) {\n        try {\n          (_a = _this.widgetWindow) === null || _a === void 0 ? void 0 : _a.close();\n        } catch (e) {\n          throw new Error('Could not close the widget window');\n        }\n      } else {\n        (_b = _this.domNodes) === null || _b === void 0 ? void 0 : _b.shadowHost.remove();\n        bodyScrollLock.clearAllBodyScrollLocks();\n      }\n\n      _this._teardownEventSubscriptions();\n    }, true);\n\n    var onConfigEvent = function onConfigEvent() {\n      var _a, _b;\n\n      if (_this._isConfiguredAsHosted()) {\n        return;\n      }\n\n      (_a = _this.domNodes) === null || _a === void 0 ? void 0 : _a.iframe.classList.add('visible');\n      var loader = (_b = _this.domNodes) === null || _b === void 0 ? void 0 : _b.shadow.querySelector('.loader-container');\n\n      if (loader) {\n        loader.remove();\n      }\n    };\n\n    this._on(WidgetEventTypes.WIDGET_CONFIG_DONE, onConfigEvent, true);\n\n    this._on(WidgetEventTypes.WIDGET_CONFIG_FAILED, onConfigEvent, true);\n\n    this._on(InternalEventTypes.WIDGET_CLOSE_REQUEST, function (_event) {\n      if (_this._isConfiguredAsHosted() || _this._isConfiguredAsEmbedded()) {\n        return;\n      }\n\n      if (_this._config.variant === 'mobile' || isCloseModalAlreadyOpen(_this.domNodes.overlay)) {\n        return;\n      }\n\n      _this.domNodes.overlay.appendChild(prepareCloseModalNode(_this._dispatchEvent));\n    }, true);\n\n    this._on(InternalEventTypes.WIDGET_CLOSE_REQUEST_CONFIRMED, function (_event) {\n      _this._dispatchEvent({\n        type: WidgetEventTypes.WIDGET_CLOSE,\n        payload: null,\n        widgetInstanceId: _this._config.widgetInstanceId\n      });\n    }, true);\n\n    this._on(InternalEventTypes.WIDGET_CLOSE_REQUEST_CANCELLED, function (_event) {\n      if (_this._isConfiguredAsHosted() || _this._isConfiguredAsEmbedded()) {\n        return;\n      }\n\n      var modal = _this.domNodes.overlay.querySelector('.close-modal');\n\n      if (modal) {\n        modal.remove();\n      }\n    }, true);\n\n    this._on(WidgetEventTypes.PURCHASE_CREATED, function (event) {\n      _this._purchasePollingCredentials = {\n        apiUrl: event.payload.apiUrl,\n        purchaseExternalId: event.payload.purchase.id,\n        token: event.payload.purchaseViewToken\n      }; // tslint:disable-next-line:no-floating-promises\n\n      _this._processPurchasePollingLoop(_this._purchasePollingCredentials);\n    }, true);\n  };\n\n  RampInstantSDK.prototype._dispatchEvent = function (event) {\n    var type = event.type;\n\n    this._listeners[type].forEach(function (handler) {\n      return handler.callback(event);\n    });\n  };\n\n  RampInstantSDK.prototype._handleEscapeClick = function (event) {\n    var escKeyCode = 27;\n\n    if (event.key === 'Escape' || event.key === 'Esc' || event.keyCode === escKeyCode) {\n      this._dispatchEvent({\n        type: InternalEventTypes.WIDGET_CLOSE_REQUEST,\n        payload: null,\n        internal: true\n      });\n    }\n  }; // Event subscriptions aren't cleared so that host can receive a PAYMENT_SUCCESSFUL event\n  // even after the widget has been closed\n\n\n  RampInstantSDK.prototype._teardownEventSubscriptions = function () {\n    window.removeEventListener('keydown', this._handleEscapeClick, true);\n    window.removeEventListener('message', this._subscribeToWidgetEvents);\n  };\n\n  RampInstantSDK.prototype._processPurchasePollingLoop = function (_a) {\n    var apiUrl = _a.apiUrl,\n        purchaseExternalId = _a.purchaseExternalId,\n        token = _a.token;\n    return __awaiter(this, void 0, void 0, function () {\n      var purchase;\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            this._isPollingForSwapStatus = true;\n            _b.label = 1;\n\n          case 1:\n            if (!(countListenersForEvent(this._listeners, WidgetEventTypes.PURCHASE_SUCCESSFUL) > 0 || countListenersForEvent(this._listeners, WidgetEventTypes.PURCHASE_FAILED) > 0)) return [3\n            /*break*/\n            , 4]; // tslint:disable-next-line:no-magic-numbers\n\n            return [4\n            /*yield*/\n            , delay(1000)];\n\n          case 2:\n            // tslint:disable-next-line:no-magic-numbers\n            _b.sent();\n\n            return [4\n            /*yield*/\n            , doFetchPurchase(apiUrl, purchaseExternalId, token)];\n\n          case 3:\n            purchase = _b.sent();\n\n            if (!purchase) {\n              return [3\n              /*break*/\n              , 1];\n            }\n\n            if (purchase.actions.find(function (action) {\n              return action.newStatus === 'RELEASED';\n            })) {\n              this._dispatchEvent({\n                type: WidgetEventTypes.PURCHASE_SUCCESSFUL,\n                payload: {\n                  purchase: purchase\n                },\n                widgetInstanceId: this._config.widgetInstanceId\n              });\n\n              return [2\n              /*return*/\n              ];\n            }\n\n            if (purchase.actions.find(function (action) {\n              return action.newStatus === 'ERROR';\n            })) {\n              this._dispatchEvent({\n                type: WidgetEventTypes.PURCHASE_FAILED,\n                payload: null,\n                widgetInstanceId: this._config.widgetInstanceId\n              });\n\n              return [2\n              /*return*/\n              ];\n            }\n\n            return [3\n            /*break*/\n            , 1];\n\n          case 4:\n            this._isPollingForSwapStatus = false;\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n\n  RampInstantSDK.prototype._runPostSubscribeHooks = function (eventType, isHandlerInternal) {\n    /*\r\n     *  Handles a case where a host subscribes to these events after\r\n     *  the `PURCHASE_CREATED` event is fired\r\n     */\n    if ((eventType === '*' || eventType === WidgetEventTypes.PURCHASE_SUCCESSFUL || WidgetEventTypes.PURCHASE_FAILED) && this._purchasePollingCredentials && !this._isPollingForSwapStatus) {\n      // tslint:disable-next-line:no-floating-promises\n      this._processPurchasePollingLoop(this._purchasePollingCredentials);\n    }\n  };\n\n  RampInstantSDK.prototype._showUsingEmbeddedMode = function () {\n    var _a, _b;\n\n    var widgetUrl = initWidgetIframeUrl(this._config);\n    this.domNodes = initDOMNodeWithoutOverlay(widgetUrl, this._dispatchEvent, this._config);\n\n    if (!((_a = this.domNodes) === null || _a === void 0 ? void 0 : _a.body)) {\n      throw new Error(\"Couldn't find <body> element.\");\n    }\n\n    (_b = this._config.containerNode) === null || _b === void 0 ? void 0 : _b.appendChild(this.domNodes.shadowHost);\n    this._isVisible = true;\n  };\n\n  RampInstantSDK.prototype._showUsingOverlayMode = function () {\n    var _a;\n\n    var widgetUrl = initWidgetIframeUrl(this._config);\n    this.domNodes = initDOMNodeWithOverlay(widgetUrl, this._dispatchEvent, this._config);\n\n    if (!((_a = this.domNodes) === null || _a === void 0 ? void 0 : _a.body)) {\n      throw new Error(\"Couldn't find <body> element.\");\n    }\n\n    this.domNodes.body.appendChild(this.domNodes.shadowHost);\n    this._isVisible = true;\n    bodyScrollLock.disableBodyScroll(this.domNodes.iframe);\n    var widgetMode = determineWidgetVariant(this._config);\n\n    if (widgetMode !== 'desktop' && widgetMode !== 'embedded-desktop') {\n      hideWebsiteBelow(this.domNodes.shadow);\n    }\n  };\n\n  RampInstantSDK.prototype._showUsingHostedMode = function () {\n    var _a;\n\n    var widgetUrl = initWidgetIframeUrl(this._config);\n    this.widgetWindow = (_a = window.open(widgetUrl), _a !== null && _a !== void 0 ? _a : undefined);\n  };\n\n  RampInstantSDK.prototype._isConfiguredWithOverlay = function () {\n    return ['desktop', 'mobile'].includes(this._config.variant);\n  };\n\n  RampInstantSDK.prototype._isConfiguredAsHosted = function () {\n    return ['hosted-desktop', 'hosted-mobile'].includes(this._config.variant);\n  };\n\n  RampInstantSDK.prototype._isConfiguredAsEmbedded = function () {\n    return ['embedded-desktop', 'embedded-mobile'].includes(this._rawNormalizedConfig.variant);\n  };\n\n  return RampInstantSDK;\n}();\n\nexport { WidgetEventTypes as RampInstantEventTypes, RampInstantSDK };","map":{"version":3,"sources":["../node_modules/body-scroll-lock/lib/bodyScrollLock.min.js","../src/consts.ts","../src/types.ts","../src/utils.ts","../src/event-polling.ts","../src/init-helpers.ts","../src/ramp-instant-sdk.ts"],"names":["this"],"mappings":"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","sourcesContent":["!function(e,t){if(\"function\"==typeof define&&define.amd)define([\"exports\"],t);else if(\"undefined\"!=typeof exports)t(exports);else{var o={};t(o),e.bodyScrollLock=o}}(this,function(exports){\"use strict\";function r(e){if(Array.isArray(e)){for(var t=0,o=Array(e.length);t<e.length;t++)o[t]=e[t];return o}return Array.from(e)}Object.defineProperty(exports,\"__esModule\",{value:!0});var l=!1;if(\"undefined\"!=typeof window){var e={get passive(){l=!0}};window.addEventListener(\"testPassive\",null,e),window.removeEventListener(\"testPassive\",null,e)}var d=\"undefined\"!=typeof window&&window.navigator&&window.navigator.platform&&/iP(ad|hone|od)/.test(window.navigator.platform),c=[],u=!1,a=-1,s=void 0,v=void 0,f=function(t){return c.some(function(e){return!(!e.options.allowTouchMove||!e.options.allowTouchMove(t))})},m=function(e){var t=e||window.event;return!!f(t.target)||(1<t.touches.length||(t.preventDefault&&t.preventDefault(),!1))},o=function(){setTimeout(function(){void 0!==v&&(document.body.style.paddingRight=v,v=void 0),void 0!==s&&(document.body.style.overflow=s,s=void 0)})};exports.disableBodyScroll=function(i,e){if(d){if(!i)return void console.error(\"disableBodyScroll unsuccessful - targetElement must be provided when calling disableBodyScroll on IOS devices.\");if(i&&!c.some(function(e){return e.targetElement===i})){var t={targetElement:i,options:e||{}};c=[].concat(r(c),[t]),i.ontouchstart=function(e){1===e.targetTouches.length&&(a=e.targetTouches[0].clientY)},i.ontouchmove=function(e){var t,o,n,r;1===e.targetTouches.length&&(o=i,r=(t=e).targetTouches[0].clientY-a,!f(t.target)&&(o&&0===o.scrollTop&&0<r?m(t):(n=o)&&n.scrollHeight-n.scrollTop<=n.clientHeight&&r<0?m(t):t.stopPropagation()))},u||(document.addEventListener(\"touchmove\",m,l?{passive:!1}:void 0),u=!0)}}else{n=e,setTimeout(function(){if(void 0===v){var e=!!n&&!0===n.reserveScrollBarGap,t=window.innerWidth-document.documentElement.clientWidth;e&&0<t&&(v=document.body.style.paddingRight,document.body.style.paddingRight=t+\"px\")}void 0===s&&(s=document.body.style.overflow,document.body.style.overflow=\"hidden\")});var o={targetElement:i,options:e||{}};c=[].concat(r(c),[o])}var n},exports.clearAllBodyScrollLocks=function(){d?(c.forEach(function(e){e.targetElement.ontouchstart=null,e.targetElement.ontouchmove=null}),u&&(document.removeEventListener(\"touchmove\",m,l?{passive:!1}:void 0),u=!1),c=[],a=-1):(o(),c=[])},exports.enableBodyScroll=function(t){if(d){if(!t)return void console.error(\"enableBodyScroll unsuccessful - targetElement must be provided when calling enableBodyScroll on IOS devices.\");t.ontouchstart=null,t.ontouchmove=null,c=c.filter(function(e){return e.targetElement!==t}),u&&0===c.length&&(document.removeEventListener(\"touchmove\",m,l?{passive:!1}:void 0),u=!1)}else(c=c.filter(function(e){return e.targetElement!==t})).length||o()}});\n","export const baseWidgetUrl = 'https://buy.ramp.network/';\n","type TAsset = string;\ntype TEthAddress = string;\ntype TSwapAmount = string;\ntype THostLogoUrl = string;\ntype THostApiKey = string;\ntype THostAppName = string;\ntype TURL = string;\ntype TDateString = string;\ntype TFiatCurrency = string;\ntype TFiatValue = string;\ntype TAddress = string;\ntype TEmailAddress = string;\ntype TCryptoAmount = string;\ntype TPoolFee = number;\ntype TRampFee = number;\ntype TAssetExchangeRate = number;\ntype TPurchaseHash = string;\ntype TActionID = string;\ntype TNewActionStatus = string;\ntype TActionTimestamp = string;\ntype TActionDetails = string;\ntype TWebhookStatusUrl = string;\ntype TFinalUrl = string;\ntype TContainerNode = HTMLElement;\nexport type TPurchaseExternalId = string;\n\nexport interface IHostConfig {\n  swapAsset?: TAsset;\n  swapAmount?: TSwapAmount;\n  fiatValue?: TFiatValue;\n  fiatCurrency?: TFiatCurrency;\n  userAddress?: TEthAddress;\n  userEmailAddress?: TEmailAddress;\n  hostApiKey?: THostApiKey;\n  hostLogoUrl: THostLogoUrl;\n  hostAppName: THostAppName;\n  url?: TURL;\n  variant?: AllWidgetVariants;\n  webhookStatusUrl?: TWebhookStatusUrl;\n  finalUrl?: TFinalUrl;\n  containerNode?: TContainerNode;\n  selectedCountryCode?: string;\n  defaultAsset?: TAsset;\n}\n\nexport interface IPurchasePollingCredentials {\n  token: string;\n  apiUrl: string;\n  purchaseExternalId: TPurchaseExternalId;\n}\n\nexport interface IHostConfigWithWidgetInstanceId extends IHostConfig {\n  widgetInstanceId: string;\n  variant: AllWidgetVariants;\n}\n\nexport interface IAssetInfo {\n  address: string | null;\n  symbol: string;\n  name: string;\n  decimals: number;\n}\n\nexport interface IPurchase {\n  id: TPurchaseExternalId;\n  endTime: TDateString | null;\n  /** @deprecated use `asset.address` */\n  tokenAddress: TAddress | null;\n  asset: IAssetInfo;\n  escrowAddress?: TAddress;\n  receiverAddress: TAddress;\n  cryptoAmount: TCryptoAmount;\n  /** @deprecated use `cryptoAmount` */\n  ethAmount?: TCryptoAmount;\n  /** @deprecated use `cryptoAmount` */\n  tokenAmount?: TCryptoAmount;\n  fiatCurrency: TFiatCurrency;\n  fiatValue: TFiatValue;\n  assetExchangeRate: TAssetExchangeRate;\n  poolFee: TPoolFee;\n  rampFee: TRampFee;\n  purchaseHash: TPurchaseHash;\n  actions: IAction[];\n}\n\nexport interface IAction {\n  id: TActionID;\n  newStatus: TNewActionStatus;\n  timestamp: TActionTimestamp;\n  details: TActionDetails;\n}\n\nexport enum EventSeverity {\n  VERBOSE = 'VERBOSE',\n  DEBUG = 'DEBUG',\n  INFO = 'INFO',\n  WARNING = 'WARNING',\n  ERROR = 'ERROR',\n  CRITICAL = 'CRITICAL',\n}\n\nexport interface IConfigError {\n  fieldName: string;\n  description: string;\n  exampleValue?: string;\n  severity: EventSeverity;\n}\n\nexport interface IWidgetEvent {\n  type: string;\n  payload: any | null;\n  internal?: boolean;\n}\n\nexport enum WidgetEventTypes {\n  WIDGET_CLOSE = 'WIDGET_CLOSE',\n  WIDGET_CONFIG_DONE = 'WIDGET_CONFIG_DONE',\n  WIDGET_CONFIG_FAILED = 'WIDGET_CONFIG_FAILED',\n  PURCHASE_CREATED = 'PURCHASE_CREATED',\n  PURCHASE_SUCCESSFUL = 'PURCHASE_SUCCESSFUL',\n  PURCHASE_FAILED = 'PURCHASE_FAILED',\n}\n\nexport enum InternalEventTypes {\n  WIDGET_CLOSE_REQUEST = 'WIDGET_CLOSE_REQUEST',\n  WIDGET_CLOSE_REQUEST_CANCELLED = 'WIDGET_CLOSE_REQUEST_CANCELLED',\n  WIDGET_CLOSE_REQUEST_CONFIRMED = 'WIDGET_CLOSE_REQUEST_CONFIRMED',\n}\n\nexport type TAllEventTypes = WidgetEventTypes | InternalEventTypes;\n\nexport interface IWidgetCloseEvent extends IWidgetEvent {\n  type: WidgetEventTypes.WIDGET_CLOSE;\n  payload: null;\n  widgetInstanceId: string;\n  internal?: false;\n}\n\nexport interface IPurchaseCreatedEvent extends IWidgetEvent {\n  type: WidgetEventTypes.PURCHASE_CREATED;\n  payload: {\n    purchase: IPurchase;\n    purchaseViewToken: string;\n    apiUrl: string;\n  };\n  widgetInstanceId: string;\n  internal?: false;\n}\n\nexport interface IPurchaseSuccessfulEvent extends IWidgetEvent {\n  type: WidgetEventTypes.PURCHASE_SUCCESSFUL;\n  payload: {\n    purchase: IPurchase;\n  };\n  widgetInstanceId: string;\n  internal?: false;\n}\n\nexport interface IPurchaseFailedEvent extends IWidgetEvent {\n  type: WidgetEventTypes.PURCHASE_FAILED;\n  payload: null;\n  widgetInstanceId: string;\n  internal?: false;\n}\n\nexport interface IWidgetConfigDoneEvent extends IWidgetEvent {\n  type: WidgetEventTypes.WIDGET_CONFIG_DONE;\n  payload: null;\n  widgetInstanceId: string;\n  internal?: false;\n}\n\nexport interface IWidgetConfigFailedEvent extends IWidgetEvent {\n  type: WidgetEventTypes.WIDGET_CONFIG_FAILED;\n  payload: null;\n  widgetInstanceId: string;\n  internal?: false;\n}\n\nexport interface IWidgetCloseRequestEvent extends IWidgetEvent {\n  type: InternalEventTypes.WIDGET_CLOSE_REQUEST;\n  payload: null;\n  widgetInstanceId?: string;\n  internal: boolean;\n}\n\nexport interface IWidgetCloseRequestCancelledEvent extends IWidgetEvent {\n  type: InternalEventTypes.WIDGET_CLOSE_REQUEST_CANCELLED;\n  payload: null;\n  internal: true;\n}\n\nexport interface IWidgetCloseRequestConfirmedEvent extends IWidgetEvent {\n  type: InternalEventTypes.WIDGET_CLOSE_REQUEST_CONFIRMED;\n  payload: null;\n  internal: true;\n}\n\nexport type TWidgetEvents =\n  | IWidgetCloseEvent\n  | IWidgetConfigDoneEvent\n  | IWidgetConfigFailedEvent\n  | IPurchaseCreatedEvent\n  | IPurchaseFailedEvent\n  | IPurchaseSuccessfulEvent;\n\nexport type TInternalEvents =\n  | IWidgetCloseRequestEvent\n  | IWidgetCloseRequestCancelledEvent\n  | IWidgetCloseRequestConfirmedEvent;\n\nexport type TAllEvents = TWidgetEvents | TInternalEvents;\n\nexport type WidgetVariantTypes = 'desktop' | 'mobile' | 'hosted-desktop' | 'hosted-mobile';\n\nexport type SyntheticWidgetVariants =\n  | 'hosted-auto'\n  | 'auto'\n  | 'embedded-desktop'\n  | 'embedded-mobile';\n\nexport type AllWidgetVariants = WidgetVariantTypes | SyntheticWidgetVariants;\n\nexport type TUnsubscribeToken = string;\n\nexport type TEventListenerDict = {\n  [EventType in TAllEvents['type']]: IEventListener[];\n};\n\nexport interface IEventListener {\n  internal: boolean;\n  callback(evt: TAllEvents): any;\n}\n","import {\n  AllWidgetVariants,\n  EventSeverity,\n  IConfigError,\n  IHostConfig,\n  InternalEventTypes,\n  SyntheticWidgetVariants,\n  TAllEventTypes,\n  TEventListenerDict,\n  WidgetEventTypes,\n  WidgetVariantTypes,\n} from './types';\n\nexport function getRandomIntString(): string {\n  try {\n    return String(crypto.getRandomValues(new Uint32Array(1))[0]);\n  } catch {\n    // if `crypto` is not supported, fall back to Math.random\n    // tslint:disable-next-line:no-magic-numbers\n    return String(Math.floor(Math.random() * 10000000));\n  }\n}\n\nexport const widgetDesktopWidth = 895;\nexport const widgetDesktopHeight = 590;\n\nexport const minWidgetMobileWidth = 320;\nexport const minWidgetMobileHeight = 667;\n\nexport function normalizeConfigAndLogErrorsOnInvalidFields(\n  config: Partial<IHostConfig>\n): IHostConfig {\n  const errors: IConfigError[] = [];\n  const configCopy = { ...config };\n\n  if (\n    ![\n      'desktop',\n      'mobile',\n      'hosted-desktop',\n      'hosted-mobile',\n      'hosted-auto',\n      'auto',\n      'embedded-desktop',\n      'embedded-mobile',\n    ].includes(config.variant!)\n  ) {\n    configCopy.variant = 'desktop';\n\n    errors.push({\n      fieldName: 'variant',\n      description: 'Invalid value for `variant` config field ',\n      exampleValue: `'desktop'`,\n      severity: EventSeverity.WARNING,\n    });\n  }\n\n  if (config.variant === 'embedded-desktop' || config.variant === 'embedded-mobile') {\n    validateContainerNode(config.containerNode, config.variant);\n  }\n\n  if (!['embedded-desktop', 'embedded-mobile'].includes(configCopy.variant!)) {\n    delete configCopy.containerNode;\n  }\n\n  logErrors(errors);\n\n  return configCopy as IHostConfig;\n}\n\nfunction logErrors(errors: IConfigError[]): void {\n  if (!errors.length) {\n    return;\n  }\n\n  // tslint:disable:no-console\n  console.group('Config errors');\n\n  errors.forEach((error) => {\n    console.group(error.fieldName);\n\n    console.log(error.description);\n    console.log(`Example expected value: ${error.exampleValue}`);\n    console.log(`Severity: ${error.severity}`);\n\n    console.groupEnd();\n  });\n\n  console.groupEnd();\n  // tslint:enable:no-console\n}\n\nexport function initEventListenersDict(): TEventListenerDict {\n  const widgetEventTypes = Array.from(Object.values(WidgetEventTypes));\n  const internalEventTypes = Array.from(Object.values(InternalEventTypes));\n\n  return [...widgetEventTypes, ...internalEventTypes].reduce<TEventListenerDict>(\n    (listenersDict: TEventListenerDict, eventType: TAllEventTypes) => {\n      listenersDict[eventType] = [];\n\n      return listenersDict;\n    },\n    {} as any\n  ) as TEventListenerDict;\n}\n\nexport function countListenersForEvent(\n  listeners: TEventListenerDict,\n  event: TAllEventTypes,\n  internal: boolean = false\n): number {\n  return listeners[event].filter((handler) => handler.internal === internal).length;\n}\n\nexport function determineWidgetVariant(config: IHostConfig): AllWidgetVariants {\n  const mediaQuery = '(min-width: 920px) and (min-height: 630px)';\n  const variant = config.variant?.toLocaleLowerCase();\n\n  if (\n    variant === 'mobile' ||\n    variant === 'desktop' ||\n    variant === 'hosted-mobile' ||\n    variant === 'hosted-desktop' ||\n    variant === 'embedded-desktop' ||\n    variant === 'embedded-mobile'\n  ) {\n    return variant;\n  }\n\n  const isDesktop = window.matchMedia(mediaQuery).matches;\n\n  if (variant === 'hosted-auto') {\n    return isDesktop ? 'hosted-desktop' : 'hosted-mobile';\n  }\n\n  return isDesktop ? 'desktop' : 'mobile';\n}\n\nexport function isHtmlElement(element: Element): element is HTMLElement {\n  return typeof (element as any).blur === 'function';\n}\n\nfunction validateContainerNode(\n  containerNode: HTMLElement | undefined,\n  variant: SyntheticWidgetVariants\n): void {\n  if (!document.body) {\n    throw new Error(\"Couldn't find <body> element.\");\n  }\n\n  if (!(containerNode instanceof HTMLElement)) {\n    throw new Error('Container node has to be a proper HTML element.');\n  }\n\n  if (!document.body.contains(containerNode)) {\n    throw new Error('Container node must be attached to the document.');\n  }\n\n  const { width, height } = containerNode.getBoundingClientRect();\n\n  if (variant === 'embedded-desktop') {\n    if (width + 1 < widgetDesktopWidth) {\n      throw new Error(`Container node must be at least ${widgetDesktopWidth}px wide.`);\n    }\n\n    if (height + 1 < widgetDesktopHeight) {\n      throw new Error(`Container node must be at least ${widgetDesktopHeight}px tall.`);\n    }\n  } else if (variant === 'embedded-mobile') {\n    if (width + 1 < minWidgetMobileWidth) {\n      throw new Error(`Container node must be at least ${minWidgetMobileWidth}px wide.`);\n    }\n\n    if (height + 1 < minWidgetMobileHeight) {\n      throw new Error(`Container node must be at least ${minWidgetMobileHeight}px tall.`);\n    }\n  }\n}\n\n/**\n * Concatenates `base` with `path`, always treating `path` as a relative path. Ignores:\n *   - trailing slash in `base`\n *   - leading slash in `path`\n * @param base base URL, e.g.: 'http://example.com/api' or 'http://example.com/service/api/'\n * @param path path to append, e.g.: 'user/getByEmail' or '/swap'\n */\nexport function concatRelativePath(base: string | URL, path: string): URL {\n  const normalizedBase = urlWithoutTrailingSlash(base instanceof URL ? base.href : base);\n  const normalizedPath = path.startsWith('/') ? path.substr(1) : path;\n  return new URL(`${normalizedBase}/${normalizedPath}`);\n}\n\nexport function urlWithoutTrailingSlash(url: string): string {\n  return url.endsWith('/') ? url.slice(0, -1) : url;\n}\n","import { IPurchase, TPurchaseExternalId } from './types';\nimport { concatRelativePath } from './utils';\n\nexport async function doFetchPurchase(\n  apiUrl: string,\n  purchaseExternalId: TPurchaseExternalId,\n  token: string\n): Promise<IPurchase | null> {\n  try {\n    const rawResponse = await fetch(\n      concatRelativePath(apiUrl, `/host-api/purchase/${purchaseExternalId}?secret=${token}`).href,\n      {\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      }\n    );\n\n    if (!rawResponse.ok) {\n      throw new Error(`Request for purchase #${purchaseExternalId} failed`);\n    }\n\n    const response = await rawResponse.json();\n\n    return response as IPurchase;\n  } catch {\n    return null;\n  }\n}\n\nexport async function delay(ms: number): Promise<void> {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n","import { baseWidgetUrl } from './consts';\nimport {\n  AllWidgetVariants,\n  IHostConfigWithWidgetInstanceId,\n  InternalEventTypes,\n  TAllEvents,\n  WidgetVariantTypes,\n} from './types';\nimport {\n  minWidgetMobileHeight,\n  minWidgetMobileWidth,\n  widgetDesktopHeight,\n  widgetDesktopWidth,\n} from './utils';\n\nexport function initWidgetIframeUrl(config: IHostConfigWithWidgetInstanceId): string {\n  const baseUrl = new URL(config.url || baseWidgetUrl);\n  const hostUrl = window.location.origin;\n\n  const { containerNode, url, ...configWithoutIframeUrl } = config;\n\n  const preparedConfig = { ...configWithoutIframeUrl, hostUrl };\n\n  Object.entries(preparedConfig).forEach(([key, value]) => {\n    if (value) {\n      baseUrl.searchParams.append(key, value);\n    }\n  });\n\n  return baseUrl.toString();\n}\n\nexport function hideWebsiteBelow(\n  parent: Element | ShadowRoot,\n  containerWidth?: number | undefined\n): void {\n  const backgroundWebsiteHider = document.createElement('div');\n  backgroundWebsiteHider.classList.add('background-hider');\n\n  if (containerWidth) {\n    backgroundWebsiteHider.style.maxWidth = `${containerWidth}px`;\n  }\n\n  parent.appendChild(backgroundWebsiteHider);\n}\n\nexport function initDOMNodeWithOverlay(\n  url: string,\n  dispatch: (event: TAllEvents) => void,\n  config: IHostConfigWithWidgetInstanceId\n): {\n  body: HTMLBodyElement | null;\n  iframe: HTMLIFrameElement;\n  overlay: HTMLDivElement;\n  shadow: ShadowRoot;\n  shadowHost: HTMLDivElement;\n} {\n  const body = document.querySelector('body');\n\n  const shadowHost = document.createElement('div');\n\n  shadowHost.style.width = '100%';\n  shadowHost.style.height = '100%';\n\n  const shadow = shadowHost.attachShadow({ mode: 'open' });\n\n  shadow.appendChild(getStylesForShadowDom(config.variant));\n\n  const iframe = prepareIframeNode(url, config.variant);\n  const overlay = prepareOverlayNode(iframe, dispatch);\n\n  overlay.appendChild(iframe);\n  shadow.appendChild(overlay);\n\n  return {\n    body,\n    iframe,\n    overlay,\n    shadow,\n    shadowHost,\n  };\n}\n\nexport function initDOMNodeWithoutOverlay(\n  url: string,\n  _dispatch: (event: TAllEvents) => void,\n  config: IHostConfigWithWidgetInstanceId\n): {\n  body: HTMLBodyElement | null;\n  iframe: HTMLIFrameElement;\n  overlay: null;\n  shadow: ShadowRoot;\n  shadowHost: HTMLDivElement;\n} {\n  const body = document.querySelector('body');\n\n  const shadowHost = document.createElement('div');\n\n  shadowHost.style.width = '100%';\n  shadowHost.style.height = '100%';\n\n  const shadow = shadowHost.attachShadow({ mode: 'open' });\n\n  const container = document.createElement('div');\n  container.classList.add('embedded-container');\n\n  shadow.appendChild(container);\n\n  const loader = document.createElement('div');\n  loader.classList.add('loader-container');\n\n  // tslint:disable:max-line-length\n  loader.innerHTML = `\n    <svg width=\"92\" height=\"60\" viewBox=\"0 0 51 32\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" class=\"loader\">\n      <path d=\"M16.2232 18.8309L22.282 24.912C22.7953 25.4272 22.7948 26.2647 22.281 26.7792L17.651 31.4158C16.8619 32.1947 15.5719 32.1947 14.7828 31.4158L0.591812 17.4093C-0.197271 16.6305 -0.197271 15.3571 0.591812 14.5783L14.7828 0.584122C15.5719 -0.194707 16.8619 -0.194707 17.651 0.584122L22.281 5.22078C22.7948 5.73535 22.7953 6.57281 22.282 7.08795L16.2232 13.1691C14.645 14.7267 14.645 17.2733 16.2232 18.8309Z\" fill=\"#21BF73\"></path>\n      <path d=\"M34.4433 18.8309L28.3845 24.912C27.8712 25.4272 27.8717 26.2647 28.3855 26.7792L33.0155 31.4158C33.8046 32.1947 35.0946 32.1947 35.8837 31.4158L50.0747 17.4093C50.8638 16.6305 50.8638 15.3571 50.0747 14.5783L35.8837 0.584122C35.0946 -0.194707 33.8046 -0.194707 33.0155 0.584122L28.3855 5.22078C27.8717 5.73535 27.8712 6.57281 28.3845 7.08795L34.4433 13.1691C36.0215 14.7267 36.0215 17.2733 34.4433 18.8309Z\" fill=\"#0A6E5C\"></path>\n      <path d=\"M17.8128 17.157C17.1737 16.518 17.1737 15.482 17.8128 14.843L24.1765 8.47926C24.8155 7.84025 25.8515 7.84025 26.4905 8.47926L32.8542 14.843C33.4932 15.482 33.4932 16.518 32.8542 17.157L26.4905 23.5207C25.8515 24.1598 24.8155 24.1598 24.1765 23.5207L17.8128 17.157Z\" fill=\"#21BF73\"></path>\n    </svg>`;\n  // tslint:enable:max-line-length\n\n  container.appendChild(loader);\n\n  shadow.appendChild(getStylesForShadowDom(config.variant));\n\n  const iframe = prepareIframeNode(url, config.variant, config.containerNode);\n\n  container.appendChild(iframe);\n\n  return {\n    body,\n    iframe,\n    overlay: null,\n    shadow,\n    shadowHost,\n  };\n}\n\nexport function importFonts(): void {\n  if (document.querySelector('[data-ramp-font]')) {\n    return;\n  }\n\n  const font = document.createElement('link');\n\n  font.setAttribute(\n    'href',\n    'https://fonts.googleapis.com/css?family=Poppins:200,400,500,600,700&display=swap&subset=latin-ext'\n  );\n  font.setAttribute('rel', 'stylesheet');\n  font.setAttribute('data-ramp-font', '');\n\n  document.head.appendChild(font);\n}\n\nfunction prepareIframeNode(\n  url: string,\n  variant: AllWidgetVariants,\n  containerNode?: HTMLElement\n): HTMLIFrameElement {\n  const iframe = document.createElement('iframe');\n\n  iframe.setAttribute('src', url);\n\n  if (containerNode) {\n    iframe.setAttribute(\n      'width',\n      variant === 'desktop' || variant === 'embedded-desktop'\n        ? widgetDesktopWidth.toString()\n        : containerNode.getBoundingClientRect().width.toString()\n    );\n\n    iframe.setAttribute(\n      'height',\n      variant === 'desktop' || variant === 'embedded-desktop'\n        ? widgetDesktopHeight.toString()\n        : containerNode.getBoundingClientRect().height.toString()\n    );\n  } else {\n    iframe.setAttribute(\n      'width',\n      variant === 'desktop' || variant === 'embedded-desktop'\n        ? widgetDesktopWidth.toString()\n        : window.innerWidth.toString()\n    );\n\n    iframe.setAttribute(\n      'height',\n      variant === 'desktop' || variant === 'embedded-desktop'\n        ? widgetDesktopHeight.toString()\n        : window.innerHeight.toString()\n    );\n  }\n\n  iframe.classList.add('iframe');\n\n  return iframe;\n}\n\nfunction prepareOverlayNode(\n  iframe: HTMLIFrameElement,\n  dispatch: (event: TAllEvents) => void\n): HTMLDivElement {\n  const overlay = document.createElement('div');\n\n  overlay.classList.add('overlay');\n\n  const loader = document.createElement('div');\n  loader.classList.add('loader-container');\n\n  // tslint:disable:max-line-length\n  loader.innerHTML = `\n    <svg width=\"92\" height=\"60\" viewBox=\"0 0 51 32\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" class=\"loader\">\n      <path d=\"M16.2232 18.8309L22.282 24.912C22.7953 25.4272 22.7948 26.2647 22.281 26.7792L17.651 31.4158C16.8619 32.1947 15.5719 32.1947 14.7828 31.4158L0.591812 17.4093C-0.197271 16.6305 -0.197271 15.3571 0.591812 14.5783L14.7828 0.584122C15.5719 -0.194707 16.8619 -0.194707 17.651 0.584122L22.281 5.22078C22.7948 5.73535 22.7953 6.57281 22.282 7.08795L16.2232 13.1691C14.645 14.7267 14.645 17.2733 16.2232 18.8309Z\" fill=\"#21BF73\"></path>\n      <path d=\"M34.4433 18.8309L28.3845 24.912C27.8712 25.4272 27.8717 26.2647 28.3855 26.7792L33.0155 31.4158C33.8046 32.1947 35.0946 32.1947 35.8837 31.4158L50.0747 17.4093C50.8638 16.6305 50.8638 15.3571 50.0747 14.5783L35.8837 0.584122C35.0946 -0.194707 33.8046 -0.194707 33.0155 0.584122L28.3855 5.22078C27.8717 5.73535 27.8712 6.57281 28.3845 7.08795L34.4433 13.1691C36.0215 14.7267 36.0215 17.2733 34.4433 18.8309Z\" fill=\"#0A6E5C\"></path>\n      <path d=\"M17.8128 17.157C17.1737 16.518 17.1737 15.482 17.8128 14.843L24.1765 8.47926C24.8155 7.84025 25.8515 7.84025 26.4905 8.47926L32.8542 14.843C33.4932 15.482 33.4932 16.518 32.8542 17.157L26.4905 23.5207C25.8515 24.1598 24.8155 24.1598 24.1765 23.5207L17.8128 17.157Z\" fill=\"#21BF73\"></path>\n    </svg>`;\n  // tslint:enable:max-line-length\n\n  overlay.appendChild(loader);\n\n  overlay.addEventListener('click', (event) => {\n    if (event.target !== iframe && !overlay.querySelectorAll('.close-modal').length) {\n      dispatch({\n        type: InternalEventTypes.WIDGET_CLOSE_REQUEST,\n        payload: null,\n        internal: true,\n      });\n    }\n  });\n\n  return overlay;\n}\n\nexport function areUrlsEqual(url0: string, url1: string): boolean {\n  return new URL(url0).toString() === new URL(url1).toString();\n}\n\nexport function isCloseModalAlreadyOpen(containerNode: HTMLElement): boolean {\n  return containerNode.querySelectorAll('.close-modal').length !== 0;\n}\n\nexport function prepareCloseModalNode(dispatch: (event: TAllEvents) => void): HTMLDivElement {\n  const container = document.createElement('div');\n  container.classList.add('close-modal');\n\n  const textEl = document.createElement('div');\n  textEl.classList.add('close-modal__text');\n  textEl.textContent = 'Are you sure you want to exit Ramp Instant and abandon the transaction?';\n\n  const buttonContainer = document.createElement('div');\n  buttonContainer.classList.add('close-modal__button-container');\n\n  const cancelButton = document.createElement('button');\n  cancelButton.setAttribute('type', 'button');\n  cancelButton.classList.add('close-modal__button');\n  cancelButton.classList.add('close-modal__button--cancel');\n  cancelButton.textContent = 'Cancel';\n  cancelButton.addEventListener('click', (event) => {\n    event.stopPropagation();\n\n    dispatch({\n      type: InternalEventTypes.WIDGET_CLOSE_REQUEST_CANCELLED,\n      payload: null,\n      internal: true,\n    });\n  });\n\n  const exitButton = document.createElement('button');\n  exitButton.setAttribute('type', 'button');\n  exitButton.classList.add('close-modal__button');\n  exitButton.classList.add('close-modal__button--exit');\n  exitButton.textContent = 'Exit';\n  exitButton.addEventListener('click', (event) => {\n    event.stopPropagation();\n\n    dispatch({\n      type: InternalEventTypes.WIDGET_CLOSE_REQUEST_CONFIRMED,\n      payload: null,\n      internal: true,\n    });\n  });\n\n  buttonContainer.appendChild(cancelButton);\n  buttonContainer.appendChild(exitButton);\n\n  container.appendChild(textEl);\n  container.appendChild(buttonContainer);\n\n  return container;\n}\n\nfunction getStylesForShadowDom(variant: AllWidgetVariants): HTMLStyleElement {\n  const styles = document.createElement('style');\n\n  const isMobile =\n    variant === 'mobile' || variant === 'hosted-mobile' || variant === 'embedded-mobile';\n  const isEmbedded = variant === 'embedded-mobile' || variant === 'embedded-desktop';\n\n  styles.textContent = `\n\n    .background-hider {\n      content: '';\n      height: 30vh;\n      width: 100vw;\n      position: fixed;\n      bottom: 0;\n      transform: translateY(50%);\n      background-color: #f5f8fb;\n      z-index: 999;\n    }\n\n    .overlay {\n      position: fixed;\n      z-index: 1000;\n      width: 100vw;\n      height: ${isMobile ? '100%;' : '100vh;'}\n      top: 0;\n      left: 0;\n      overflow: hidden;\n      background-color: rgba(166, 174, 185, 0.7);\n      display: flex;\n      flex-flow: row nowrap;\n      justify-content: center;\n      ${isMobile ? 'align-items: flex-start;' : 'align-items: center;'}\n    }\n\n    .embedded-container {\n      z-index: 1000;\n      position: relative;\n      width: 100%;\n      height: 100%;\n      display: flex;\n      flex-flow: row nowrap;\n      justify-content: center;\n      ${isMobile ? 'align-items: flex-start;' : 'align-items: center;'}\n      min-width: ${isMobile ? minWidgetMobileWidth : widgetDesktopWidth}px;\n      min-height: ${isMobile ? minWidgetMobileHeight : widgetDesktopHeight}px;\n    }\n\n    .loader-container {\n      align-self: center;\n    }\n\n    .loader {\n      transform-origin: center;\n      animation: logoAnimation 4s linear infinite;\n      width: 100px;\n      height: auto;\n      align-self: center;\n    }\n\n    .loader path:nth-child(3) {\n      transform-origin: center;\n      position: relative;\n    }\n\n    .loader path:nth-child(1) {\n      transform-origin: center;\n      position: relative;\n      animation: box1Animation 4s linear infinite;\n      transform: scale(0.4) translateX(6px);\n    }\n\n    .loader path:nth-child(2) {\n      transform-origin: center;\n      position: relative;\n      animation: box4Animation 4s linear infinite;\n      transform: scale(0.4) translateX(-6px);\n    }\n\n    @keyframes logoAnimation {\n      10% {\n        transform: rotate(180deg);\n      }\n      30%{\n        transform: rotate(360deg);\n      }\n      70% {\n        transform: rotate(360deg);\n      }\n      90% {\n        transform: rotate(520deg);\n      }\n      100% {\n        transform: rotate(720deg);\n      }\n    }\n\n    @keyframes box1Animation {\n      0%, 10% {\n        transform: scale(0.4) translateX(6px);\n      }\n      30%, 70% {\n        transform: scale(1) translateX(0);\n      }\n      90% {\n        transform: scale(0.4) translateX(6px);\n      }\n    }\n\n\n    @keyframes box4Animation {\n      0%, 10% {\n        transform: scale(0.4) translateX(-6px);\n      }\n      30%, 70% {\n        transform: scale(1) translateX(0);\n      }\n      90% {\n        transform: scale(0.4) translateX(-6px);\n      }\n    }\n\n    .iframe {\n      border: none;\n      user-select: none;\n      visibility: hidden;\n      position: absolute;\n    }\n\n    .iframe.visible {\n      visibility: visible;\n      ${\n        !isEmbedded && isMobile\n          ? `\n        width: 100vw;\n        height: 100%;\n      `\n          : ''\n      }\n    }\n\n    .close-modal {\n      font-family: 'Poppins', sans-serif;\n      width: 678px;\n      height: 276px;\n      position: absolute;\n      left: 50%;\n      top: 50%;\n      transform: translate(-50%, -50%);\n      z-index: 9999;\n      box-shadow: 0px 54px 200px rgba(36, 37, 57, 0.2);\n      display: flex;\n      flex-flow: column nowrap;\n      justify-content: flex-start;\n      align-items: center;\n      padding: 35px;\n      border-radius: 8px;\n      background: #fff;\n\n      box-sizing: border-box;\n    }\n\n    .close-modal * {\n      box-sizing: border-box;\n    }\n\n    .close-modal__text {\n      margin: 40px auto 30px;\n      font-weight: 600;\n      font-size: 24px;\n      line-height: 36px;\n      text-align: center;\n\n      color: #242539;\n    }\n\n    .close-modal__button-container {\n      width: 318px;\n      display: flex;\n      flex-flow: row nowrap;\n      justify-content: space-between;\n      align-items: center;\n    }\n\n    .close-modal__button {\n      background: #fff;\n      border: 2px solid #EDEEF3;\n      border-radius: 74px;\n      width: 152px;\n      height: 56px;\n      cursor: pointer;\n      font-weight: 600;\n      font-size: 14px;\n      line-height: 21px;\n      color: #2B2D56;\n      text-transform: uppercase;\n    }\n\n    .close-modal__button--exit {\n      background: #DD3E56;\n      box-shadow: 0px 8px 34px rgba(221, 62, 86, 0.4);\n      color: #fff;\n      border-color: transparent;\n    }\n  `;\n\n  return styles;\n}\n","import bodyScrollLock from 'body-scroll-lock';\nimport { baseWidgetUrl } from './consts';\nimport { delay, doFetchPurchase } from './event-polling';\nimport { hideWebsiteBelow } from './init-helpers';\n\nimport {\n  areUrlsEqual,\n  importFonts,\n  initDOMNodeWithoutOverlay,\n  initDOMNodeWithOverlay,\n  initWidgetIframeUrl,\n  isCloseModalAlreadyOpen,\n  prepareCloseModalNode,\n} from './init-helpers';\n\nimport {\n  IHostConfig,\n  IHostConfigWithWidgetInstanceId,\n  InternalEventTypes,\n  IPurchaseCreatedEvent,\n  IPurchasePollingCredentials,\n  TAllEvents,\n  TAllEventTypes,\n  TEventListenerDict,\n  TWidgetEvents,\n  WidgetEventTypes,\n} from './types';\n\nimport {\n  countListenersForEvent,\n  determineWidgetVariant,\n  getRandomIntString,\n  initEventListenersDict,\n  isHtmlElement,\n  normalizeConfigAndLogErrorsOnInvalidFields,\n} from './utils';\n\nexport {\n  IWidgetCloseEvent as WidgetCloseEvent,\n  IWidgetCloseRequestCancelledEvent as WidgetCloseRequestCancelledEvent,\n  IWidgetCloseRequestConfirmedEvent as WidgetCloseRequestConfirmedEvent,\n  IWidgetCloseRequestEvent as WidgetCloseRequestEvent,\n  IWidgetConfigDoneEvent as WidgetConfigDoneEvent,\n  IWidgetEvent as RampInstantEvent,\n  TWidgetEvents as RampInstantEvents,\n  WidgetEventTypes as RampInstantEventTypes,\n  AllWidgetVariants as RampInstantWidgetVariantTypes,\n  IPurchase as RampInstantPurchase,\n} from './types';\n\nexport class RampInstantSDK {\n  public widgetWindow?: Window;\n  public domNodes?: {\n    body: HTMLBodyElement | null;\n    iframe: HTMLIFrameElement;\n    overlay: HTMLDivElement | null;\n    shadowHost: HTMLDivElement;\n    shadow: ShadowRoot;\n  };\n\n  private _config: IHostConfigWithWidgetInstanceId;\n  private _rawNormalizedConfig: IHostConfig;\n  private _listeners: TEventListenerDict = initEventListenersDict();\n  private _isVisible: boolean = false;\n  private _isPollingForSwapStatus: boolean = false;\n  private _purchasePollingCredentials: IPurchasePollingCredentials | null = null;\n\n  constructor(config: IHostConfig) {\n    importFonts();\n\n    this.unsubscribe = this.unsubscribe.bind(this);\n    this.on = this.on.bind(this);\n    this.show = this.show.bind(this);\n    this._handleEscapeClick = this._handleEscapeClick.bind(this);\n    this._dispatchEvent = this._dispatchEvent.bind(this);\n    this._subscribeToWidgetEvents = this._subscribeToWidgetEvents.bind(this);\n    this._on = this._on.bind(this);\n    this._processPurchasePollingLoop = this._processPurchasePollingLoop.bind(this);\n    this._registerSdkEventHandlers = this._registerSdkEventHandlers.bind(this);\n    this._runPostSubscribeHooks = this._runPostSubscribeHooks.bind(this);\n    this._subscribeToWidgetEvents = this._subscribeToWidgetEvents.bind(this);\n\n    this._rawNormalizedConfig = normalizeConfigAndLogErrorsOnInvalidFields({\n      variant: 'desktop',\n      ...config,\n    });\n\n    const widgetVariant = determineWidgetVariant(this._rawNormalizedConfig);\n\n    this._config = {\n      ...this._rawNormalizedConfig,\n      variant: widgetVariant,\n      widgetInstanceId: getRandomIntString(),\n    };\n  }\n\n  public show(): RampInstantSDK {\n    if (this._isVisible) {\n      throw new Error('Widget is already visible - you can only call this once per instance');\n    }\n\n    if (document.activeElement && isHtmlElement(document.activeElement)) {\n      document.activeElement.blur();\n    }\n\n    this._registerSdkEventHandlers();\n\n    window.addEventListener('message', this._subscribeToWidgetEvents);\n\n    if (this._isConfiguredAsHosted()) {\n      this._showUsingHostedMode();\n    } else if (this._isConfiguredAsEmbedded()) {\n      this._showUsingEmbeddedMode();\n    } else if (this._isConfiguredWithOverlay()) {\n      this._showUsingOverlayMode();\n    }\n\n    window.addEventListener('keydown', this._handleEscapeClick, true);\n\n    return this;\n  }\n\n  public on<T extends TAllEvents>(\n    type: T['type'] | '*',\n    callback: (event: T) => any\n  ): RampInstantSDK {\n    this._on(type, callback, false);\n\n    return this;\n  }\n\n  public unsubscribe(\n    type: TAllEvents['type'] | '*',\n    callback: (event: TAllEvents) => any\n  ): RampInstantSDK {\n    if (type === '*') {\n      const allTypes = Object.entries(this._listeners);\n\n      allTypes.forEach(([key, eventHandlers]) => {\n        const filteredHandlers = eventHandlers.filter((l) => l.callback !== callback);\n        this._listeners[key as TAllEventTypes] = filteredHandlers;\n      });\n    } else {\n      this._listeners[type] = this._listeners[type].filter((l) => l.callback !== callback);\n    }\n\n    return this;\n  }\n\n  public _on<T extends TAllEvents>(\n    type: T['type'] | '*',\n    callback: (event: T) => any,\n    internal: boolean\n  ): void {\n    if (type !== '*' && !this._listeners[type]) {\n      // tslint:disable-next-line:no-console\n      console.warn(\n        `Unknown / unsupported event name - '${type}'. This listener will have no effect.`\n      );\n    }\n\n    if (type === '*') {\n      const allTypes = Object.values(this._listeners);\n      allTypes.forEach((eventHandlers) => eventHandlers.push({ callback, internal }));\n    } else {\n      this._listeners[type].push({ callback, internal });\n    }\n\n    this._runPostSubscribeHooks(type, internal);\n  }\n\n  private _subscribeToWidgetEvents(event: MessageEvent): void {\n    if (!event.data) {\n      return;\n    }\n\n    if (!areUrlsEqual(event.origin, this._config.url || baseWidgetUrl)) {\n      return;\n    }\n\n    const eventData = event.data as TWidgetEvents;\n\n    if (\n      !eventData.widgetInstanceId ||\n      eventData.widgetInstanceId !== this._config.widgetInstanceId\n    ) {\n      return;\n    }\n\n    this._dispatchEvent(eventData);\n  }\n\n  private _registerSdkEventHandlers(): void {\n    this._on(\n      WidgetEventTypes.WIDGET_CLOSE,\n      (_event) => {\n        if (this._isConfiguredAsHosted()) {\n          try {\n            this.widgetWindow?.close();\n          } catch (e) {\n            throw new Error('Could not close the widget window');\n          }\n        } else {\n          this.domNodes?.shadowHost.remove();\n          bodyScrollLock.clearAllBodyScrollLocks();\n        }\n\n        this._teardownEventSubscriptions();\n      },\n      true\n    );\n\n    const onConfigEvent = () => {\n      if (this._isConfiguredAsHosted()) {\n        return;\n      }\n\n      this.domNodes?.iframe.classList.add('visible');\n\n      const loader = this.domNodes?.shadow.querySelector('.loader-container');\n\n      if (loader) {\n        loader.remove();\n      }\n    };\n\n    this._on(WidgetEventTypes.WIDGET_CONFIG_DONE, onConfigEvent, true);\n    this._on(WidgetEventTypes.WIDGET_CONFIG_FAILED, onConfigEvent, true);\n\n    this._on(\n      InternalEventTypes.WIDGET_CLOSE_REQUEST,\n      (_event) => {\n        if (this._isConfiguredAsHosted() || this._isConfiguredAsEmbedded()) {\n          return;\n        }\n\n        if (this._config.variant === 'mobile' || isCloseModalAlreadyOpen(this.domNodes!.overlay!)) {\n          return;\n        }\n\n        this.domNodes!.overlay!.appendChild(prepareCloseModalNode(this._dispatchEvent));\n      },\n      true\n    );\n\n    this._on(\n      InternalEventTypes.WIDGET_CLOSE_REQUEST_CONFIRMED,\n      (_event) => {\n        this._dispatchEvent({\n          type: WidgetEventTypes.WIDGET_CLOSE,\n          payload: null,\n          widgetInstanceId: this._config.widgetInstanceId,\n        });\n      },\n      true\n    );\n\n    this._on(\n      InternalEventTypes.WIDGET_CLOSE_REQUEST_CANCELLED,\n      (_event) => {\n        if (this._isConfiguredAsHosted() || this._isConfiguredAsEmbedded()) {\n          return;\n        }\n\n        const modal = this.domNodes!.overlay!.querySelector('.close-modal');\n\n        if (modal) {\n          modal.remove();\n        }\n      },\n      true\n    );\n\n    this._on(\n      WidgetEventTypes.PURCHASE_CREATED,\n      (event: IPurchaseCreatedEvent) => {\n        this._purchasePollingCredentials = {\n          apiUrl: event.payload.apiUrl,\n          purchaseExternalId: event.payload.purchase.id,\n          token: event.payload.purchaseViewToken,\n        };\n\n        // tslint:disable-next-line:no-floating-promises\n        this._processPurchasePollingLoop(this._purchasePollingCredentials);\n      },\n      true\n    );\n  }\n\n  private _dispatchEvent(event: TAllEvents): void {\n    const { type } = event;\n\n    this._listeners[type].forEach((handler) => handler.callback(event));\n  }\n\n  private _handleEscapeClick(event: KeyboardEvent): void {\n    const escKeyCode = 27;\n\n    if (event.key === 'Escape' || event.key === 'Esc' || event.keyCode === escKeyCode) {\n      this._dispatchEvent({\n        type: InternalEventTypes.WIDGET_CLOSE_REQUEST,\n        payload: null,\n        internal: true,\n      });\n    }\n  }\n\n  // Event subscriptions aren't cleared so that host can receive a PAYMENT_SUCCESSFUL event\n  // even after the widget has been closed\n  private _teardownEventSubscriptions(): void {\n    window.removeEventListener('keydown', this._handleEscapeClick, true);\n    window.removeEventListener('message', this._subscribeToWidgetEvents);\n  }\n\n  private async _processPurchasePollingLoop({\n    apiUrl,\n    purchaseExternalId,\n    token,\n  }: IPurchasePollingCredentials): Promise<void> {\n    this._isPollingForSwapStatus = true;\n\n    while (\n      countListenersForEvent(this._listeners, WidgetEventTypes.PURCHASE_SUCCESSFUL) > 0 ||\n      countListenersForEvent(this._listeners, WidgetEventTypes.PURCHASE_FAILED) > 0\n    ) {\n      // tslint:disable-next-line:no-magic-numbers\n      await delay(1000);\n\n      const purchase = await doFetchPurchase(apiUrl, purchaseExternalId, token);\n\n      if (!purchase) {\n        continue;\n      }\n\n      if (purchase.actions.find((action) => action.newStatus === 'RELEASED')) {\n        this._dispatchEvent({\n          type: WidgetEventTypes.PURCHASE_SUCCESSFUL,\n          payload: {\n            purchase,\n          },\n          widgetInstanceId: this._config.widgetInstanceId,\n        });\n        return;\n      }\n\n      if (purchase.actions.find((action) => action.newStatus === 'ERROR')) {\n        this._dispatchEvent({\n          type: WidgetEventTypes.PURCHASE_FAILED,\n          payload: null,\n          widgetInstanceId: this._config.widgetInstanceId,\n        });\n        return;\n      }\n    }\n\n    this._isPollingForSwapStatus = false;\n  }\n\n  private _runPostSubscribeHooks(\n    eventType: TAllEventTypes | '*',\n    isHandlerInternal: boolean\n  ): void {\n    /*\n     *  Handles a case where a host subscribes to these events after\n     *  the `PURCHASE_CREATED` event is fired\n     */\n    if (\n      (eventType === '*' ||\n        eventType === WidgetEventTypes.PURCHASE_SUCCESSFUL ||\n        WidgetEventTypes.PURCHASE_FAILED) &&\n      this._purchasePollingCredentials &&\n      !this._isPollingForSwapStatus\n    ) {\n      // tslint:disable-next-line:no-floating-promises\n      this._processPurchasePollingLoop(this._purchasePollingCredentials);\n    }\n  }\n\n  private _showUsingEmbeddedMode(): void {\n    const widgetUrl = initWidgetIframeUrl(this._config);\n\n    this.domNodes = initDOMNodeWithoutOverlay(widgetUrl, this._dispatchEvent, this._config);\n\n    if (!this.domNodes?.body) {\n      throw new Error(\"Couldn't find <body> element.\");\n    }\n\n    this._config.containerNode?.appendChild(this.domNodes.shadowHost);\n\n    this._isVisible = true;\n  }\n\n  private _showUsingOverlayMode(): void {\n    const widgetUrl = initWidgetIframeUrl(this._config);\n\n    this.domNodes = initDOMNodeWithOverlay(widgetUrl, this._dispatchEvent, this._config);\n\n    if (!this.domNodes?.body) {\n      throw new Error(\"Couldn't find <body> element.\");\n    }\n\n    this.domNodes.body.appendChild(this.domNodes.shadowHost);\n\n    this._isVisible = true;\n\n    bodyScrollLock.disableBodyScroll(this.domNodes.iframe);\n\n    const widgetMode = determineWidgetVariant(this._config);\n\n    if (widgetMode !== 'desktop' && widgetMode !== 'embedded-desktop') {\n      hideWebsiteBelow(this.domNodes.shadow);\n    }\n  }\n\n  private _showUsingHostedMode(): void {\n    const widgetUrl = initWidgetIframeUrl(this._config);\n\n    this.widgetWindow = window.open(widgetUrl) ?? undefined;\n  }\n\n  private _isConfiguredWithOverlay(): boolean {\n    return ['desktop', 'mobile'].includes(this._config.variant);\n  }\n\n  private _isConfiguredAsHosted(): boolean {\n    return ['hosted-desktop', 'hosted-mobile'].includes(this._config.variant);\n  }\n\n  private _isConfiguredAsEmbedded(): boolean {\n    return ['embedded-desktop', 'embedded-mobile'].includes(this._rawNormalizedConfig.variant!);\n  }\n}\n"]},"metadata":{},"sourceType":"module"}