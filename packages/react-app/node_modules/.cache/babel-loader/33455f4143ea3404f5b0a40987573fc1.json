{"ast":null,"code":"'use strict';\n\nvar Buffer = require('safe-buffer').Buffer;\n\nvar bip66 = require('bip66');\n\nvar EC_PRIVKEY_EXPORT_DER_COMPRESSED = Buffer.from([// begin\n0x30, 0x81, 0xd3, 0x02, 0x01, 0x01, 0x04, 0x20, // private key\n0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // middle\n0xa0, 0x81, 0x85, 0x30, 0x81, 0x82, 0x02, 0x01, 0x01, 0x30, 0x2c, 0x06, 0x07, 0x2a, 0x86, 0x48, 0xcE, 0x3d, 0x01, 0x01, 0x02, 0x21, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfE, 0xff, 0xff, 0xfc, 0x2f, 0x30, 0x06, 0x04, 0x01, 0x00, 0x04, 0x01, 0x07, 0x04, 0x21, 0x02, 0x79, 0xbE, 0x66, 0x7E, 0xf9, 0xdc, 0xbb, 0xac, 0x55, 0xa0, 0x62, 0x95, 0xcE, 0x87, 0x0b, 0x07, 0x02, 0x9b, 0xfc, 0xdb, 0x2d, 0xcE, 0x28, 0xd9, 0x59, 0xf2, 0x81, 0x5b, 0x16, 0xf8, 0x17, 0x98, 0x02, 0x21, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfE, 0xba, 0xaE, 0xdc, 0xE6, 0xaf, 0x48, 0xa0, 0x3b, 0xbf, 0xd2, 0x5E, 0x8c, 0xd0, 0x36, 0x41, 0x41, 0x02, 0x01, 0x01, 0xa1, 0x24, 0x03, 0x22, 0x00, // public key\n0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]);\nvar EC_PRIVKEY_EXPORT_DER_UNCOMPRESSED = Buffer.from([// begin\n0x30, 0x82, 0x01, 0x13, 0x02, 0x01, 0x01, 0x04, 0x20, // private key\n0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // middle\n0xa0, 0x81, 0xa5, 0x30, 0x81, 0xa2, 0x02, 0x01, 0x01, 0x30, 0x2c, 0x06, 0x07, 0x2a, 0x86, 0x48, 0xcE, 0x3d, 0x01, 0x01, 0x02, 0x21, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfE, 0xff, 0xff, 0xfc, 0x2f, 0x30, 0x06, 0x04, 0x01, 0x00, 0x04, 0x01, 0x07, 0x04, 0x41, 0x04, 0x79, 0xbE, 0x66, 0x7E, 0xf9, 0xdc, 0xbb, 0xac, 0x55, 0xa0, 0x62, 0x95, 0xcE, 0x87, 0x0b, 0x07, 0x02, 0x9b, 0xfc, 0xdb, 0x2d, 0xcE, 0x28, 0xd9, 0x59, 0xf2, 0x81, 0x5b, 0x16, 0xf8, 0x17, 0x98, 0x48, 0x3a, 0xda, 0x77, 0x26, 0xa3, 0xc4, 0x65, 0x5d, 0xa4, 0xfb, 0xfc, 0x0E, 0x11, 0x08, 0xa8, 0xfd, 0x17, 0xb4, 0x48, 0xa6, 0x85, 0x54, 0x19, 0x9c, 0x47, 0xd0, 0x8f, 0xfb, 0x10, 0xd4, 0xb8, 0x02, 0x21, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfE, 0xba, 0xaE, 0xdc, 0xE6, 0xaf, 0x48, 0xa0, 0x3b, 0xbf, 0xd2, 0x5E, 0x8c, 0xd0, 0x36, 0x41, 0x41, 0x02, 0x01, 0x01, 0xa1, 0x44, 0x03, 0x42, 0x00, // public key\n0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]);\n\nexports.privateKeyExport = function (privateKey, publicKey, compressed) {\n  var result = Buffer.from(compressed ? EC_PRIVKEY_EXPORT_DER_COMPRESSED : EC_PRIVKEY_EXPORT_DER_UNCOMPRESSED);\n  privateKey.copy(result, compressed ? 8 : 9);\n  publicKey.copy(result, compressed ? 181 : 214);\n  return result;\n};\n\nexports.privateKeyImport = function (privateKey) {\n  var length = privateKey.length; // sequence header\n\n  var index = 0;\n  if (length < index + 1 || privateKey[index] !== 0x30) return;\n  index += 1; // sequence length constructor\n\n  if (length < index + 1 || !(privateKey[index] & 0x80)) return;\n  var lenb = privateKey[index] & 0x7f;\n  index += 1;\n  if (lenb < 1 || lenb > 2) return;\n  if (length < index + lenb) return; // sequence length\n\n  var len = privateKey[index + lenb - 1] | (lenb > 1 ? privateKey[index + lenb - 2] << 8 : 0);\n  index += lenb;\n  if (length < index + len) return; // sequence element 0: version number (=1)\n\n  if (length < index + 3 || privateKey[index] !== 0x02 || privateKey[index + 1] !== 0x01 || privateKey[index + 2] !== 0x01) {\n    return;\n  }\n\n  index += 3; // sequence element 1: octet string, up to 32 bytes\n\n  if (length < index + 2 || privateKey[index] !== 0x04 || privateKey[index + 1] > 0x20 || length < index + 2 + privateKey[index + 1]) {\n    return;\n  }\n\n  return privateKey.slice(index + 2, index + 2 + privateKey[index + 1]);\n};\n\nexports.signatureExport = function (sigObj) {\n  var r = Buffer.concat([Buffer.from([0]), sigObj.r]);\n\n  for (var lenR = 33, posR = 0; lenR > 1 && r[posR] === 0x00 && !(r[posR + 1] & 0x80); --lenR, ++posR) {\n    ;\n  }\n\n  var s = Buffer.concat([Buffer.from([0]), sigObj.s]);\n\n  for (var lenS = 33, posS = 0; lenS > 1 && s[posS] === 0x00 && !(s[posS + 1] & 0x80); --lenS, ++posS) {\n    ;\n  }\n\n  return bip66.encode(r.slice(posR), s.slice(posS));\n};\n\nexports.signatureImport = function (sig) {\n  var r = Buffer.alloc(32, 0);\n  var s = Buffer.alloc(32, 0);\n\n  try {\n    var sigObj = bip66.decode(sig);\n    if (sigObj.r.length === 33 && sigObj.r[0] === 0x00) sigObj.r = sigObj.r.slice(1);\n    if (sigObj.r.length > 32) throw new Error('R length is too long');\n    if (sigObj.s.length === 33 && sigObj.s[0] === 0x00) sigObj.s = sigObj.s.slice(1);\n    if (sigObj.s.length > 32) throw new Error('S length is too long');\n  } catch (err) {\n    return;\n  }\n\n  sigObj.r.copy(r, 32 - sigObj.r.length);\n  sigObj.s.copy(s, 32 - sigObj.s.length);\n  return {\n    r: r,\n    s: s\n  };\n};\n\nexports.signatureImportLax = function (sig) {\n  var r = Buffer.alloc(32, 0);\n  var s = Buffer.alloc(32, 0);\n  var length = sig.length;\n  var index = 0; // sequence tag byte\n\n  if (sig[index++] !== 0x30) return; // sequence length byte\n\n  var lenbyte = sig[index++];\n\n  if (lenbyte & 0x80) {\n    index += lenbyte - 0x80;\n    if (index > length) return;\n  } // sequence tag byte for r\n\n\n  if (sig[index++] !== 0x02) return; // length for r\n\n  var rlen = sig[index++];\n\n  if (rlen & 0x80) {\n    lenbyte = rlen - 0x80;\n    if (index + lenbyte > length) return;\n\n    for (; lenbyte > 0 && sig[index] === 0x00; index += 1, lenbyte -= 1) {\n      ;\n    }\n\n    for (rlen = 0; lenbyte > 0; index += 1, lenbyte -= 1) {\n      rlen = (rlen << 8) + sig[index];\n    }\n  }\n\n  if (rlen > length - index) return;\n  var rindex = index;\n  index += rlen; // sequence tag byte for s\n\n  if (sig[index++] !== 0x02) return; // length for s\n\n  var slen = sig[index++];\n\n  if (slen & 0x80) {\n    lenbyte = slen - 0x80;\n    if (index + lenbyte > length) return;\n\n    for (; lenbyte > 0 && sig[index] === 0x00; index += 1, lenbyte -= 1) {\n      ;\n    }\n\n    for (slen = 0; lenbyte > 0; index += 1, lenbyte -= 1) {\n      slen = (slen << 8) + sig[index];\n    }\n  }\n\n  if (slen > length - index) return;\n  var sindex = index;\n  index += slen; // ignore leading zeros in r\n\n  for (; rlen > 0 && sig[rindex] === 0x00; rlen -= 1, rindex += 1) {\n    ;\n  } // copy r value\n\n\n  if (rlen > 32) return;\n  var rvalue = sig.slice(rindex, rindex + rlen);\n  rvalue.copy(r, 32 - rvalue.length); // ignore leading zeros in s\n\n  for (; slen > 0 && sig[sindex] === 0x00; slen -= 1, sindex += 1) {\n    ;\n  } // copy s value\n\n\n  if (slen > 32) return;\n  var svalue = sig.slice(sindex, sindex + slen);\n  svalue.copy(s, 32 - svalue.length);\n  return {\n    r: r,\n    s: s\n  };\n};","map":{"version":3,"sources":["/Users/sam/Desktop/kiwik/node_modules/secp256k1/lib/der.js"],"names":["Buffer","require","bip66","EC_PRIVKEY_EXPORT_DER_COMPRESSED","from","EC_PRIVKEY_EXPORT_DER_UNCOMPRESSED","exports","privateKeyExport","privateKey","publicKey","compressed","result","copy","privateKeyImport","length","index","lenb","len","slice","signatureExport","sigObj","r","concat","lenR","posR","s","lenS","posS","encode","signatureImport","sig","alloc","decode","Error","err","signatureImportLax","lenbyte","rlen","rindex","slen","sindex","rvalue","svalue"],"mappings":"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","sourcesContent":["'use strict'\nvar Buffer = require('safe-buffer').Buffer\nvar bip66 = require('bip66')\n\nvar EC_PRIVKEY_EXPORT_DER_COMPRESSED = Buffer.from([\n  // begin\n  0x30, 0x81, 0xd3, 0x02, 0x01, 0x01, 0x04, 0x20,\n  // private key\n  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n  // middle\n  0xa0, 0x81, 0x85, 0x30, 0x81, 0x82, 0x02, 0x01, 0x01, 0x30, 0x2c, 0x06, 0x07, 0x2a, 0x86, 0x48,\n  0xcE, 0x3d, 0x01, 0x01, 0x02, 0x21, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,\n  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,\n  0xff, 0xff, 0xfE, 0xff, 0xff, 0xfc, 0x2f, 0x30, 0x06, 0x04, 0x01, 0x00, 0x04, 0x01, 0x07, 0x04,\n  0x21, 0x02, 0x79, 0xbE, 0x66, 0x7E, 0xf9, 0xdc, 0xbb, 0xac, 0x55, 0xa0, 0x62, 0x95, 0xcE, 0x87,\n  0x0b, 0x07, 0x02, 0x9b, 0xfc, 0xdb, 0x2d, 0xcE, 0x28, 0xd9, 0x59, 0xf2, 0x81, 0x5b, 0x16, 0xf8,\n  0x17, 0x98, 0x02, 0x21, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,\n  0xff, 0xff, 0xff, 0xff, 0xfE, 0xba, 0xaE, 0xdc, 0xE6, 0xaf, 0x48, 0xa0, 0x3b, 0xbf, 0xd2, 0x5E,\n  0x8c, 0xd0, 0x36, 0x41, 0x41, 0x02, 0x01, 0x01, 0xa1, 0x24, 0x03, 0x22, 0x00,\n  // public key\n  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n  0x00\n])\n\nvar EC_PRIVKEY_EXPORT_DER_UNCOMPRESSED = Buffer.from([\n  // begin\n  0x30, 0x82, 0x01, 0x13, 0x02, 0x01, 0x01, 0x04, 0x20,\n  // private key\n  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n  // middle\n  0xa0, 0x81, 0xa5, 0x30, 0x81, 0xa2, 0x02, 0x01, 0x01, 0x30, 0x2c, 0x06, 0x07, 0x2a, 0x86, 0x48,\n  0xcE, 0x3d, 0x01, 0x01, 0x02, 0x21, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,\n  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,\n  0xff, 0xff, 0xfE, 0xff, 0xff, 0xfc, 0x2f, 0x30, 0x06, 0x04, 0x01, 0x00, 0x04, 0x01, 0x07, 0x04,\n  0x41, 0x04, 0x79, 0xbE, 0x66, 0x7E, 0xf9, 0xdc, 0xbb, 0xac, 0x55, 0xa0, 0x62, 0x95, 0xcE, 0x87,\n  0x0b, 0x07, 0x02, 0x9b, 0xfc, 0xdb, 0x2d, 0xcE, 0x28, 0xd9, 0x59, 0xf2, 0x81, 0x5b, 0x16, 0xf8,\n  0x17, 0x98, 0x48, 0x3a, 0xda, 0x77, 0x26, 0xa3, 0xc4, 0x65, 0x5d, 0xa4, 0xfb, 0xfc, 0x0E, 0x11,\n  0x08, 0xa8, 0xfd, 0x17, 0xb4, 0x48, 0xa6, 0x85, 0x54, 0x19, 0x9c, 0x47, 0xd0, 0x8f, 0xfb, 0x10,\n  0xd4, 0xb8, 0x02, 0x21, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,\n  0xff, 0xff, 0xff, 0xff, 0xfE, 0xba, 0xaE, 0xdc, 0xE6, 0xaf, 0x48, 0xa0, 0x3b, 0xbf, 0xd2, 0x5E,\n  0x8c, 0xd0, 0x36, 0x41, 0x41, 0x02, 0x01, 0x01, 0xa1, 0x44, 0x03, 0x42, 0x00,\n  // public key\n  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n  0x00\n])\n\nexports.privateKeyExport = function (privateKey, publicKey, compressed) {\n  var result = Buffer.from(compressed ? EC_PRIVKEY_EXPORT_DER_COMPRESSED : EC_PRIVKEY_EXPORT_DER_UNCOMPRESSED)\n  privateKey.copy(result, compressed ? 8 : 9)\n  publicKey.copy(result, compressed ? 181 : 214)\n  return result\n}\n\nexports.privateKeyImport = function (privateKey) {\n  var length = privateKey.length\n\n  // sequence header\n  var index = 0\n  if (length < index + 1 || privateKey[index] !== 0x30) return\n  index += 1\n\n  // sequence length constructor\n  if (length < index + 1 || !(privateKey[index] & 0x80)) return\n\n  var lenb = privateKey[index] & 0x7f\n  index += 1\n  if (lenb < 1 || lenb > 2) return\n  if (length < index + lenb) return\n\n  // sequence length\n  var len = privateKey[index + lenb - 1] | (lenb > 1 ? privateKey[index + lenb - 2] << 8 : 0)\n  index += lenb\n  if (length < index + len) return\n\n  // sequence element 0: version number (=1)\n  if (length < index + 3 ||\n      privateKey[index] !== 0x02 ||\n      privateKey[index + 1] !== 0x01 ||\n      privateKey[index + 2] !== 0x01) {\n    return\n  }\n  index += 3\n\n  // sequence element 1: octet string, up to 32 bytes\n  if (length < index + 2 ||\n      privateKey[index] !== 0x04 ||\n      privateKey[index + 1] > 0x20 ||\n      length < index + 2 + privateKey[index + 1]) {\n    return\n  }\n\n  return privateKey.slice(index + 2, index + 2 + privateKey[index + 1])\n}\n\nexports.signatureExport = function (sigObj) {\n  var r = Buffer.concat([Buffer.from([0]), sigObj.r])\n  for (var lenR = 33, posR = 0; lenR > 1 && r[posR] === 0x00 && !(r[posR + 1] & 0x80); --lenR, ++posR);\n\n  var s = Buffer.concat([Buffer.from([0]), sigObj.s])\n  for (var lenS = 33, posS = 0; lenS > 1 && s[posS] === 0x00 && !(s[posS + 1] & 0x80); --lenS, ++posS);\n\n  return bip66.encode(r.slice(posR), s.slice(posS))\n}\n\nexports.signatureImport = function (sig) {\n  var r = Buffer.alloc(32, 0)\n  var s = Buffer.alloc(32, 0)\n\n  try {\n    var sigObj = bip66.decode(sig)\n    if (sigObj.r.length === 33 && sigObj.r[0] === 0x00) sigObj.r = sigObj.r.slice(1)\n    if (sigObj.r.length > 32) throw new Error('R length is too long')\n    if (sigObj.s.length === 33 && sigObj.s[0] === 0x00) sigObj.s = sigObj.s.slice(1)\n    if (sigObj.s.length > 32) throw new Error('S length is too long')\n  } catch (err) {\n    return\n  }\n\n  sigObj.r.copy(r, 32 - sigObj.r.length)\n  sigObj.s.copy(s, 32 - sigObj.s.length)\n\n  return { r: r, s: s }\n}\n\nexports.signatureImportLax = function (sig) {\n  var r = Buffer.alloc(32, 0)\n  var s = Buffer.alloc(32, 0)\n\n  var length = sig.length\n  var index = 0\n\n  // sequence tag byte\n  if (sig[index++] !== 0x30) return\n\n  // sequence length byte\n  var lenbyte = sig[index++]\n  if (lenbyte & 0x80) {\n    index += lenbyte - 0x80\n    if (index > length) return\n  }\n\n  // sequence tag byte for r\n  if (sig[index++] !== 0x02) return\n\n  // length for r\n  var rlen = sig[index++]\n  if (rlen & 0x80) {\n    lenbyte = rlen - 0x80\n    if (index + lenbyte > length) return\n    for (; lenbyte > 0 && sig[index] === 0x00; index += 1, lenbyte -= 1);\n    for (rlen = 0; lenbyte > 0; index += 1, lenbyte -= 1) rlen = (rlen << 8) + sig[index]\n  }\n  if (rlen > length - index) return\n  var rindex = index\n  index += rlen\n\n  // sequence tag byte for s\n  if (sig[index++] !== 0x02) return\n\n  // length for s\n  var slen = sig[index++]\n  if (slen & 0x80) {\n    lenbyte = slen - 0x80\n    if (index + lenbyte > length) return\n    for (; lenbyte > 0 && sig[index] === 0x00; index += 1, lenbyte -= 1);\n    for (slen = 0; lenbyte > 0; index += 1, lenbyte -= 1) slen = (slen << 8) + sig[index]\n  }\n  if (slen > length - index) return\n  var sindex = index\n  index += slen\n\n  // ignore leading zeros in r\n  for (; rlen > 0 && sig[rindex] === 0x00; rlen -= 1, rindex += 1);\n  // copy r value\n  if (rlen > 32) return\n  var rvalue = sig.slice(rindex, rindex + rlen)\n  rvalue.copy(r, 32 - rvalue.length)\n\n  // ignore leading zeros in s\n  for (; slen > 0 && sig[sindex] === 0x00; slen -= 1, sindex += 1);\n  // copy s value\n  if (slen > 32) return\n  var svalue = sig.slice(sindex, sindex + slen)\n  svalue.copy(s, 32 - svalue.length)\n\n  return { r: r, s: s }\n}\n"]},"metadata":{},"sourceType":"script"}