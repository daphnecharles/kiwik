{"ast":null,"code":"import _slicedToArray from \"/Users/sam/Desktop/kiwik/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _regeneratorRuntime from \"/Users/sam/Desktop/kiwik/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _toConsumableArray from \"/Users/sam/Desktop/kiwik/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _asyncToGenerator from \"/Users/sam/Desktop/kiwik/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"/Users/sam/Desktop/kiwik/packages/react-app/src/components/Swap.jsx\",\n    _s = $RefreshSig$();\n\nimport { Button, Card, Descriptions, Divider, Drawer, InputNumber, Modal, notification, Row, Select, Space, Tooltip, Typography } from \"antd\";\nimport React, { useEffect, useState } from \"react\";\nimport { ethers } from \"ethers\";\nimport { useBlockNumber, usePoller } from \"eth-hooks\";\nimport { RetweetOutlined, SettingOutlined } from \"@ant-design/icons\";\nimport { ChainId, Fetcher, Percent, Token, TokenAmount, Trade, WETH } from \"@uniswap/sdk\";\nimport { abi as IUniswapV2Router02ABI } from \"@uniswap/v2-periphery/build/IUniswapV2Router02.json\";\nimport { useDebounce } from \"../hooks\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nvar Option = Select.Option;\nvar Text = Typography.Text;\nexport var ROUTER_ADDRESS = \"0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D\";\nexport var ZERO_ADDRESS = \"0x0000000000000000000000000000000000000000\";\nvar erc20Abi = [\"function balanceOf(address owner) view returns (uint256)\", \"function approve(address _spender, uint256 _value) public returns (bool success)\", \"function allowance(address _owner, address _spender) public view returns (uint256 remaining)\"];\n\nvar makeCall = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(callName, contract, args) {\n    var metadata,\n        result,\n        _args = arguments;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            metadata = _args.length > 3 && _args[3] !== undefined ? _args[3] : {};\n\n            if (!contract[callName]) {\n              _context.next = 12;\n              break;\n            }\n\n            if (!args) {\n              _context.next = 8;\n              break;\n            }\n\n            _context.next = 5;\n            return contract[callName].apply(contract, _toConsumableArray(args).concat([metadata]));\n\n          case 5:\n            result = _context.sent;\n            _context.next = 11;\n            break;\n\n          case 8:\n            _context.next = 10;\n            return contract[callName]();\n\n          case 10:\n            result = _context.sent;\n\n          case 11:\n            return _context.abrupt(\"return\", result);\n\n          case 12:\n            console.log(\"no call of that name!\");\n            return _context.abrupt(\"return\", undefined);\n\n          case 14:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function makeCall(_x, _x2, _x3) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar defaultToken = \"ETH\";\nvar defaultTokenOut = \"DAI\";\nvar defaultSlippage = \"0.5\";\nvar defaultTimeLimit = 60 * 10;\n\nvar tokenListToObject = function tokenListToObject(array) {\n  return array.reduce(function (obj, item) {\n    obj[item.symbol] = new Token(item.chainId, item.address, item.decimals, item.symbol, item.name);\n    return obj;\n  }, {});\n};\n\nfunction Swap(_ref2) {\n  _s();\n\n  var _this = this;\n\n  var selectedProvider = _ref2.selectedProvider,\n      tokenListURI = _ref2.tokenListURI;\n\n  var _useState = useState(defaultToken),\n      _useState2 = _slicedToArray(_useState, 2),\n      tokenIn = _useState2[0],\n      setTokenIn = _useState2[1];\n\n  var _useState3 = useState(defaultTokenOut),\n      _useState4 = _slicedToArray(_useState3, 2),\n      tokenOut = _useState4[0],\n      setTokenOut = _useState4[1];\n\n  var _useState5 = useState(),\n      _useState6 = _slicedToArray(_useState5, 2),\n      exact = _useState6[0],\n      setExact = _useState6[1];\n\n  var _useState7 = useState(),\n      _useState8 = _slicedToArray(_useState7, 2),\n      amountIn = _useState8[0],\n      setAmountIn = _useState8[1];\n\n  var _useState9 = useState(),\n      _useState10 = _slicedToArray(_useState9, 2),\n      amountInMax = _useState10[0],\n      setAmountInMax = _useState10[1];\n\n  var _useState11 = useState(),\n      _useState12 = _slicedToArray(_useState11, 2),\n      amountOut = _useState12[0],\n      setAmountOut = _useState12[1];\n\n  var _useState13 = useState(),\n      _useState14 = _slicedToArray(_useState13, 2),\n      amountOutMin = _useState14[0],\n      setAmountOutMin = _useState14[1];\n\n  var _useState15 = useState(),\n      _useState16 = _slicedToArray(_useState15, 2),\n      trades = _useState16[0],\n      setTrades = _useState16[1];\n\n  var _useState17 = useState(),\n      _useState18 = _slicedToArray(_useState17, 2),\n      routerAllowance = _useState18[0],\n      setRouterAllowance = _useState18[1];\n\n  var _useState19 = useState(),\n      _useState20 = _slicedToArray(_useState19, 2),\n      balanceIn = _useState20[0],\n      setBalanceIn = _useState20[1];\n\n  var _useState21 = useState(),\n      _useState22 = _slicedToArray(_useState21, 2),\n      balanceOut = _useState22[0],\n      setBalanceOut = _useState22[1];\n\n  var _useState23 = useState(new Percent(Math.round(defaultSlippage * 100).toString(), \"10000\")),\n      _useState24 = _slicedToArray(_useState23, 2),\n      slippageTolerance = _useState24[0],\n      setSlippageTolerance = _useState24[1];\n\n  var _useState25 = useState(defaultTimeLimit),\n      _useState26 = _slicedToArray(_useState25, 2),\n      timeLimit = _useState26[0],\n      setTimeLimit = _useState26[1];\n\n  var _useState27 = useState(false),\n      _useState28 = _slicedToArray(_useState27, 2),\n      swapping = _useState28[0],\n      setSwapping = _useState28[1];\n\n  var _useState29 = useState(false),\n      _useState30 = _slicedToArray(_useState29, 2),\n      approving = _useState30[0],\n      setApproving = _useState30[1];\n\n  var _useState31 = useState(false),\n      _useState32 = _slicedToArray(_useState31, 2),\n      settingsVisible = _useState32[0],\n      setSettingsVisible = _useState32[1];\n\n  var _useState33 = useState(false),\n      _useState34 = _slicedToArray(_useState33, 2),\n      swapModalVisible = _useState34[0],\n      setSwapModalVisible = _useState34[1];\n\n  var _useState35 = useState([]),\n      _useState36 = _slicedToArray(_useState35, 2),\n      tokenList = _useState36[0],\n      setTokenList = _useState36[1];\n\n  var _useState37 = useState(),\n      _useState38 = _slicedToArray(_useState37, 2),\n      tokens = _useState38[0],\n      setTokens = _useState38[1];\n\n  var _useState39 = useState(false),\n      _useState40 = _slicedToArray(_useState39, 2),\n      invertPrice = _useState40[0],\n      setInvertPrice = _useState40[1];\n\n  var blockNumber = useBlockNumber(selectedProvider, 3000);\n  var signer = selectedProvider.getSigner();\n  var routerContract = new ethers.Contract(ROUTER_ADDRESS, IUniswapV2Router02ABI, signer);\n\n  var _tokenListUri = tokenListURI || \"https://gateway.ipfs.io/ipns/tokens.uniswap.org\";\n\n  var debouncedAmountIn = useDebounce(amountIn, 500);\n  var debouncedAmountOut = useDebounce(amountOut, 500);\n  var activeChainId = process.env.REACT_APP_NETWORK === \"kovan\" ? ChainId.KOVAN : ChainId.MAINNET;\n  useEffect(function () {\n    var getTokenList = /*#__PURE__*/function () {\n      var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        var tokenListResponse, tokenListJson, filteredTokens, ethToken, _tokenList, _tokens;\n\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                console.log(_tokenListUri);\n                _context2.prev = 1;\n                _context2.next = 4;\n                return fetch(_tokenListUri);\n\n              case 4:\n                tokenListResponse = _context2.sent;\n                _context2.next = 7;\n                return tokenListResponse.json();\n\n              case 7:\n                tokenListJson = _context2.sent;\n                filteredTokens = tokenListJson.tokens.filter(function (t) {\n                  return t.chainId === activeChainId;\n                });\n                ethToken = WETH[activeChainId];\n                ethToken.name = \"Ethereum\";\n                ethToken.symbol = \"ETH\";\n                ethToken.logoURI = \"https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png\";\n                _tokenList = [ethToken].concat(_toConsumableArray(filteredTokens));\n                setTokenList(_tokenList);\n                _tokens = tokenListToObject(_tokenList);\n                setTokens(_tokens);\n                _context2.next = 22;\n                break;\n\n              case 19:\n                _context2.prev = 19;\n                _context2.t0 = _context2[\"catch\"](1);\n                console.log(_context2.t0);\n\n              case 22:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, null, [[1, 19]]);\n      }));\n\n      return function getTokenList() {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n\n    getTokenList();\n  }, [tokenListURI, _tokenListUri, activeChainId]);\n\n  var getTrades = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n      var pairs, baseTokens, listOfPairwiseTokens, getPairs, listOfPairs, bestTrade;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              if (!(tokenIn && tokenOut && (amountIn || amountOut))) {\n                _context4.next = 11;\n                break;\n              }\n\n              pairs = function pairs(arr) {\n                return arr.map(function (v, i) {\n                  return arr.slice(i + 1).map(function (w) {\n                    return [v, w];\n                  });\n                }).flat();\n              };\n\n              baseTokens = tokenList.filter(function (t) {\n                return [\"DAI\", \"USDC\", \"USDT\", \"COMP\", \"ETH\", \"MKR\", \"LINK\", tokenIn, tokenOut].includes(t.symbol);\n              }).map(function (el) {\n                return new Token(el.chainId, el.address, el.decimals, el.symbol, el.name);\n              });\n              listOfPairwiseTokens = pairs(baseTokens);\n\n              getPairs = /*#__PURE__*/function () {\n                var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(list) {\n                  var listOfPromises;\n                  return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n                    while (1) {\n                      switch (_context3.prev = _context3.next) {\n                        case 0:\n                          listOfPromises = list.map(function (item) {\n                            return Fetcher.fetchPairData(item[0], item[1], selectedProvider);\n                          });\n                          return _context3.abrupt(\"return\", Promise.all(listOfPromises.map(function (p) {\n                            return p.catch(function () {\n                              return undefined;\n                            });\n                          })));\n\n                        case 2:\n                        case \"end\":\n                          return _context3.stop();\n                      }\n                    }\n                  }, _callee3);\n                }));\n\n                return function getPairs(_x4) {\n                  return _ref5.apply(this, arguments);\n                };\n              }();\n\n              _context4.next = 7;\n              return getPairs(listOfPairwiseTokens);\n\n            case 7:\n              listOfPairs = _context4.sent;\n\n              if (exact === \"in\") {\n                setAmountInMax();\n                bestTrade = Trade.bestTradeExactIn(listOfPairs.filter(function (item) {\n                  return item;\n                }), new TokenAmount(tokens[tokenIn], ethers.utils.parseUnits(amountIn.toString(), tokens[tokenIn].decimals)), tokens[tokenOut], {\n                  maxNumResults: 3,\n                  maxHops: 1\n                });\n\n                if (bestTrade[0]) {\n                  setAmountOut(bestTrade[0].outputAmount.toSignificant(6));\n                } else {\n                  setAmountOut();\n                }\n              } else if (exact === \"out\") {\n                setAmountOutMin();\n                bestTrade = Trade.bestTradeExactOut(listOfPairs.filter(function (item) {\n                  return item;\n                }), tokens[tokenIn], new TokenAmount(tokens[tokenOut], ethers.utils.parseUnits(amountOut.toString(), tokens[tokenOut].decimals)), {\n                  maxNumResults: 3,\n                  maxHops: 1\n                });\n\n                if (bestTrade[0]) {\n                  setAmountIn(bestTrade[0].inputAmount.toSignificant(6));\n                } else {\n                  setAmountIn();\n                }\n              }\n\n              setTrades(bestTrade);\n              console.log(bestTrade);\n\n            case 11:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function getTrades() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    getTrades(); // eslint-disable-next-line\n  }, [tokenIn, tokenOut, debouncedAmountIn, debouncedAmountOut, slippageTolerance, selectedProvider]);\n  useEffect(function () {\n    if (trades && trades[0]) {\n      if (exact === \"in\") {\n        setAmountOutMin(trades[0].minimumAmountOut(slippageTolerance));\n      } else if (exact === \"out\") {\n        setAmountInMax(trades[0].maximumAmountIn(slippageTolerance));\n      }\n    }\n  }, [slippageTolerance, amountIn, amountOut, trades, exact]);\n\n  var getBalance = /*#__PURE__*/function () {\n    var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(_token, _account, _contract) {\n      var newBalance;\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              if (!(_token === \"ETH\")) {\n                _context5.next = 6;\n                break;\n              }\n\n              _context5.next = 3;\n              return selectedProvider.getBalance(_account);\n\n            case 3:\n              newBalance = _context5.sent;\n              _context5.next = 9;\n              break;\n\n            case 6:\n              _context5.next = 8;\n              return makeCall(\"balanceOf\", _contract, [_account]);\n\n            case 8:\n              newBalance = _context5.sent;\n\n            case 9:\n              return _context5.abrupt(\"return\", newBalance);\n\n            case 10:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }));\n\n    return function getBalance(_x5, _x6, _x7) {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n\n  var getAccountInfo = /*#__PURE__*/function () {\n    var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6() {\n      var accountList, tempContractIn, newBalanceIn, allowance, tempContractOut, newBalanceOut;\n      return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              if (!tokens) {\n                _context6.next = 24;\n                break;\n              }\n\n              _context6.next = 3;\n              return selectedProvider.listAccounts();\n\n            case 3:\n              accountList = _context6.sent;\n\n              if (!tokenIn) {\n                _context6.next = 18;\n                break;\n              }\n\n              tempContractIn = new ethers.Contract(tokens[tokenIn].address, erc20Abi, selectedProvider);\n              _context6.next = 8;\n              return getBalance(tokenIn, accountList[0], tempContractIn);\n\n            case 8:\n              newBalanceIn = _context6.sent;\n              setBalanceIn(newBalanceIn);\n\n              if (!(tokenIn === \"ETH\")) {\n                _context6.next = 14;\n                break;\n              }\n\n              setRouterAllowance();\n              _context6.next = 18;\n              break;\n\n            case 14:\n              _context6.next = 16;\n              return makeCall(\"allowance\", tempContractIn, [accountList[0], ROUTER_ADDRESS]);\n\n            case 16:\n              allowance = _context6.sent;\n              setRouterAllowance(allowance);\n\n            case 18:\n              if (!tokenOut) {\n                _context6.next = 24;\n                break;\n              }\n\n              tempContractOut = new ethers.Contract(tokens[tokenOut].address, erc20Abi, selectedProvider);\n              _context6.next = 22;\n              return getBalance(tokenOut, accountList[0], tempContractOut);\n\n            case 22:\n              newBalanceOut = _context6.sent;\n              setBalanceOut(newBalanceOut);\n\n            case 24:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6);\n    }));\n\n    return function getAccountInfo() {\n      return _ref7.apply(this, arguments);\n    };\n  }();\n\n  usePoller(getAccountInfo, 6000);\n  var route = trades ? trades.length > 0 ? trades[0].route.path.map(function (item) {\n    return item.symbol;\n  }) : [] : [];\n\n  var updateRouterAllowance = /*#__PURE__*/function () {\n    var _ref8 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7(newAllowance) {\n      var tempContract, result;\n      return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              setApproving(true);\n              _context7.prev = 1;\n              tempContract = new ethers.Contract(tokens[tokenIn].address, erc20Abi, signer);\n              _context7.next = 5;\n              return makeCall(\"approve\", tempContract, [ROUTER_ADDRESS, newAllowance]);\n\n            case 5:\n              result = _context7.sent;\n              console.log(result);\n              setApproving(false);\n              return _context7.abrupt(\"return\", true);\n\n            case 11:\n              _context7.prev = 11;\n              _context7.t0 = _context7[\"catch\"](1);\n              notification.open({\n                message: \"Approval unsuccessful\",\n                description: \"Error: \".concat(_context7.t0.message)\n              });\n\n            case 14:\n            case \"end\":\n              return _context7.stop();\n          }\n        }\n      }, _callee7, null, [[1, 11]]);\n    }));\n\n    return function updateRouterAllowance(_x8) {\n      return _ref8.apply(this, arguments);\n    };\n  }();\n\n  var approveRouter = /*#__PURE__*/function () {\n    var _ref9 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8() {\n      var approvalAmount, approval;\n      return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n        while (1) {\n          switch (_context8.prev = _context8.next) {\n            case 0:\n              approvalAmount = exact === \"in\" ? ethers.utils.hexlify(ethers.utils.parseUnits(amountIn.toString(), tokens[tokenIn].decimals)) : amountInMax.raw.toString();\n              console.log(approvalAmount);\n              approval = updateRouterAllowance(approvalAmount);\n\n              if (approval) {\n                notification.open({\n                  message: \"Token transfer approved\",\n                  description: \"You can now swap up to \".concat(amountIn, \" \").concat(tokenIn)\n                });\n              }\n\n            case 4:\n            case \"end\":\n              return _context8.stop();\n          }\n        }\n      }, _callee8);\n    }));\n\n    return function approveRouter() {\n      return _ref9.apply(this, arguments);\n    };\n  }();\n\n  var removeRouterAllowance = /*#__PURE__*/function () {\n    var _ref10 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee9() {\n      var approvalAmount, removal;\n      return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n        while (1) {\n          switch (_context9.prev = _context9.next) {\n            case 0:\n              approvalAmount = ethers.utils.hexlify(0);\n              console.log(approvalAmount);\n              removal = updateRouterAllowance(approvalAmount);\n\n              if (removal) {\n                notification.open({\n                  message: \"Token approval removed\",\n                  description: \"The router is no longer approved for \".concat(tokenIn)\n                });\n              }\n\n            case 4:\n            case \"end\":\n              return _context9.stop();\n          }\n        }\n      }, _callee9);\n    }));\n\n    return function removeRouterAllowance() {\n      return _ref10.apply(this, arguments);\n    };\n  }();\n\n  var executeSwap = /*#__PURE__*/function () {\n    var _ref11 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee10() {\n      var args, metadata, call, deadline, path, accountList, address, _amountIn, _amountOutMin, _amountOut, _amountInMax, result;\n\n      return _regeneratorRuntime.wrap(function _callee10$(_context10) {\n        while (1) {\n          switch (_context10.prev = _context10.next) {\n            case 0:\n              setSwapping(true);\n              _context10.prev = 1;\n              metadata = {};\n              deadline = Math.floor(Date.now() / 1000) + timeLimit;\n              path = trades[0].route.path.map(function (item) {\n                return item.address;\n              });\n              console.log(path);\n              _context10.next = 8;\n              return selectedProvider.listAccounts();\n\n            case 8:\n              accountList = _context10.sent;\n              address = accountList[0];\n\n              if (exact === \"in\") {\n                _amountIn = ethers.utils.hexlify(ethers.utils.parseUnits(amountIn.toString(), tokens[tokenIn].decimals));\n                _amountOutMin = ethers.utils.hexlify(ethers.BigNumber.from(amountOutMin.raw.toString()));\n\n                if (tokenIn === \"ETH\") {\n                  call = \"swapExactETHForTokens\";\n                  args = [_amountOutMin, path, address, deadline];\n                  metadata.value = _amountIn;\n                } else {\n                  call = tokenOut === \"ETH\" ? \"swapExactTokensForETH\" : \"swapExactTokensForTokens\";\n                  args = [_amountIn, _amountOutMin, path, address, deadline];\n                }\n              } else if (exact === \"out\") {\n                _amountOut = ethers.utils.hexlify(ethers.utils.parseUnits(amountOut.toString(), tokens[tokenOut].decimals));\n                _amountInMax = ethers.utils.hexlify(ethers.BigNumber.from(amountInMax.raw.toString()));\n\n                if (tokenIn === \"ETH\") {\n                  call = \"swapETHForExactTokens\";\n                  args = [_amountOut, path, address, deadline];\n                  metadata.value = _amountInMax;\n                } else {\n                  call = tokenOut === \"ETH\" ? \"swapTokensForExactETH\" : \"swapTokensForExactTokens\";\n                  args = [_amountOut, _amountInMax, path, address, deadline];\n                }\n              }\n\n              console.log(call, args, metadata);\n              _context10.next = 14;\n              return makeCall(call, routerContract, args, metadata);\n\n            case 14:\n              result = _context10.sent;\n              console.log(result);\n              notification.open({\n                message: \"Swap complete 🦄\",\n                description: /*#__PURE__*/_jsxDEV(_Fragment, {\n                  children: [/*#__PURE__*/_jsxDEV(Text, {\n                    children: \"Swapped \".concat(tokenIn, \" for \").concat(tokenOut, \", transaction: \")\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 334,\n                    columnNumber: 13\n                  }, _this), /*#__PURE__*/_jsxDEV(Text, {\n                    copyable: true,\n                    children: result.hash\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 335,\n                    columnNumber: 13\n                  }, _this)]\n                }, void 0, true)\n              });\n              setSwapping(false);\n              _context10.next = 25;\n              break;\n\n            case 20:\n              _context10.prev = 20;\n              _context10.t0 = _context10[\"catch\"](1);\n              console.log(_context10.t0);\n              setSwapping(false);\n              notification.open({\n                message: \"Swap unsuccessful\",\n                description: \"Error: \".concat(_context10.t0.message)\n              });\n\n            case 25:\n            case \"end\":\n              return _context10.stop();\n          }\n        }\n      }, _callee10, null, [[1, 20]]);\n    }));\n\n    return function executeSwap() {\n      return _ref11.apply(this, arguments);\n    };\n  }();\n\n  var showSwapModal = function showSwapModal() {\n    setSwapModalVisible(true);\n  };\n\n  var handleSwapModalOk = function handleSwapModalOk() {\n    setSwapModalVisible(false);\n    executeSwap();\n  };\n\n  var handleSwapModalCancel = function handleSwapModalCancel() {\n    setSwapModalVisible(false);\n  };\n\n  var insufficientBalance = balanceIn ? parseFloat(ethers.utils.formatUnits(balanceIn, tokens[tokenIn].decimals)) < amountIn : null;\n  var inputIsToken = tokenIn !== \"ETH\";\n  var insufficientAllowance = !inputIsToken ? false : routerAllowance ? parseFloat(ethers.utils.formatUnits(routerAllowance, tokens[tokenIn].decimals)) < amountIn : null;\n  var formattedBalanceIn = balanceIn ? parseFloat(ethers.utils.formatUnits(balanceIn, tokens[tokenIn].decimals)).toPrecision(6) : null;\n  var formattedBalanceOut = balanceOut ? parseFloat(ethers.utils.formatUnits(balanceOut, tokens[tokenOut].decimals)).toPrecision(6) : null;\n  var metaIn = tokens && tokenList && tokenIn ? tokenList.filter(function (t) {\n    return t.address === tokens[tokenIn].address;\n  })[0] : null;\n  var metaOut = tokens && tokenList && tokenOut ? tokenList.filter(function (t) {\n    return t.address === tokens[tokenOut].address;\n  })[0] : null;\n\n  var cleanIpfsURI = function cleanIpfsURI(uri) {\n    try {\n      return uri.replace(\"ipfs://\", \"https://ipfs.io/ipfs/\");\n    } catch (e) {\n      console.log(e, uri);\n      return uri;\n    }\n  };\n\n  var logoIn = metaIn ? cleanIpfsURI(metaIn.logoURI) : null;\n  var logoOut = metaOut ? cleanIpfsURI(metaOut.logoURI) : null;\n  var rawPrice = trades && trades[0] ? trades[0].executionPrice : null;\n  var price = rawPrice ? rawPrice.toSignificant(7) : null;\n  var priceDescription = rawPrice ? invertPrice ? \"\".concat(rawPrice.invert().toSignificant(7), \" \").concat(tokenIn, \" per \").concat(tokenOut) : \"\".concat(price, \" \").concat(tokenOut, \" per \").concat(tokenIn) : null;\n\n  var priceWidget = /*#__PURE__*/_jsxDEV(Space, {\n    children: [/*#__PURE__*/_jsxDEV(Text, {\n      type: \"secondary\",\n      children: priceDescription\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 414,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Button, {\n      type: \"text\",\n      onClick: function onClick() {\n        setInvertPrice(!invertPrice);\n      },\n      children: /*#__PURE__*/_jsxDEV(RetweetOutlined, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 421,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 415,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 413,\n    columnNumber: 5\n  }, this);\n\n  var swapModal = /*#__PURE__*/_jsxDEV(Modal, {\n    title: \"Confirm swap\",\n    visible: swapModalVisible,\n    onOk: handleSwapModalOk,\n    onCancel: handleSwapModalCancel,\n    children: [/*#__PURE__*/_jsxDEV(Row, {\n      children: /*#__PURE__*/_jsxDEV(Space, {\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: logoIn,\n          alt: tokenIn,\n          width: \"30\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 430,\n          columnNumber: 11\n        }, this), amountIn, tokenIn]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 429,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 428,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Row, {\n      justify: \"center\",\n      align: \"middle\",\n      style: {\n        width: 30\n      },\n      children: /*#__PURE__*/_jsxDEV(\"span\", {\n        children: \"\\u2193\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 436,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 435,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Row, {\n      children: /*#__PURE__*/_jsxDEV(Space, {\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: logoOut,\n          alt: tokenOut,\n          width: \"30\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 440,\n          columnNumber: 11\n        }, this), amountOut, tokenOut]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 439,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 438,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Divider, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 445,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Row, {\n      children: priceWidget\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 446,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Row, {\n      children: trades && (amountOutMin && exact === \"in\" || amountInMax && exact === \"out\") ? exact === \"in\" ? \"Output is estimated. You will receive at least \".concat(amountOutMin.toSignificant(6), \" \").concat(tokenOut, \" or the transaction will revert.\") : \"Input is estimated. You will sell at most \".concat(amountInMax.toSignificant(6), \" \").concat(tokenIn, \" or the transaction will revert.\") : null\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 447,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 427,\n    columnNumber: 5\n  }, this);\n\n  return /*#__PURE__*/_jsxDEV(Card, {\n    title: /*#__PURE__*/_jsxDEV(Space, {\n      children: [/*#__PURE__*/_jsxDEV(\"img\", {\n        src: \"https://ipfs.io/ipfs/QmXttGpZrECX5qCyXbBQiqgQNytVGeZW5Anewvh2jc4psg\",\n        width: \"40\",\n        alt: \"uniswapLogo\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 465,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Typography, {\n        children: \"Uniswapper\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 466,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 464,\n      columnNumber: 9\n    }, this),\n    extra: /*#__PURE__*/_jsxDEV(Button, {\n      type: \"text\",\n      onClick: function onClick() {\n        setSettingsVisible(true);\n      },\n      children: /*#__PURE__*/_jsxDEV(SettingOutlined, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 476,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 470,\n      columnNumber: 9\n    }, this),\n    children: [/*#__PURE__*/_jsxDEV(Space, {\n      direction: \"vertical\",\n      children: [/*#__PURE__*/_jsxDEV(Row, {\n        justify: \"center\",\n        align: \"middle\",\n        children: /*#__PURE__*/_jsxDEV(Card, {\n          size: \"small\",\n          type: \"inner\",\n          title: \"From\".concat(exact === \"out\" && tokenIn && tokenOut ? \" (estimate)\" : \"\"),\n          extra: /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              src: logoIn,\n              alt: tokenIn,\n              width: \"30\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 488,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              type: \"link\",\n              onClick: function onClick() {\n                setAmountOut();\n                setAmountIn(ethers.utils.formatUnits(balanceIn, tokens[tokenIn].decimals));\n                setAmountOutMin();\n                setAmountInMax();\n                setExact(\"in\");\n              },\n              children: formattedBalanceIn\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 489,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true),\n          style: {\n            width: 400,\n            textAlign: \"left\"\n          },\n          children: [/*#__PURE__*/_jsxDEV(InputNumber, {\n            style: {\n              width: \"160px\"\n            },\n            min: 0,\n            size: \"large\",\n            value: amountIn,\n            onChange: function onChange(e) {\n              setAmountOut();\n              setTrades();\n              setAmountIn(e);\n              setExact(\"in\");\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 505,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Select, {\n            showSearch: true,\n            value: tokenIn,\n            style: {\n              width: \"120px\"\n            },\n            size: \"large\",\n            bordered: false,\n            defaultValue: defaultToken,\n            onChange: function onChange(value) {\n              console.log(value);\n\n              if (value === tokenOut) {\n                console.log(\"switch!\", tokenIn);\n                setTokenOut(tokenIn);\n                setAmountOut(amountIn);\n                setBalanceOut(balanceIn);\n              }\n\n              setTokenIn(value);\n              setTrades();\n              setAmountIn();\n              setExact(\"out\");\n              setBalanceIn();\n            },\n            filterOption: function filterOption(input, option) {\n              return option.children.toLowerCase().indexOf(input.toLowerCase()) >= 0;\n            },\n            optionFilterProp: \"children\",\n            children: tokenList.map(function (token) {\n              return /*#__PURE__*/_jsxDEV(Option, {\n                value: token.symbol,\n                children: token.symbol\n              }, token.symbol, false, {\n                fileName: _jsxFileName,\n                lineNumber: 542,\n                columnNumber: 17\n              }, _this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 517,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 482,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 481,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Row, {\n        justify: \"center\",\n        align: \"middle\",\n        children: /*#__PURE__*/_jsxDEV(Tooltip, {\n          title: route.join(\"->\"),\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"\\u2193\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 551,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 550,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 549,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Row, {\n        justify: \"center\",\n        align: \"middle\",\n        children: /*#__PURE__*/_jsxDEV(Card, {\n          size: \"small\",\n          type: \"inner\",\n          title: \"To\".concat(exact === \"in\" && tokenIn && tokenOut ? \" (estimate)\" : \"\"),\n          extra: /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              src: logoOut,\n              width: \"30\",\n              alt: tokenOut\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 561,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              type: \"text\",\n              children: formattedBalanceOut\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 562,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true),\n          style: {\n            width: 400,\n            textAlign: \"left\"\n          },\n          children: [/*#__PURE__*/_jsxDEV(InputNumber, {\n            style: {\n              width: \"160px\"\n            },\n            size: \"large\",\n            min: 0,\n            value: amountOut,\n            onChange: function onChange(e) {\n              setAmountOut(e);\n              setAmountIn();\n              setTrades();\n              setExact(\"out\");\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 567,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Select, {\n            showSearch: true,\n            value: tokenOut,\n            style: {\n              width: \"120px\"\n            },\n            size: \"large\",\n            bordered: false,\n            onChange: function onChange(value) {\n              console.log(value, tokenIn, tokenOut);\n\n              if (value === tokenIn) {\n                console.log(\"switch!\", tokenOut);\n                setTokenIn(tokenOut);\n                setAmountIn(amountOut);\n                setBalanceIn(balanceOut);\n              }\n\n              setTokenOut(value);\n              setExact(\"in\");\n              setAmountOut();\n              setTrades();\n              setBalanceOut();\n            },\n            filterOption: function filterOption(input, option) {\n              return option.children.toLowerCase().indexOf(input.toLowerCase()) >= 0;\n            },\n            optionFilterProp: \"children\",\n            children: tokenList.map(function (token) {\n              return /*#__PURE__*/_jsxDEV(Option, {\n                value: token.symbol,\n                children: token.symbol\n              }, token.symbol, false, {\n                fileName: _jsxFileName,\n                lineNumber: 603,\n                columnNumber: 17\n              }, _this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 579,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 555,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 554,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Row, {\n        justify: \"center\",\n        align: \"middle\",\n        children: priceDescription ? priceWidget : null\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 610,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Row, {\n        justify: \"center\",\n        align: \"middle\",\n        children: /*#__PURE__*/_jsxDEV(Space, {\n          children: [inputIsToken ? /*#__PURE__*/_jsxDEV(Button, {\n            size: \"large\",\n            loading: approving,\n            disabled: !insufficientAllowance,\n            onClick: approveRouter,\n            children: !insufficientAllowance && amountIn && amountOut ? \"Approved\" : \"Approve\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 616,\n            columnNumber: 15\n          }, this) : null, /*#__PURE__*/_jsxDEV(Button, {\n            size: \"large\",\n            loading: swapping,\n            disabled: insufficientAllowance || insufficientBalance || !amountIn || !amountOut,\n            onClick: showSwapModal,\n            children: insufficientBalance ? \"Insufficient balance\" : \"Swap!\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 620,\n            columnNumber: 13\n          }, this), swapModal]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 614,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 613,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 480,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Drawer, {\n      visible: settingsVisible,\n      onClose: function onClose() {\n        setSettingsVisible(false);\n      },\n      width: 500,\n      children: /*#__PURE__*/_jsxDEV(Descriptions, {\n        title: \"Details\",\n        column: 1,\n        style: {\n          textAlign: \"left\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(Descriptions.Item, {\n          label: \"blockNumber\",\n          children: blockNumber\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 640,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Descriptions.Item, {\n          label: \"routerAllowance\",\n          children: /*#__PURE__*/_jsxDEV(Space, {\n            children: [routerAllowance ? ethers.utils.formatUnits(routerAllowance, tokens[tokenIn].decimals) : null, routerAllowance > 0 ? /*#__PURE__*/_jsxDEV(Button, {\n              onClick: removeRouterAllowance,\n              children: \"Remove Allowance\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 644,\n              columnNumber: 38\n            }, this) : null]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 642,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 641,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Descriptions.Item, {\n          label: \"route\",\n          children: route.join(\"->\")\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 647,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Descriptions.Item, {\n          label: \"exact\",\n          children: exact\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 648,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Descriptions.Item, {\n          label: \"bestPrice\",\n          children: trades ? trades.length > 0 ? trades[0].executionPrice.toSignificant(6) : null : null\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 649,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Descriptions.Item, {\n          label: \"nextMidPrice\",\n          children: trades ? trades.length > 0 ? trades[0].nextMidPrice.toSignificant(6) : null : null\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 652,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Descriptions.Item, {\n          label: \"priceImpact\",\n          children: trades ? trades.length > 0 ? trades[0].priceImpact.toSignificant(6) : null : null\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 655,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Descriptions.Item, {\n          label: \"slippageTolerance\",\n          children: /*#__PURE__*/_jsxDEV(InputNumber, {\n            defaultValue: defaultSlippage,\n            min: 0,\n            max: 100,\n            precision: 2,\n            formatter: function formatter(value) {\n              return \"\".concat(value, \"%\");\n            },\n            parser: function parser(value) {\n              return value.replace(\"%\", \"\");\n            },\n            onChange: function onChange(value) {\n              console.log(value);\n              var slippagePercent = new Percent(Math.round(value * 100).toString(), \"10000\");\n              setSlippageTolerance(slippagePercent);\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 659,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 658,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Descriptions.Item, {\n          label: \"amountInMax\",\n          children: amountInMax ? amountInMax.toExact() : null\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 674,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Descriptions.Item, {\n          label: \"amountOutMin\",\n          children: amountOutMin ? amountOutMin.toExact() : null\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 675,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Descriptions.Item, {\n          label: \"timeLimitInSeconds\",\n          children: /*#__PURE__*/_jsxDEV(InputNumber, {\n            min: 0,\n            max: 3600,\n            defaultValue: defaultTimeLimit,\n            onChange: function onChange(value) {\n              console.log(value);\n              setTimeLimit(value);\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 677,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 676,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 639,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 632,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 462,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Swap, \"OSaCcudNhqj8C1bdfxC/UnQ+OCc=\", false, function () {\n  return [useBlockNumber, useDebounce, useDebounce, usePoller];\n});\n\n_c = Swap;\nexport default Swap;\n\nvar _c;\n\n$RefreshReg$(_c, \"Swap\");","map":{"version":3,"sources":["/Users/sam/Desktop/kiwik/packages/react-app/src/components/Swap.jsx"],"names":["Button","Card","Descriptions","Divider","Drawer","InputNumber","Modal","notification","Row","Select","Space","Tooltip","Typography","React","useEffect","useState","ethers","useBlockNumber","usePoller","RetweetOutlined","SettingOutlined","ChainId","Fetcher","Percent","Token","TokenAmount","Trade","WETH","abi","IUniswapV2Router02ABI","useDebounce","Option","Text","ROUTER_ADDRESS","ZERO_ADDRESS","erc20Abi","makeCall","callName","contract","args","metadata","result","console","log","undefined","defaultToken","defaultTokenOut","defaultSlippage","defaultTimeLimit","tokenListToObject","array","reduce","obj","item","symbol","chainId","address","decimals","name","Swap","selectedProvider","tokenListURI","tokenIn","setTokenIn","tokenOut","setTokenOut","exact","setExact","amountIn","setAmountIn","amountInMax","setAmountInMax","amountOut","setAmountOut","amountOutMin","setAmountOutMin","trades","setTrades","routerAllowance","setRouterAllowance","balanceIn","setBalanceIn","balanceOut","setBalanceOut","Math","round","toString","slippageTolerance","setSlippageTolerance","timeLimit","setTimeLimit","swapping","setSwapping","approving","setApproving","settingsVisible","setSettingsVisible","swapModalVisible","setSwapModalVisible","tokenList","setTokenList","tokens","setTokens","invertPrice","setInvertPrice","blockNumber","signer","getSigner","routerContract","Contract","_tokenListUri","debouncedAmountIn","debouncedAmountOut","activeChainId","process","env","REACT_APP_NETWORK","KOVAN","MAINNET","getTokenList","fetch","tokenListResponse","json","tokenListJson","filteredTokens","filter","t","ethToken","logoURI","_tokenList","_tokens","getTrades","pairs","arr","map","v","i","slice","w","flat","baseTokens","includes","el","listOfPairwiseTokens","getPairs","list","listOfPromises","fetchPairData","Promise","all","p","catch","listOfPairs","bestTrade","bestTradeExactIn","utils","parseUnits","maxNumResults","maxHops","outputAmount","toSignificant","bestTradeExactOut","inputAmount","minimumAmountOut","maximumAmountIn","getBalance","_token","_account","_contract","newBalance","getAccountInfo","listAccounts","accountList","tempContractIn","newBalanceIn","allowance","tempContractOut","newBalanceOut","route","length","path","updateRouterAllowance","newAllowance","tempContract","open","message","description","approveRouter","approvalAmount","hexlify","raw","approval","removeRouterAllowance","removal","executeSwap","deadline","floor","Date","now","_amountIn","_amountOutMin","BigNumber","from","call","value","_amountOut","_amountInMax","hash","showSwapModal","handleSwapModalOk","handleSwapModalCancel","insufficientBalance","parseFloat","formatUnits","inputIsToken","insufficientAllowance","formattedBalanceIn","toPrecision","formattedBalanceOut","metaIn","metaOut","cleanIpfsURI","uri","replace","e","logoIn","logoOut","rawPrice","executionPrice","price","priceDescription","invert","priceWidget","swapModal","width","textAlign","input","option","children","toLowerCase","indexOf","token","join","nextMidPrice","priceImpact","slippagePercent","toExact"],"mappings":"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","sourcesContent":["import {\n  Button,\n  Card,\n  Descriptions,\n  Divider,\n  Drawer,\n  InputNumber,\n  Modal,\n  notification,\n  Row,\n  Select,\n  Space,\n  Tooltip,\n  Typography,\n} from \"antd\";\nimport React, { useEffect, useState } from \"react\";\nimport { ethers } from \"ethers\";\nimport { useBlockNumber, usePoller } from \"eth-hooks\";\nimport { RetweetOutlined, SettingOutlined } from \"@ant-design/icons\";\nimport { ChainId, Fetcher, Percent, Token, TokenAmount, Trade, WETH } from \"@uniswap/sdk\";\nimport { abi as IUniswapV2Router02ABI } from \"@uniswap/v2-periphery/build/IUniswapV2Router02.json\";\n\nimport { useDebounce } from \"../hooks\";\n\nconst { Option } = Select;\nconst { Text } = Typography;\n\nexport const ROUTER_ADDRESS = \"0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D\";\n\nexport const ZERO_ADDRESS = \"0x0000000000000000000000000000000000000000\";\n\nconst erc20Abi = [\n  \"function balanceOf(address owner) view returns (uint256)\",\n  \"function approve(address _spender, uint256 _value) public returns (bool success)\",\n  \"function allowance(address _owner, address _spender) public view returns (uint256 remaining)\",\n];\n\nconst makeCall = async (callName, contract, args, metadata = {}) => {\n  if (contract[callName]) {\n    let result;\n    if (args) {\n      result = await contract[callName](...args, metadata);\n    } else {\n      result = await contract[callName]();\n    }\n    return result;\n  }\n  console.log(\"no call of that name!\");\n  return undefined;\n};\n\nconst defaultToken = \"ETH\";\nconst defaultTokenOut = \"DAI\";\nconst defaultSlippage = \"0.5\";\nconst defaultTimeLimit = 60 * 10;\n\nconst tokenListToObject = array =>\n  array.reduce((obj, item) => {\n    obj[item.symbol] = new Token(item.chainId, item.address, item.decimals, item.symbol, item.name);\n    return obj;\n  }, {});\n\nfunction Swap({ selectedProvider, tokenListURI }) {\n  const [tokenIn, setTokenIn] = useState(defaultToken);\n  const [tokenOut, setTokenOut] = useState(defaultTokenOut);\n  const [exact, setExact] = useState();\n  const [amountIn, setAmountIn] = useState();\n  const [amountInMax, setAmountInMax] = useState();\n  const [amountOut, setAmountOut] = useState();\n  const [amountOutMin, setAmountOutMin] = useState();\n  const [trades, setTrades] = useState();\n  const [routerAllowance, setRouterAllowance] = useState();\n  const [balanceIn, setBalanceIn] = useState();\n  const [balanceOut, setBalanceOut] = useState();\n  const [slippageTolerance, setSlippageTolerance] = useState(\n    new Percent(Math.round(defaultSlippage * 100).toString(), \"10000\"),\n  );\n  const [timeLimit, setTimeLimit] = useState(defaultTimeLimit);\n  const [swapping, setSwapping] = useState(false);\n  const [approving, setApproving] = useState(false);\n  const [settingsVisible, setSettingsVisible] = useState(false);\n  const [swapModalVisible, setSwapModalVisible] = useState(false);\n\n  const [tokenList, setTokenList] = useState([]);\n  const [tokens, setTokens] = useState();\n  const [invertPrice, setInvertPrice] = useState(false);\n\n  const blockNumber = useBlockNumber(selectedProvider, 3000);\n\n  const signer = selectedProvider.getSigner();\n  const routerContract = new ethers.Contract(ROUTER_ADDRESS, IUniswapV2Router02ABI, signer);\n\n  const _tokenListUri = tokenListURI || \"https://gateway.ipfs.io/ipns/tokens.uniswap.org\";\n\n  const debouncedAmountIn = useDebounce(amountIn, 500);\n  const debouncedAmountOut = useDebounce(amountOut, 500);\n\n  const activeChainId = process.env.REACT_APP_NETWORK === \"kovan\" ? ChainId.KOVAN : ChainId.MAINNET;\n\n  useEffect(() => {\n    const getTokenList = async () => {\n      console.log(_tokenListUri);\n      try {\n        const tokenListResponse = await fetch(_tokenListUri);\n        const tokenListJson = await tokenListResponse.json();\n        const filteredTokens = tokenListJson.tokens.filter(function (t) {\n          return t.chainId === activeChainId;\n        });\n        const ethToken = WETH[activeChainId];\n        ethToken.name = \"Ethereum\";\n        ethToken.symbol = \"ETH\";\n        ethToken.logoURI =\n          \"https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png\";\n        const _tokenList = [ethToken, ...filteredTokens];\n        setTokenList(_tokenList);\n        const _tokens = tokenListToObject(_tokenList);\n        setTokens(_tokens);\n      } catch (e) {\n        console.log(e);\n      }\n    };\n    getTokenList();\n  }, [tokenListURI, _tokenListUri, activeChainId]);\n\n  const getTrades = async () => {\n    if (tokenIn && tokenOut && (amountIn || amountOut)) {\n      const pairs = arr => arr.map((v, i) => arr.slice(i + 1).map(w => [v, w])).flat();\n\n      const baseTokens = tokenList\n        .filter(function (t) {\n          return [\"DAI\", \"USDC\", \"USDT\", \"COMP\", \"ETH\", \"MKR\", \"LINK\", tokenIn, tokenOut].includes(t.symbol);\n        })\n        .map(el => {\n          return new Token(el.chainId, el.address, el.decimals, el.symbol, el.name);\n        });\n\n      const listOfPairwiseTokens = pairs(baseTokens);\n\n      const getPairs = async list => {\n        const listOfPromises = list.map(item => Fetcher.fetchPairData(item[0], item[1], selectedProvider));\n        return Promise.all(listOfPromises.map(p => p.catch(() => undefined)));\n      };\n\n      const listOfPairs = await getPairs(listOfPairwiseTokens);\n\n      let bestTrade;\n\n      if (exact === \"in\") {\n        setAmountInMax();\n        bestTrade = Trade.bestTradeExactIn(\n          listOfPairs.filter(item => item),\n          new TokenAmount(tokens[tokenIn], ethers.utils.parseUnits(amountIn.toString(), tokens[tokenIn].decimals)),\n          tokens[tokenOut],\n          { maxNumResults: 3, maxHops: 1 },\n        );\n        if (bestTrade[0]) {\n          setAmountOut(bestTrade[0].outputAmount.toSignificant(6));\n        } else {\n          setAmountOut();\n        }\n      } else if (exact === \"out\") {\n        setAmountOutMin();\n        bestTrade = Trade.bestTradeExactOut(\n          listOfPairs.filter(item => item),\n          tokens[tokenIn],\n          new TokenAmount(tokens[tokenOut], ethers.utils.parseUnits(amountOut.toString(), tokens[tokenOut].decimals)),\n          { maxNumResults: 3, maxHops: 1 },\n        );\n        if (bestTrade[0]) {\n          setAmountIn(bestTrade[0].inputAmount.toSignificant(6));\n        } else {\n          setAmountIn();\n        }\n      }\n\n      setTrades(bestTrade);\n\n      console.log(bestTrade);\n    }\n  };\n\n  useEffect(() => {\n    getTrades();\n    // eslint-disable-next-line\n  }, [tokenIn, tokenOut, debouncedAmountIn, debouncedAmountOut, slippageTolerance, selectedProvider]);\n\n  useEffect(() => {\n    if (trades && trades[0]) {\n      if (exact === \"in\") {\n        setAmountOutMin(trades[0].minimumAmountOut(slippageTolerance));\n      } else if (exact === \"out\") {\n        setAmountInMax(trades[0].maximumAmountIn(slippageTolerance));\n      }\n    }\n  }, [slippageTolerance, amountIn, amountOut, trades, exact]);\n\n  const getBalance = async (_token, _account, _contract) => {\n    let newBalance;\n    if (_token === \"ETH\") {\n      newBalance = await selectedProvider.getBalance(_account);\n    } else {\n      newBalance = await makeCall(\"balanceOf\", _contract, [_account]);\n    }\n    return newBalance;\n  };\n\n  const getAccountInfo = async () => {\n    if (tokens) {\n      const accountList = await selectedProvider.listAccounts();\n\n      if (tokenIn) {\n        const tempContractIn = new ethers.Contract(tokens[tokenIn].address, erc20Abi, selectedProvider);\n        const newBalanceIn = await getBalance(tokenIn, accountList[0], tempContractIn);\n        setBalanceIn(newBalanceIn);\n\n        let allowance;\n\n        if (tokenIn === \"ETH\") {\n          setRouterAllowance();\n        } else {\n          allowance = await makeCall(\"allowance\", tempContractIn, [accountList[0], ROUTER_ADDRESS]);\n          setRouterAllowance(allowance);\n        }\n      }\n\n      if (tokenOut) {\n        const tempContractOut = new ethers.Contract(tokens[tokenOut].address, erc20Abi, selectedProvider);\n        const newBalanceOut = await getBalance(tokenOut, accountList[0], tempContractOut);\n        setBalanceOut(newBalanceOut);\n      }\n    }\n  };\n\n  usePoller(getAccountInfo, 6000);\n\n  const route = trades\n    ? trades.length > 0\n      ? trades[0].route.path.map(function (item) {\n          return item.symbol;\n        })\n      : []\n    : [];\n\n  const updateRouterAllowance = async newAllowance => {\n    setApproving(true);\n    try {\n      const tempContract = new ethers.Contract(tokens[tokenIn].address, erc20Abi, signer);\n      const result = await makeCall(\"approve\", tempContract, [ROUTER_ADDRESS, newAllowance]);\n      console.log(result);\n      setApproving(false);\n      return true;\n    } catch (e) {\n      notification.open({\n        message: \"Approval unsuccessful\",\n        description: `Error: ${e.message}`,\n      });\n    }\n  };\n\n  const approveRouter = async () => {\n    const approvalAmount =\n      exact === \"in\"\n        ? ethers.utils.hexlify(ethers.utils.parseUnits(amountIn.toString(), tokens[tokenIn].decimals))\n        : amountInMax.raw.toString();\n    console.log(approvalAmount);\n    const approval = updateRouterAllowance(approvalAmount);\n    if (approval) {\n      notification.open({\n        message: \"Token transfer approved\",\n        description: `You can now swap up to ${amountIn} ${tokenIn}`,\n      });\n    }\n  };\n\n  const removeRouterAllowance = async () => {\n    const approvalAmount = ethers.utils.hexlify(0);\n    console.log(approvalAmount);\n    const removal = updateRouterAllowance(approvalAmount);\n    if (removal) {\n      notification.open({\n        message: \"Token approval removed\",\n        description: `The router is no longer approved for ${tokenIn}`,\n      });\n    }\n  };\n\n  const executeSwap = async () => {\n    setSwapping(true);\n    try {\n      let args;\n      const metadata = {};\n\n      let call;\n      const deadline = Math.floor(Date.now() / 1000) + timeLimit;\n      const path = trades[0].route.path.map(function (item) {\n        return item.address;\n      });\n      console.log(path);\n      const accountList = await selectedProvider.listAccounts();\n      const address = accountList[0];\n\n      if (exact === \"in\") {\n        const _amountIn = ethers.utils.hexlify(ethers.utils.parseUnits(amountIn.toString(), tokens[tokenIn].decimals));\n        const _amountOutMin = ethers.utils.hexlify(ethers.BigNumber.from(amountOutMin.raw.toString()));\n        if (tokenIn === \"ETH\") {\n          call = \"swapExactETHForTokens\";\n          args = [_amountOutMin, path, address, deadline];\n          metadata.value = _amountIn;\n        } else {\n          call = tokenOut === \"ETH\" ? \"swapExactTokensForETH\" : \"swapExactTokensForTokens\";\n          args = [_amountIn, _amountOutMin, path, address, deadline];\n        }\n      } else if (exact === \"out\") {\n        const _amountOut = ethers.utils.hexlify(\n          ethers.utils.parseUnits(amountOut.toString(), tokens[tokenOut].decimals),\n        );\n        const _amountInMax = ethers.utils.hexlify(ethers.BigNumber.from(amountInMax.raw.toString()));\n        if (tokenIn === \"ETH\") {\n          call = \"swapETHForExactTokens\";\n          args = [_amountOut, path, address, deadline];\n          metadata.value = _amountInMax;\n        } else {\n          call = tokenOut === \"ETH\" ? \"swapTokensForExactETH\" : \"swapTokensForExactTokens\";\n          args = [_amountOut, _amountInMax, path, address, deadline];\n        }\n      }\n      console.log(call, args, metadata);\n      const result = await makeCall(call, routerContract, args, metadata);\n      console.log(result);\n      notification.open({\n        message: \"Swap complete 🦄\",\n        description: (\n          <>\n            <Text>{`Swapped ${tokenIn} for ${tokenOut}, transaction: `}</Text>\n            <Text copyable>{result.hash}</Text>\n          </>\n        ),\n      });\n      setSwapping(false);\n    } catch (e) {\n      console.log(e);\n      setSwapping(false);\n      notification.open({\n        message: \"Swap unsuccessful\",\n        description: `Error: ${e.message}`,\n      });\n    }\n  };\n\n  const showSwapModal = () => {\n    setSwapModalVisible(true);\n  };\n\n  const handleSwapModalOk = () => {\n    setSwapModalVisible(false);\n    executeSwap();\n  };\n\n  const handleSwapModalCancel = () => {\n    setSwapModalVisible(false);\n  };\n\n  const insufficientBalance = balanceIn\n    ? parseFloat(ethers.utils.formatUnits(balanceIn, tokens[tokenIn].decimals)) < amountIn\n    : null;\n  const inputIsToken = tokenIn !== \"ETH\";\n  const insufficientAllowance = !inputIsToken\n    ? false\n    : routerAllowance\n    ? parseFloat(ethers.utils.formatUnits(routerAllowance, tokens[tokenIn].decimals)) < amountIn\n    : null;\n  const formattedBalanceIn = balanceIn\n    ? parseFloat(ethers.utils.formatUnits(balanceIn, tokens[tokenIn].decimals)).toPrecision(6)\n    : null;\n  const formattedBalanceOut = balanceOut\n    ? parseFloat(ethers.utils.formatUnits(balanceOut, tokens[tokenOut].decimals)).toPrecision(6)\n    : null;\n\n  const metaIn =\n    tokens && tokenList && tokenIn\n      ? tokenList.filter(function (t) {\n          return t.address === tokens[tokenIn].address;\n        })[0]\n      : null;\n  const metaOut =\n    tokens && tokenList && tokenOut\n      ? tokenList.filter(function (t) {\n          return t.address === tokens[tokenOut].address;\n        })[0]\n      : null;\n\n  const cleanIpfsURI = uri => {\n    try {\n      return uri.replace(\"ipfs://\", \"https://ipfs.io/ipfs/\");\n    } catch (e) {\n      console.log(e, uri);\n      return uri;\n    }\n  };\n\n  const logoIn = metaIn ? cleanIpfsURI(metaIn.logoURI) : null;\n  const logoOut = metaOut ? cleanIpfsURI(metaOut.logoURI) : null;\n\n  const rawPrice = trades && trades[0] ? trades[0].executionPrice : null;\n  const price = rawPrice ? rawPrice.toSignificant(7) : null;\n  const priceDescription = rawPrice\n    ? invertPrice\n      ? `${rawPrice.invert().toSignificant(7)} ${tokenIn} per ${tokenOut}`\n      : `${price} ${tokenOut} per ${tokenIn}`\n    : null;\n\n  const priceWidget = (\n    <Space>\n      <Text type=\"secondary\">{priceDescription}</Text>\n      <Button\n        type=\"text\"\n        onClick={() => {\n          setInvertPrice(!invertPrice);\n        }}\n      >\n        <RetweetOutlined />\n      </Button>\n    </Space>\n  );\n\n  const swapModal = (\n    <Modal title=\"Confirm swap\" visible={swapModalVisible} onOk={handleSwapModalOk} onCancel={handleSwapModalCancel}>\n      <Row>\n        <Space>\n          <img src={logoIn} alt={tokenIn} width=\"30\" />\n          {amountIn}\n          {tokenIn}\n        </Space>\n      </Row>\n      <Row justify=\"center\" align=\"middle\" style={{ width: 30 }}>\n        <span>↓</span>\n      </Row>\n      <Row>\n        <Space>\n          <img src={logoOut} alt={tokenOut} width=\"30\" />\n          {amountOut}\n          {tokenOut}\n        </Space>\n      </Row>\n      <Divider />\n      <Row>{priceWidget}</Row>\n      <Row>\n        {trades && ((amountOutMin && exact === \"in\") || (amountInMax && exact === \"out\"))\n          ? exact === \"in\"\n            ? `Output is estimated. You will receive at least ${amountOutMin.toSignificant(\n                6,\n              )} ${tokenOut} or the transaction will revert.`\n            : `Input is estimated. You will sell at most ${amountInMax.toSignificant(\n                6,\n              )} ${tokenIn} or the transaction will revert.`\n          : null}\n      </Row>\n    </Modal>\n  );\n\n  return (\n    <Card\n      title={\n        <Space>\n          <img src=\"https://ipfs.io/ipfs/QmXttGpZrECX5qCyXbBQiqgQNytVGeZW5Anewvh2jc4psg\" width=\"40\" alt=\"uniswapLogo\" />\n          <Typography>Uniswapper</Typography>\n        </Space>\n      }\n      extra={\n        <Button\n          type=\"text\"\n          onClick={() => {\n            setSettingsVisible(true);\n          }}\n        >\n          <SettingOutlined />\n        </Button>\n      }\n    >\n      <Space direction=\"vertical\">\n        <Row justify=\"center\" align=\"middle\">\n          <Card\n            size=\"small\"\n            type=\"inner\"\n            title={`From${exact === \"out\" && tokenIn && tokenOut ? \" (estimate)\" : \"\"}`}\n            extra={\n              <>\n                <img src={logoIn} alt={tokenIn} width=\"30\" />\n                <Button\n                  type=\"link\"\n                  onClick={() => {\n                    setAmountOut();\n                    setAmountIn(ethers.utils.formatUnits(balanceIn, tokens[tokenIn].decimals));\n                    setAmountOutMin();\n                    setAmountInMax();\n                    setExact(\"in\");\n                  }}\n                >\n                  {formattedBalanceIn}\n                </Button>\n              </>\n            }\n            style={{ width: 400, textAlign: \"left\" }}\n          >\n            <InputNumber\n              style={{ width: \"160px\" }}\n              min={0}\n              size=\"large\"\n              value={amountIn}\n              onChange={e => {\n                setAmountOut();\n                setTrades();\n                setAmountIn(e);\n                setExact(\"in\");\n              }}\n            />\n            <Select\n              showSearch\n              value={tokenIn}\n              style={{ width: \"120px\" }}\n              size=\"large\"\n              bordered={false}\n              defaultValue={defaultToken}\n              onChange={value => {\n                console.log(value);\n                if (value === tokenOut) {\n                  console.log(\"switch!\", tokenIn);\n                  setTokenOut(tokenIn);\n                  setAmountOut(amountIn);\n                  setBalanceOut(balanceIn);\n                }\n                setTokenIn(value);\n                setTrades();\n                setAmountIn();\n                setExact(\"out\");\n                setBalanceIn();\n              }}\n              filterOption={(input, option) => option.children.toLowerCase().indexOf(input.toLowerCase()) >= 0}\n              optionFilterProp=\"children\"\n            >\n              {tokenList.map(token => (\n                <Option key={token.symbol} value={token.symbol}>\n                  {token.symbol}\n                </Option>\n              ))}\n            </Select>\n          </Card>\n        </Row>\n        <Row justify=\"center\" align=\"middle\">\n          <Tooltip title={route.join(\"->\")}>\n            <span>↓</span>\n          </Tooltip>\n        </Row>\n        <Row justify=\"center\" align=\"middle\">\n          <Card\n            size=\"small\"\n            type=\"inner\"\n            title={`To${exact === \"in\" && tokenIn && tokenOut ? \" (estimate)\" : \"\"}`}\n            extra={\n              <>\n                <img src={logoOut} width=\"30\" alt={tokenOut} />\n                <Button type=\"text\">{formattedBalanceOut}</Button>\n              </>\n            }\n            style={{ width: 400, textAlign: \"left\" }}\n          >\n            <InputNumber\n              style={{ width: \"160px\" }}\n              size=\"large\"\n              min={0}\n              value={amountOut}\n              onChange={e => {\n                setAmountOut(e);\n                setAmountIn();\n                setTrades();\n                setExact(\"out\");\n              }}\n            />\n            <Select\n              showSearch\n              value={tokenOut}\n              style={{ width: \"120px\" }}\n              size=\"large\"\n              bordered={false}\n              onChange={value => {\n                console.log(value, tokenIn, tokenOut);\n                if (value === tokenIn) {\n                  console.log(\"switch!\", tokenOut);\n                  setTokenIn(tokenOut);\n                  setAmountIn(amountOut);\n                  setBalanceIn(balanceOut);\n                }\n                setTokenOut(value);\n                setExact(\"in\");\n                setAmountOut();\n                setTrades();\n                setBalanceOut();\n              }}\n              filterOption={(input, option) => option.children.toLowerCase().indexOf(input.toLowerCase()) >= 0}\n              optionFilterProp=\"children\"\n            >\n              {tokenList.map(token => (\n                <Option key={token.symbol} value={token.symbol}>\n                  {token.symbol}\n                </Option>\n              ))}\n            </Select>\n          </Card>\n        </Row>\n        <Row justify=\"center\" align=\"middle\">\n          {priceDescription ? priceWidget : null}\n        </Row>\n        <Row justify=\"center\" align=\"middle\">\n          <Space>\n            {inputIsToken ? (\n              <Button size=\"large\" loading={approving} disabled={!insufficientAllowance} onClick={approveRouter}>\n                {!insufficientAllowance && amountIn && amountOut ? \"Approved\" : \"Approve\"}\n              </Button>\n            ) : null}\n            <Button\n              size=\"large\"\n              loading={swapping}\n              disabled={insufficientAllowance || insufficientBalance || !amountIn || !amountOut}\n              onClick={showSwapModal}\n            >\n              {insufficientBalance ? \"Insufficient balance\" : \"Swap!\"}\n            </Button>\n            {swapModal}\n          </Space>\n        </Row>\n      </Space>\n      <Drawer\n        visible={settingsVisible}\n        onClose={() => {\n          setSettingsVisible(false);\n        }}\n        width={500}\n      >\n        <Descriptions title=\"Details\" column={1} style={{ textAlign: \"left\" }}>\n          <Descriptions.Item label=\"blockNumber\">{blockNumber}</Descriptions.Item>\n          <Descriptions.Item label=\"routerAllowance\">\n            <Space>\n              {routerAllowance ? ethers.utils.formatUnits(routerAllowance, tokens[tokenIn].decimals) : null}\n              {routerAllowance > 0 ? <Button onClick={removeRouterAllowance}>Remove Allowance</Button> : null}\n            </Space>\n          </Descriptions.Item>\n          <Descriptions.Item label=\"route\">{route.join(\"->\")}</Descriptions.Item>\n          <Descriptions.Item label=\"exact\">{exact}</Descriptions.Item>\n          <Descriptions.Item label=\"bestPrice\">\n            {trades ? (trades.length > 0 ? trades[0].executionPrice.toSignificant(6) : null) : null}\n          </Descriptions.Item>\n          <Descriptions.Item label=\"nextMidPrice\">\n            {trades ? (trades.length > 0 ? trades[0].nextMidPrice.toSignificant(6) : null) : null}\n          </Descriptions.Item>\n          <Descriptions.Item label=\"priceImpact\">\n            {trades ? (trades.length > 0 ? trades[0].priceImpact.toSignificant(6) : null) : null}\n          </Descriptions.Item>\n          <Descriptions.Item label=\"slippageTolerance\">\n            <InputNumber\n              defaultValue={defaultSlippage}\n              min={0}\n              max={100}\n              precision={2}\n              formatter={value => `${value}%`}\n              parser={value => value.replace(\"%\", \"\")}\n              onChange={value => {\n                console.log(value);\n\n                const slippagePercent = new Percent(Math.round(value * 100).toString(), \"10000\");\n                setSlippageTolerance(slippagePercent);\n              }}\n            />\n          </Descriptions.Item>\n          <Descriptions.Item label=\"amountInMax\">{amountInMax ? amountInMax.toExact() : null}</Descriptions.Item>\n          <Descriptions.Item label=\"amountOutMin\">{amountOutMin ? amountOutMin.toExact() : null}</Descriptions.Item>\n          <Descriptions.Item label=\"timeLimitInSeconds\">\n            <InputNumber\n              min={0}\n              max={3600}\n              defaultValue={defaultTimeLimit}\n              onChange={value => {\n                console.log(value);\n                setTimeLimit(value);\n              }}\n            />\n          </Descriptions.Item>\n        </Descriptions>\n      </Drawer>\n    </Card>\n  );\n}\n\nexport default Swap;\n"]},"metadata":{},"sourceType":"module"}