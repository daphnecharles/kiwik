{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar codemirror_1 = __importDefault(require(\"codemirror\"));\n\ncodemirror_1.default.defineOption('jump', false, function (cm, options, old) {\n  if (old && old !== codemirror_1.default.Init) {\n    var oldOnMouseOver = cm.state.jump.onMouseOver;\n    codemirror_1.default.off(cm.getWrapperElement(), 'mouseover', oldOnMouseOver);\n    var oldOnMouseOut = cm.state.jump.onMouseOut;\n    codemirror_1.default.off(cm.getWrapperElement(), 'mouseout', oldOnMouseOut);\n    codemirror_1.default.off(document, 'keydown', cm.state.jump.onKeyDown);\n    delete cm.state.jump;\n  }\n\n  if (options) {\n    var state = cm.state.jump = {\n      options: options,\n      onMouseOver: onMouseOver.bind(null, cm),\n      onMouseOut: onMouseOut.bind(null, cm),\n      onKeyDown: onKeyDown.bind(null, cm)\n    };\n    codemirror_1.default.on(cm.getWrapperElement(), 'mouseover', state.onMouseOver);\n    codemirror_1.default.on(cm.getWrapperElement(), 'mouseout', state.onMouseOut);\n    codemirror_1.default.on(document, 'keydown', state.onKeyDown);\n  }\n});\n\nfunction onMouseOver(cm, event) {\n  var target = event.target || event.srcElement;\n\n  if (!(target instanceof HTMLElement)) {\n    return;\n  }\n\n  if ((target === null || target === void 0 ? void 0 : target.nodeName) !== 'SPAN') {\n    return;\n  }\n\n  var box = target.getBoundingClientRect();\n  var cursor = {\n    left: (box.left + box.right) / 2,\n    top: (box.top + box.bottom) / 2\n  };\n  cm.state.jump.cursor = cursor;\n\n  if (cm.state.jump.isHoldingModifier) {\n    enableJumpMode(cm);\n  }\n}\n\nfunction onMouseOut(cm) {\n  if (!cm.state.jump.isHoldingModifier && cm.state.jump.cursor) {\n    cm.state.jump.cursor = null;\n    return;\n  }\n\n  if (cm.state.jump.isHoldingModifier && cm.state.jump.marker) {\n    disableJumpMode(cm);\n  }\n}\n\nfunction onKeyDown(cm, event) {\n  if (cm.state.jump.isHoldingModifier || !isJumpModifier(event.key)) {\n    return;\n  }\n\n  cm.state.jump.isHoldingModifier = true;\n\n  if (cm.state.jump.cursor) {\n    enableJumpMode(cm);\n  }\n\n  var onKeyUp = function onKeyUp(upEvent) {\n    if (upEvent.code !== event.code) {\n      return;\n    }\n\n    cm.state.jump.isHoldingModifier = false;\n\n    if (cm.state.jump.marker) {\n      disableJumpMode(cm);\n    }\n\n    codemirror_1.default.off(document, 'keyup', onKeyUp);\n    codemirror_1.default.off(document, 'click', onClick);\n    cm.off('mousedown', onMouseDown);\n  };\n\n  var onClick = function onClick(clickEvent) {\n    var destination = cm.state.jump.destination;\n\n    if (destination) {\n      cm.state.jump.options.onClick(destination, clickEvent);\n    }\n  };\n\n  var onMouseDown = function onMouseDown(_, downEvent) {\n    if (cm.state.jump.destination) {\n      downEvent.codemirrorIgnore = true;\n    }\n  };\n\n  codemirror_1.default.on(document, 'keyup', onKeyUp);\n  codemirror_1.default.on(document, 'click', onClick);\n  cm.on('mousedown', onMouseDown);\n}\n\nvar isMac = typeof navigator !== 'undefined' && navigator && navigator.appVersion.indexOf('Mac') !== -1;\n\nfunction isJumpModifier(key) {\n  return key === (isMac ? 'Meta' : 'Control');\n}\n\nfunction enableJumpMode(cm) {\n  if (cm.state.jump.marker) {\n    return;\n  }\n\n  var cursor = cm.state.jump.cursor;\n  var pos = cm.coordsChar(cursor);\n  var token = cm.getTokenAt(pos, true);\n  var options = cm.state.jump.options;\n  var getDestination = options.getDestination || cm.getHelper(pos, 'jump');\n\n  if (getDestination) {\n    var destination = getDestination(token, options, cm);\n\n    if (destination) {\n      var marker = cm.markText({\n        line: pos.line,\n        ch: token.start\n      }, {\n        line: pos.line,\n        ch: token.end\n      }, {\n        className: 'CodeMirror-jump-token'\n      });\n      cm.state.jump.marker = marker;\n      cm.state.jump.destination = destination;\n    }\n  }\n}\n\nfunction disableJumpMode(cm) {\n  var marker = cm.state.jump.marker;\n  cm.state.jump.marker = null;\n  cm.state.jump.destination = null;\n  marker.clear();\n}","map":{"version":3,"sources":["../src/utils/jump-addon.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar codemirror_1 = __importDefault(require(\"codemirror\"));\ncodemirror_1.default.defineOption('jump', false, function (cm, options, old) {\n    if (old && old !== codemirror_1.default.Init) {\n        var oldOnMouseOver = cm.state.jump.onMouseOver;\n        codemirror_1.default.off(cm.getWrapperElement(), 'mouseover', oldOnMouseOver);\n        var oldOnMouseOut = cm.state.jump.onMouseOut;\n        codemirror_1.default.off(cm.getWrapperElement(), 'mouseout', oldOnMouseOut);\n        codemirror_1.default.off(document, 'keydown', cm.state.jump.onKeyDown);\n        delete cm.state.jump;\n    }\n    if (options) {\n        var state = (cm.state.jump = {\n            options: options,\n            onMouseOver: onMouseOver.bind(null, cm),\n            onMouseOut: onMouseOut.bind(null, cm),\n            onKeyDown: onKeyDown.bind(null, cm),\n        });\n        codemirror_1.default.on(cm.getWrapperElement(), 'mouseover', state.onMouseOver);\n        codemirror_1.default.on(cm.getWrapperElement(), 'mouseout', state.onMouseOut);\n        codemirror_1.default.on(document, 'keydown', state.onKeyDown);\n    }\n});\nfunction onMouseOver(cm, event) {\n    var target = event.target || event.srcElement;\n    if (!(target instanceof HTMLElement)) {\n        return;\n    }\n    if ((target === null || target === void 0 ? void 0 : target.nodeName) !== 'SPAN') {\n        return;\n    }\n    var box = target.getBoundingClientRect();\n    var cursor = {\n        left: (box.left + box.right) / 2,\n        top: (box.top + box.bottom) / 2,\n    };\n    cm.state.jump.cursor = cursor;\n    if (cm.state.jump.isHoldingModifier) {\n        enableJumpMode(cm);\n    }\n}\nfunction onMouseOut(cm) {\n    if (!cm.state.jump.isHoldingModifier && cm.state.jump.cursor) {\n        cm.state.jump.cursor = null;\n        return;\n    }\n    if (cm.state.jump.isHoldingModifier && cm.state.jump.marker) {\n        disableJumpMode(cm);\n    }\n}\nfunction onKeyDown(cm, event) {\n    if (cm.state.jump.isHoldingModifier || !isJumpModifier(event.key)) {\n        return;\n    }\n    cm.state.jump.isHoldingModifier = true;\n    if (cm.state.jump.cursor) {\n        enableJumpMode(cm);\n    }\n    var onKeyUp = function (upEvent) {\n        if (upEvent.code !== event.code) {\n            return;\n        }\n        cm.state.jump.isHoldingModifier = false;\n        if (cm.state.jump.marker) {\n            disableJumpMode(cm);\n        }\n        codemirror_1.default.off(document, 'keyup', onKeyUp);\n        codemirror_1.default.off(document, 'click', onClick);\n        cm.off('mousedown', onMouseDown);\n    };\n    var onClick = function (clickEvent) {\n        var destination = cm.state.jump.destination;\n        if (destination) {\n            cm.state.jump.options.onClick(destination, clickEvent);\n        }\n    };\n    var onMouseDown = function (_, downEvent) {\n        if (cm.state.jump.destination) {\n            downEvent.codemirrorIgnore = true;\n        }\n    };\n    codemirror_1.default.on(document, 'keyup', onKeyUp);\n    codemirror_1.default.on(document, 'click', onClick);\n    cm.on('mousedown', onMouseDown);\n}\nvar isMac = typeof navigator !== 'undefined' &&\n    navigator &&\n    navigator.appVersion.indexOf('Mac') !== -1;\nfunction isJumpModifier(key) {\n    return key === (isMac ? 'Meta' : 'Control');\n}\nfunction enableJumpMode(cm) {\n    if (cm.state.jump.marker) {\n        return;\n    }\n    var cursor = cm.state.jump.cursor;\n    var pos = cm.coordsChar(cursor);\n    var token = cm.getTokenAt(pos, true);\n    var options = cm.state.jump.options;\n    var getDestination = options.getDestination || cm.getHelper(pos, 'jump');\n    if (getDestination) {\n        var destination = getDestination(token, options, cm);\n        if (destination) {\n            var marker = cm.markText({ line: pos.line, ch: token.start }, { line: pos.line, ch: token.end }, { className: 'CodeMirror-jump-token' });\n            cm.state.jump.marker = marker;\n            cm.state.jump.destination = destination;\n        }\n    }\n}\nfunction disableJumpMode(cm) {\n    var marker = cm.state.jump.marker;\n    cm.state.jump.marker = null;\n    cm.state.jump.destination = null;\n    marker.clear();\n}\n//# sourceMappingURL=jump-addon.js.map"]},"metadata":{},"sourceType":"script"}