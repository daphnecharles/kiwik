{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport React from 'react';\nimport MD from 'markdown-it';\nimport { normalizeWhitespace } from '../utility/normalizeWhitespace';\nimport onHasCompletion from '../utility/onHasCompletion';\nimport commonKeys from '../utility/commonKeys';\nvar md = new MD();\nvar AUTO_COMPLETE_AFTER_KEY = /^[a-zA-Z0-9_@(]$/;\n\nvar QueryEditor = function (_super) {\n  __extends(QueryEditor, _super);\n\n  function QueryEditor(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.editor = null;\n    _this.ignoreChangeEvent = false;\n    _this._node = null;\n\n    _this._onKeyUp = function (_cm, event) {\n      if (AUTO_COMPLETE_AFTER_KEY.test(event.key) && _this.editor) {\n        _this.editor.execCommand('autocomplete');\n      }\n    };\n\n    _this._onEdit = function () {\n      if (!_this.ignoreChangeEvent && _this.editor) {\n        _this.cachedValue = _this.editor.getValue();\n\n        if (_this.props.onEdit) {\n          _this.props.onEdit(_this.cachedValue);\n        }\n      }\n    };\n\n    _this._onHasCompletion = function (cm, data) {\n      onHasCompletion(cm, data, _this.props.onHintInformationRender);\n    };\n\n    _this.cachedValue = props.value || '';\n    return _this;\n  }\n\n  QueryEditor.prototype.componentDidMount = function () {\n    var _this = this;\n\n    var _a, _b, _c;\n\n    var CodeMirror = require('codemirror');\n\n    require('codemirror/addon/hint/show-hint');\n\n    require('codemirror/addon/comment/comment');\n\n    require('codemirror/addon/edit/matchbrackets');\n\n    require('codemirror/addon/edit/closebrackets');\n\n    require('codemirror/addon/fold/foldgutter');\n\n    require('codemirror/addon/fold/brace-fold');\n\n    require('codemirror/addon/search/search');\n\n    require('codemirror/addon/search/searchcursor');\n\n    require('codemirror/addon/search/jump-to-line');\n\n    require('codemirror/addon/dialog/dialog');\n\n    require('codemirror/addon/lint/lint');\n\n    require('codemirror/keymap/sublime');\n\n    require('codemirror-graphql/hint');\n\n    require('codemirror-graphql/lint');\n\n    require('codemirror-graphql/info');\n\n    require('codemirror-graphql/jump');\n\n    require('codemirror-graphql/mode');\n\n    var editor = this.editor = CodeMirror(this._node, {\n      value: this.props.value || '',\n      lineNumbers: true,\n      tabSize: 2,\n      mode: 'graphql',\n      theme: this.props.editorTheme || 'graphiql',\n      keyMap: 'sublime',\n      autoCloseBrackets: true,\n      matchBrackets: true,\n      showCursorWhenSelecting: true,\n      readOnly: this.props.readOnly ? 'nocursor' : false,\n      foldGutter: {\n        minFoldSize: 4\n      },\n      lint: {\n        schema: this.props.schema,\n        validationRules: (_a = this.props.validationRules) !== null && _a !== void 0 ? _a : null,\n        externalFragments: (_b = this.props) === null || _b === void 0 ? void 0 : _b.externalFragments\n      },\n      hintOptions: {\n        schema: this.props.schema,\n        closeOnUnfocus: false,\n        completeSingle: false,\n        container: this._node,\n        externalFragments: (_c = this.props) === null || _c === void 0 ? void 0 : _c.externalFragments\n      },\n      info: {\n        schema: this.props.schema,\n        renderDescription: function renderDescription(text) {\n          return md.render(text);\n        },\n        onClick: function onClick(reference) {\n          return _this.props.onClickReference && _this.props.onClickReference(reference);\n        }\n      },\n      jump: {\n        schema: this.props.schema,\n        onClick: function onClick(reference) {\n          return _this.props.onClickReference && _this.props.onClickReference(reference);\n        }\n      },\n      gutters: ['CodeMirror-linenumbers', 'CodeMirror-foldgutter'],\n      extraKeys: __assign(__assign({\n        'Cmd-Space': function CmdSpace() {\n          return editor.showHint({\n            completeSingle: true,\n            container: _this._node\n          });\n        },\n        'Ctrl-Space': function CtrlSpace() {\n          return editor.showHint({\n            completeSingle: true,\n            container: _this._node\n          });\n        },\n        'Alt-Space': function AltSpace() {\n          return editor.showHint({\n            completeSingle: true,\n            container: _this._node\n          });\n        },\n        'Shift-Space': function ShiftSpace() {\n          return editor.showHint({\n            completeSingle: true,\n            container: _this._node\n          });\n        },\n        'Shift-Alt-Space': function ShiftAltSpace() {\n          return editor.showHint({\n            completeSingle: true,\n            container: _this._node\n          });\n        },\n        'Cmd-Enter': function CmdEnter() {\n          if (_this.props.onRunQuery) {\n            _this.props.onRunQuery();\n          }\n        },\n        'Ctrl-Enter': function CtrlEnter() {\n          if (_this.props.onRunQuery) {\n            _this.props.onRunQuery();\n          }\n        },\n        'Shift-Ctrl-C': function ShiftCtrlC() {\n          if (_this.props.onCopyQuery) {\n            _this.props.onCopyQuery();\n          }\n        },\n        'Shift-Ctrl-P': function ShiftCtrlP() {\n          if (_this.props.onPrettifyQuery) {\n            _this.props.onPrettifyQuery();\n          }\n        },\n        'Shift-Ctrl-F': function ShiftCtrlF() {\n          if (_this.props.onPrettifyQuery) {\n            _this.props.onPrettifyQuery();\n          }\n        },\n        'Shift-Ctrl-M': function ShiftCtrlM() {\n          if (_this.props.onMergeQuery) {\n            _this.props.onMergeQuery();\n          }\n        }\n      }, commonKeys), {\n        'Cmd-S': function CmdS() {\n          if (_this.props.onRunQuery) {}\n        },\n        'Ctrl-S': function CtrlS() {\n          if (_this.props.onRunQuery) {}\n        }\n      })\n    });\n\n    if (editor) {\n      editor.on('change', this._onEdit);\n      editor.on('keyup', this._onKeyUp);\n      editor.on('hasCompletion', this._onHasCompletion);\n      editor.on('beforeChange', this._onBeforeChange);\n    }\n  };\n\n  QueryEditor.prototype.componentDidUpdate = function (prevProps) {\n    var CodeMirror = require('codemirror');\n\n    this.ignoreChangeEvent = true;\n\n    if (this.props.schema !== prevProps.schema && this.editor) {\n      this.editor.options.lint.schema = this.props.schema;\n      this.editor.options.hintOptions.schema = this.props.schema;\n      this.editor.options.info.schema = this.props.schema;\n      this.editor.options.jump.schema = this.props.schema;\n      CodeMirror.signal(this.editor, 'change', this.editor);\n    }\n\n    if (this.props.value !== prevProps.value && this.props.value !== this.cachedValue && this.editor) {\n      this.cachedValue = this.props.value;\n      this.editor.setValue(this.props.value);\n    }\n\n    this.ignoreChangeEvent = false;\n  };\n\n  QueryEditor.prototype.componentWillUnmount = function () {\n    if (this.editor) {\n      this.editor.off('change', this._onEdit);\n      this.editor.off('keyup', this._onKeyUp);\n      this.editor.off('hasCompletion', this._onHasCompletion);\n      this.editor = null;\n    }\n  };\n\n  QueryEditor.prototype.render = function () {\n    var _this = this;\n\n    return React.createElement(\"section\", {\n      className: \"query-editor\",\n      \"aria-label\": \"Query Editor\",\n      ref: function ref(node) {\n        _this._node = node;\n      }\n    });\n  };\n\n  QueryEditor.prototype.getCodeMirror = function () {\n    return this.editor;\n  };\n\n  QueryEditor.prototype.getClientHeight = function () {\n    return this._node && this._node.clientHeight;\n  };\n\n  QueryEditor.prototype._onBeforeChange = function (_instance, change) {\n    if (change.origin === 'paste') {\n      var text = change.text.map(normalizeWhitespace);\n      change.update(change.from, change.to, text);\n    }\n  };\n\n  return QueryEditor;\n}(React.Component);\n\nexport { QueryEditor };","map":{"version":3,"sources":["../../src/components/QueryEditor.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport React from 'react';\nimport MD from 'markdown-it';\nimport { normalizeWhitespace } from '../utility/normalizeWhitespace';\nimport onHasCompletion from '../utility/onHasCompletion';\nimport commonKeys from '../utility/commonKeys';\nvar md = new MD();\nvar AUTO_COMPLETE_AFTER_KEY = /^[a-zA-Z0-9_@(]$/;\nvar QueryEditor = (function (_super) {\n    __extends(QueryEditor, _super);\n    function QueryEditor(props) {\n        var _this = _super.call(this, props) || this;\n        _this.editor = null;\n        _this.ignoreChangeEvent = false;\n        _this._node = null;\n        _this._onKeyUp = function (_cm, event) {\n            if (AUTO_COMPLETE_AFTER_KEY.test(event.key) && _this.editor) {\n                _this.editor.execCommand('autocomplete');\n            }\n        };\n        _this._onEdit = function () {\n            if (!_this.ignoreChangeEvent && _this.editor) {\n                _this.cachedValue = _this.editor.getValue();\n                if (_this.props.onEdit) {\n                    _this.props.onEdit(_this.cachedValue);\n                }\n            }\n        };\n        _this._onHasCompletion = function (cm, data) {\n            onHasCompletion(cm, data, _this.props.onHintInformationRender);\n        };\n        _this.cachedValue = props.value || '';\n        return _this;\n    }\n    QueryEditor.prototype.componentDidMount = function () {\n        var _this = this;\n        var _a, _b, _c;\n        var CodeMirror = require('codemirror');\n        require('codemirror/addon/hint/show-hint');\n        require('codemirror/addon/comment/comment');\n        require('codemirror/addon/edit/matchbrackets');\n        require('codemirror/addon/edit/closebrackets');\n        require('codemirror/addon/fold/foldgutter');\n        require('codemirror/addon/fold/brace-fold');\n        require('codemirror/addon/search/search');\n        require('codemirror/addon/search/searchcursor');\n        require('codemirror/addon/search/jump-to-line');\n        require('codemirror/addon/dialog/dialog');\n        require('codemirror/addon/lint/lint');\n        require('codemirror/keymap/sublime');\n        require('codemirror-graphql/hint');\n        require('codemirror-graphql/lint');\n        require('codemirror-graphql/info');\n        require('codemirror-graphql/jump');\n        require('codemirror-graphql/mode');\n        var editor = (this.editor = CodeMirror(this._node, {\n            value: this.props.value || '',\n            lineNumbers: true,\n            tabSize: 2,\n            mode: 'graphql',\n            theme: this.props.editorTheme || 'graphiql',\n            keyMap: 'sublime',\n            autoCloseBrackets: true,\n            matchBrackets: true,\n            showCursorWhenSelecting: true,\n            readOnly: this.props.readOnly ? 'nocursor' : false,\n            foldGutter: {\n                minFoldSize: 4,\n            },\n            lint: {\n                schema: this.props.schema,\n                validationRules: (_a = this.props.validationRules) !== null && _a !== void 0 ? _a : null,\n                externalFragments: (_b = this.props) === null || _b === void 0 ? void 0 : _b.externalFragments,\n            },\n            hintOptions: {\n                schema: this.props.schema,\n                closeOnUnfocus: false,\n                completeSingle: false,\n                container: this._node,\n                externalFragments: (_c = this.props) === null || _c === void 0 ? void 0 : _c.externalFragments,\n            },\n            info: {\n                schema: this.props.schema,\n                renderDescription: function (text) { return md.render(text); },\n                onClick: function (reference) {\n                    return _this.props.onClickReference && _this.props.onClickReference(reference);\n                },\n            },\n            jump: {\n                schema: this.props.schema,\n                onClick: function (reference) {\n                    return _this.props.onClickReference && _this.props.onClickReference(reference);\n                },\n            },\n            gutters: ['CodeMirror-linenumbers', 'CodeMirror-foldgutter'],\n            extraKeys: __assign(__assign({ 'Cmd-Space': function () {\n                    return editor.showHint({ completeSingle: true, container: _this._node });\n                }, 'Ctrl-Space': function () {\n                    return editor.showHint({ completeSingle: true, container: _this._node });\n                }, 'Alt-Space': function () {\n                    return editor.showHint({ completeSingle: true, container: _this._node });\n                }, 'Shift-Space': function () {\n                    return editor.showHint({ completeSingle: true, container: _this._node });\n                }, 'Shift-Alt-Space': function () {\n                    return editor.showHint({ completeSingle: true, container: _this._node });\n                }, 'Cmd-Enter': function () {\n                    if (_this.props.onRunQuery) {\n                        _this.props.onRunQuery();\n                    }\n                }, 'Ctrl-Enter': function () {\n                    if (_this.props.onRunQuery) {\n                        _this.props.onRunQuery();\n                    }\n                }, 'Shift-Ctrl-C': function () {\n                    if (_this.props.onCopyQuery) {\n                        _this.props.onCopyQuery();\n                    }\n                }, 'Shift-Ctrl-P': function () {\n                    if (_this.props.onPrettifyQuery) {\n                        _this.props.onPrettifyQuery();\n                    }\n                }, 'Shift-Ctrl-F': function () {\n                    if (_this.props.onPrettifyQuery) {\n                        _this.props.onPrettifyQuery();\n                    }\n                }, 'Shift-Ctrl-M': function () {\n                    if (_this.props.onMergeQuery) {\n                        _this.props.onMergeQuery();\n                    }\n                } }, commonKeys), { 'Cmd-S': function () {\n                    if (_this.props.onRunQuery) {\n                    }\n                }, 'Ctrl-S': function () {\n                    if (_this.props.onRunQuery) {\n                    }\n                } }),\n        }));\n        if (editor) {\n            editor.on('change', this._onEdit);\n            editor.on('keyup', this._onKeyUp);\n            editor.on('hasCompletion', this._onHasCompletion);\n            editor.on('beforeChange', this._onBeforeChange);\n        }\n    };\n    QueryEditor.prototype.componentDidUpdate = function (prevProps) {\n        var CodeMirror = require('codemirror');\n        this.ignoreChangeEvent = true;\n        if (this.props.schema !== prevProps.schema && this.editor) {\n            this.editor.options.lint.schema = this.props.schema;\n            this.editor.options.hintOptions.schema = this.props.schema;\n            this.editor.options.info.schema = this.props.schema;\n            this.editor.options.jump.schema = this.props.schema;\n            CodeMirror.signal(this.editor, 'change', this.editor);\n        }\n        if (this.props.value !== prevProps.value &&\n            this.props.value !== this.cachedValue &&\n            this.editor) {\n            this.cachedValue = this.props.value;\n            this.editor.setValue(this.props.value);\n        }\n        this.ignoreChangeEvent = false;\n    };\n    QueryEditor.prototype.componentWillUnmount = function () {\n        if (this.editor) {\n            this.editor.off('change', this._onEdit);\n            this.editor.off('keyup', this._onKeyUp);\n            this.editor.off('hasCompletion', this._onHasCompletion);\n            this.editor = null;\n        }\n    };\n    QueryEditor.prototype.render = function () {\n        var _this = this;\n        return (React.createElement(\"section\", { className: \"query-editor\", \"aria-label\": \"Query Editor\", ref: function (node) {\n                _this._node = node;\n            } }));\n    };\n    QueryEditor.prototype.getCodeMirror = function () {\n        return this.editor;\n    };\n    QueryEditor.prototype.getClientHeight = function () {\n        return this._node && this._node.clientHeight;\n    };\n    QueryEditor.prototype._onBeforeChange = function (_instance, change) {\n        if (change.origin === 'paste') {\n            var text = change.text.map(normalizeWhitespace);\n            change.update(change.from, change.to, text);\n        }\n    };\n    return QueryEditor;\n}(React.Component));\nexport { QueryEditor };\n//# sourceMappingURL=QueryEditor.js.map"]},"metadata":{},"sourceType":"module"}