{"ast":null,"code":"// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n(function (mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);else // Plain browser env\n    mod(CodeMirror);\n})(function (CodeMirror) {\n  var defaults = {\n    pairs: \"()[]{}''\\\"\\\"\",\n    closeBefore: \")]}'\\\":;>\",\n    triples: \"\",\n    explode: \"[]{}\"\n  };\n  var Pos = CodeMirror.Pos;\n  CodeMirror.defineOption(\"autoCloseBrackets\", false, function (cm, val, old) {\n    if (old && old != CodeMirror.Init) {\n      cm.removeKeyMap(keyMap);\n      cm.state.closeBrackets = null;\n    }\n\n    if (val) {\n      ensureBound(getOption(val, \"pairs\"));\n      cm.state.closeBrackets = val;\n      cm.addKeyMap(keyMap);\n    }\n  });\n\n  function getOption(conf, name) {\n    if (name == \"pairs\" && typeof conf == \"string\") return conf;\n    if (typeof conf == \"object\" && conf[name] != null) return conf[name];\n    return defaults[name];\n  }\n\n  var keyMap = {\n    Backspace: handleBackspace,\n    Enter: handleEnter\n  };\n\n  function ensureBound(chars) {\n    for (var i = 0; i < chars.length; i++) {\n      var ch = chars.charAt(i),\n          key = \"'\" + ch + \"'\";\n      if (!keyMap[key]) keyMap[key] = handler(ch);\n    }\n  }\n\n  ensureBound(defaults.pairs + \"`\");\n\n  function handler(ch) {\n    return function (cm) {\n      return handleChar(cm, ch);\n    };\n  }\n\n  function getConfig(cm) {\n    var deflt = cm.state.closeBrackets;\n    if (!deflt || deflt.override) return deflt;\n    var mode = cm.getModeAt(cm.getCursor());\n    return mode.closeBrackets || deflt;\n  }\n\n  function handleBackspace(cm) {\n    var conf = getConfig(cm);\n    if (!conf || cm.getOption(\"disableInput\")) return CodeMirror.Pass;\n    var pairs = getOption(conf, \"pairs\");\n    var ranges = cm.listSelections();\n\n    for (var i = 0; i < ranges.length; i++) {\n      if (!ranges[i].empty()) return CodeMirror.Pass;\n      var around = charsAround(cm, ranges[i].head);\n      if (!around || pairs.indexOf(around) % 2 != 0) return CodeMirror.Pass;\n    }\n\n    for (var i = ranges.length - 1; i >= 0; i--) {\n      var cur = ranges[i].head;\n      cm.replaceRange(\"\", Pos(cur.line, cur.ch - 1), Pos(cur.line, cur.ch + 1), \"+delete\");\n    }\n  }\n\n  function handleEnter(cm) {\n    var conf = getConfig(cm);\n    var explode = conf && getOption(conf, \"explode\");\n    if (!explode || cm.getOption(\"disableInput\")) return CodeMirror.Pass;\n    var ranges = cm.listSelections();\n\n    for (var i = 0; i < ranges.length; i++) {\n      if (!ranges[i].empty()) return CodeMirror.Pass;\n      var around = charsAround(cm, ranges[i].head);\n      if (!around || explode.indexOf(around) % 2 != 0) return CodeMirror.Pass;\n    }\n\n    cm.operation(function () {\n      var linesep = cm.lineSeparator() || \"\\n\";\n      cm.replaceSelection(linesep + linesep, null);\n      moveSel(cm, -1);\n      ranges = cm.listSelections();\n\n      for (var i = 0; i < ranges.length; i++) {\n        var line = ranges[i].head.line;\n        cm.indentLine(line, null, true);\n        cm.indentLine(line + 1, null, true);\n      }\n    });\n  }\n\n  function moveSel(cm, dir) {\n    var newRanges = [],\n        ranges = cm.listSelections(),\n        primary = 0;\n\n    for (var i = 0; i < ranges.length; i++) {\n      var range = ranges[i];\n      if (range.head == cm.getCursor()) primary = i;\n      var pos = range.head.ch || dir > 0 ? {\n        line: range.head.line,\n        ch: range.head.ch + dir\n      } : {\n        line: range.head.line - 1\n      };\n      newRanges.push({\n        anchor: pos,\n        head: pos\n      });\n    }\n\n    cm.setSelections(newRanges, primary);\n  }\n\n  function contractSelection(sel) {\n    var inverted = CodeMirror.cmpPos(sel.anchor, sel.head) > 0;\n    return {\n      anchor: new Pos(sel.anchor.line, sel.anchor.ch + (inverted ? -1 : 1)),\n      head: new Pos(sel.head.line, sel.head.ch + (inverted ? 1 : -1))\n    };\n  }\n\n  function handleChar(cm, ch) {\n    var conf = getConfig(cm);\n    if (!conf || cm.getOption(\"disableInput\")) return CodeMirror.Pass;\n    var pairs = getOption(conf, \"pairs\");\n    var pos = pairs.indexOf(ch);\n    if (pos == -1) return CodeMirror.Pass;\n    var closeBefore = getOption(conf, \"closeBefore\");\n    var triples = getOption(conf, \"triples\");\n    var identical = pairs.charAt(pos + 1) == ch;\n    var ranges = cm.listSelections();\n    var opening = pos % 2 == 0;\n    var type;\n\n    for (var i = 0; i < ranges.length; i++) {\n      var range = ranges[i],\n          cur = range.head,\n          curType;\n      var next = cm.getRange(cur, Pos(cur.line, cur.ch + 1));\n\n      if (opening && !range.empty()) {\n        curType = \"surround\";\n      } else if ((identical || !opening) && next == ch) {\n        if (identical && stringStartsAfter(cm, cur)) curType = \"both\";else if (triples.indexOf(ch) >= 0 && cm.getRange(cur, Pos(cur.line, cur.ch + 3)) == ch + ch + ch) curType = \"skipThree\";else curType = \"skip\";\n      } else if (identical && cur.ch > 1 && triples.indexOf(ch) >= 0 && cm.getRange(Pos(cur.line, cur.ch - 2), cur) == ch + ch) {\n        if (cur.ch > 2 && /\\bstring/.test(cm.getTokenTypeAt(Pos(cur.line, cur.ch - 2)))) return CodeMirror.Pass;\n        curType = \"addFour\";\n      } else if (identical) {\n        var prev = cur.ch == 0 ? \" \" : cm.getRange(Pos(cur.line, cur.ch - 1), cur);\n        if (!CodeMirror.isWordChar(next) && prev != ch && !CodeMirror.isWordChar(prev)) curType = \"both\";else return CodeMirror.Pass;\n      } else if (opening && (next.length === 0 || /\\s/.test(next) || closeBefore.indexOf(next) > -1)) {\n        curType = \"both\";\n      } else {\n        return CodeMirror.Pass;\n      }\n\n      if (!type) type = curType;else if (type != curType) return CodeMirror.Pass;\n    }\n\n    var left = pos % 2 ? pairs.charAt(pos - 1) : ch;\n    var right = pos % 2 ? ch : pairs.charAt(pos + 1);\n    cm.operation(function () {\n      if (type == \"skip\") {\n        moveSel(cm, 1);\n      } else if (type == \"skipThree\") {\n        moveSel(cm, 3);\n      } else if (type == \"surround\") {\n        var sels = cm.getSelections();\n\n        for (var i = 0; i < sels.length; i++) {\n          sels[i] = left + sels[i] + right;\n        }\n\n        cm.replaceSelections(sels, \"around\");\n        sels = cm.listSelections().slice();\n\n        for (var i = 0; i < sels.length; i++) {\n          sels[i] = contractSelection(sels[i]);\n        }\n\n        cm.setSelections(sels);\n      } else if (type == \"both\") {\n        cm.replaceSelection(left + right, null);\n        cm.triggerElectric(left + right);\n        moveSel(cm, -1);\n      } else if (type == \"addFour\") {\n        cm.replaceSelection(left + left + left + left, \"before\");\n        moveSel(cm, 1);\n      }\n    });\n  }\n\n  function charsAround(cm, pos) {\n    var str = cm.getRange(Pos(pos.line, pos.ch - 1), Pos(pos.line, pos.ch + 1));\n    return str.length == 2 ? str : null;\n  }\n\n  function stringStartsAfter(cm, pos) {\n    var token = cm.getTokenAt(Pos(pos.line, pos.ch + 1));\n    return /\\bstring/.test(token.type) && token.start == pos.ch && (pos.ch == 0 || !/\\bstring/.test(cm.getTokenTypeAt(pos)));\n  }\n});","map":{"version":3,"sources":["/Users/sam/Desktop/kiwik/node_modules/codemirror/addon/edit/closebrackets.js"],"names":["mod","exports","module","require","define","amd","CodeMirror","defaults","pairs","closeBefore","triples","explode","Pos","defineOption","cm","val","old","Init","removeKeyMap","keyMap","state","closeBrackets","ensureBound","getOption","addKeyMap","conf","name","Backspace","handleBackspace","Enter","handleEnter","chars","i","length","ch","charAt","key","handler","handleChar","getConfig","deflt","override","mode","getModeAt","getCursor","Pass","ranges","listSelections","empty","around","charsAround","head","indexOf","cur","replaceRange","line","operation","linesep","lineSeparator","replaceSelection","moveSel","indentLine","dir","newRanges","primary","range","pos","push","anchor","setSelections","contractSelection","sel","inverted","cmpPos","identical","opening","type","curType","next","getRange","stringStartsAfter","test","getTokenTypeAt","prev","isWordChar","left","right","sels","getSelections","replaceSelections","slice","triggerElectric","str","token","getTokenAt","start"],"mappings":"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","sourcesContent":["// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  var defaults = {\n    pairs: \"()[]{}''\\\"\\\"\",\n    closeBefore: \")]}'\\\":;>\",\n    triples: \"\",\n    explode: \"[]{}\"\n  };\n\n  var Pos = CodeMirror.Pos;\n\n  CodeMirror.defineOption(\"autoCloseBrackets\", false, function(cm, val, old) {\n    if (old && old != CodeMirror.Init) {\n      cm.removeKeyMap(keyMap);\n      cm.state.closeBrackets = null;\n    }\n    if (val) {\n      ensureBound(getOption(val, \"pairs\"))\n      cm.state.closeBrackets = val;\n      cm.addKeyMap(keyMap);\n    }\n  });\n\n  function getOption(conf, name) {\n    if (name == \"pairs\" && typeof conf == \"string\") return conf;\n    if (typeof conf == \"object\" && conf[name] != null) return conf[name];\n    return defaults[name];\n  }\n\n  var keyMap = {Backspace: handleBackspace, Enter: handleEnter};\n  function ensureBound(chars) {\n    for (var i = 0; i < chars.length; i++) {\n      var ch = chars.charAt(i), key = \"'\" + ch + \"'\"\n      if (!keyMap[key]) keyMap[key] = handler(ch)\n    }\n  }\n  ensureBound(defaults.pairs + \"`\")\n\n  function handler(ch) {\n    return function(cm) { return handleChar(cm, ch); };\n  }\n\n  function getConfig(cm) {\n    var deflt = cm.state.closeBrackets;\n    if (!deflt || deflt.override) return deflt;\n    var mode = cm.getModeAt(cm.getCursor());\n    return mode.closeBrackets || deflt;\n  }\n\n  function handleBackspace(cm) {\n    var conf = getConfig(cm);\n    if (!conf || cm.getOption(\"disableInput\")) return CodeMirror.Pass;\n\n    var pairs = getOption(conf, \"pairs\");\n    var ranges = cm.listSelections();\n    for (var i = 0; i < ranges.length; i++) {\n      if (!ranges[i].empty()) return CodeMirror.Pass;\n      var around = charsAround(cm, ranges[i].head);\n      if (!around || pairs.indexOf(around) % 2 != 0) return CodeMirror.Pass;\n    }\n    for (var i = ranges.length - 1; i >= 0; i--) {\n      var cur = ranges[i].head;\n      cm.replaceRange(\"\", Pos(cur.line, cur.ch - 1), Pos(cur.line, cur.ch + 1), \"+delete\");\n    }\n  }\n\n  function handleEnter(cm) {\n    var conf = getConfig(cm);\n    var explode = conf && getOption(conf, \"explode\");\n    if (!explode || cm.getOption(\"disableInput\")) return CodeMirror.Pass;\n\n    var ranges = cm.listSelections();\n    for (var i = 0; i < ranges.length; i++) {\n      if (!ranges[i].empty()) return CodeMirror.Pass;\n      var around = charsAround(cm, ranges[i].head);\n      if (!around || explode.indexOf(around) % 2 != 0) return CodeMirror.Pass;\n    }\n    cm.operation(function() {\n      var linesep = cm.lineSeparator() || \"\\n\";\n      cm.replaceSelection(linesep + linesep, null);\n      moveSel(cm, -1)\n      ranges = cm.listSelections();\n      for (var i = 0; i < ranges.length; i++) {\n        var line = ranges[i].head.line;\n        cm.indentLine(line, null, true);\n        cm.indentLine(line + 1, null, true);\n      }\n    });\n  }\n\n  function moveSel(cm, dir) {\n    var newRanges = [], ranges = cm.listSelections(), primary = 0\n    for (var i = 0; i < ranges.length; i++) {\n      var range = ranges[i]\n      if (range.head == cm.getCursor()) primary = i\n      var pos = range.head.ch || dir > 0 ? {line: range.head.line, ch: range.head.ch + dir} : {line: range.head.line - 1}\n      newRanges.push({anchor: pos, head: pos})\n    }\n    cm.setSelections(newRanges, primary)\n  }\n\n  function contractSelection(sel) {\n    var inverted = CodeMirror.cmpPos(sel.anchor, sel.head) > 0;\n    return {anchor: new Pos(sel.anchor.line, sel.anchor.ch + (inverted ? -1 : 1)),\n            head: new Pos(sel.head.line, sel.head.ch + (inverted ? 1 : -1))};\n  }\n\n  function handleChar(cm, ch) {\n    var conf = getConfig(cm);\n    if (!conf || cm.getOption(\"disableInput\")) return CodeMirror.Pass;\n\n    var pairs = getOption(conf, \"pairs\");\n    var pos = pairs.indexOf(ch);\n    if (pos == -1) return CodeMirror.Pass;\n\n    var closeBefore = getOption(conf,\"closeBefore\");\n\n    var triples = getOption(conf, \"triples\");\n\n    var identical = pairs.charAt(pos + 1) == ch;\n    var ranges = cm.listSelections();\n    var opening = pos % 2 == 0;\n\n    var type;\n    for (var i = 0; i < ranges.length; i++) {\n      var range = ranges[i], cur = range.head, curType;\n      var next = cm.getRange(cur, Pos(cur.line, cur.ch + 1));\n      if (opening && !range.empty()) {\n        curType = \"surround\";\n      } else if ((identical || !opening) && next == ch) {\n        if (identical && stringStartsAfter(cm, cur))\n          curType = \"both\";\n        else if (triples.indexOf(ch) >= 0 && cm.getRange(cur, Pos(cur.line, cur.ch + 3)) == ch + ch + ch)\n          curType = \"skipThree\";\n        else\n          curType = \"skip\";\n      } else if (identical && cur.ch > 1 && triples.indexOf(ch) >= 0 &&\n                 cm.getRange(Pos(cur.line, cur.ch - 2), cur) == ch + ch) {\n        if (cur.ch > 2 && /\\bstring/.test(cm.getTokenTypeAt(Pos(cur.line, cur.ch - 2)))) return CodeMirror.Pass;\n        curType = \"addFour\";\n      } else if (identical) {\n        var prev = cur.ch == 0 ? \" \" : cm.getRange(Pos(cur.line, cur.ch - 1), cur)\n        if (!CodeMirror.isWordChar(next) && prev != ch && !CodeMirror.isWordChar(prev)) curType = \"both\";\n        else return CodeMirror.Pass;\n      } else if (opening && (next.length === 0 || /\\s/.test(next) || closeBefore.indexOf(next) > -1)) {\n        curType = \"both\";\n      } else {\n        return CodeMirror.Pass;\n      }\n      if (!type) type = curType;\n      else if (type != curType) return CodeMirror.Pass;\n    }\n\n    var left = pos % 2 ? pairs.charAt(pos - 1) : ch;\n    var right = pos % 2 ? ch : pairs.charAt(pos + 1);\n    cm.operation(function() {\n      if (type == \"skip\") {\n        moveSel(cm, 1)\n      } else if (type == \"skipThree\") {\n        moveSel(cm, 3)\n      } else if (type == \"surround\") {\n        var sels = cm.getSelections();\n        for (var i = 0; i < sels.length; i++)\n          sels[i] = left + sels[i] + right;\n        cm.replaceSelections(sels, \"around\");\n        sels = cm.listSelections().slice();\n        for (var i = 0; i < sels.length; i++)\n          sels[i] = contractSelection(sels[i]);\n        cm.setSelections(sels);\n      } else if (type == \"both\") {\n        cm.replaceSelection(left + right, null);\n        cm.triggerElectric(left + right);\n        moveSel(cm, -1)\n      } else if (type == \"addFour\") {\n        cm.replaceSelection(left + left + left + left, \"before\");\n        moveSel(cm, 1)\n      }\n    });\n  }\n\n  function charsAround(cm, pos) {\n    var str = cm.getRange(Pos(pos.line, pos.ch - 1),\n                          Pos(pos.line, pos.ch + 1));\n    return str.length == 2 ? str : null;\n  }\n\n  function stringStartsAfter(cm, pos) {\n    var token = cm.getTokenAt(Pos(pos.line, pos.ch + 1))\n    return /\\bstring/.test(token.type) && token.start == pos.ch &&\n      (pos.ch == 0 || !/\\bstring/.test(cm.getTokenTypeAt(pos)))\n  }\n});\n"]},"metadata":{},"sourceType":"script"}