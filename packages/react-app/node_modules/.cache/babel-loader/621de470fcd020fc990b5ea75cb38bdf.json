{"ast":null,"code":"// GFM table, https://github.github.com/gfm/#tables-extension-\n'use strict';\n\nvar isSpace = require('../common/utils').isSpace;\n\nfunction getLine(state, line) {\n  var pos = state.bMarks[line] + state.tShift[line],\n      max = state.eMarks[line];\n  return state.src.substr(pos, max - pos);\n}\n\nfunction escapedSplit(str) {\n  var result = [],\n      pos = 0,\n      max = str.length,\n      ch,\n      isEscaped = false,\n      lastPos = 0,\n      current = '';\n  ch = str.charCodeAt(pos);\n\n  while (pos < max) {\n    if (ch === 0x7c\n    /* | */\n    ) {\n      if (!isEscaped) {\n        // pipe separating cells, '|'\n        result.push(current + str.substring(lastPos, pos));\n        current = '';\n        lastPos = pos + 1;\n      } else {\n        // escaped pipe, '\\|'\n        current += str.substring(lastPos, pos - 1);\n        lastPos = pos;\n      }\n    }\n\n    isEscaped = ch === 0x5c\n    /* \\ */\n    ;\n    pos++;\n    ch = str.charCodeAt(pos);\n  }\n\n  result.push(current + str.substring(lastPos));\n  return result;\n}\n\nmodule.exports = function table(state, startLine, endLine, silent) {\n  var ch, lineText, pos, i, l, nextLine, columns, columnCount, token, aligns, t, tableLines, tbodyLines, oldParentType, terminate, terminatorRules, firstCh, secondCh; // should have at least two lines\n\n  if (startLine + 2 > endLine) {\n    return false;\n  }\n\n  nextLine = startLine + 1;\n\n  if (state.sCount[nextLine] < state.blkIndent) {\n    return false;\n  } // if it's indented more than 3 spaces, it should be a code block\n\n\n  if (state.sCount[nextLine] - state.blkIndent >= 4) {\n    return false;\n  } // first character of the second line should be '|', '-', ':',\n  // and no other characters are allowed but spaces;\n  // basically, this is the equivalent of /^[-:|][-:|\\s]*$/ regexp\n\n\n  pos = state.bMarks[nextLine] + state.tShift[nextLine];\n\n  if (pos >= state.eMarks[nextLine]) {\n    return false;\n  }\n\n  firstCh = state.src.charCodeAt(pos++);\n\n  if (firstCh !== 0x7C\n  /* | */\n  && firstCh !== 0x2D\n  /* - */\n  && firstCh !== 0x3A\n  /* : */\n  ) {\n    return false;\n  }\n\n  if (pos >= state.eMarks[nextLine]) {\n    return false;\n  }\n\n  secondCh = state.src.charCodeAt(pos++);\n\n  if (secondCh !== 0x7C\n  /* | */\n  && secondCh !== 0x2D\n  /* - */\n  && secondCh !== 0x3A\n  /* : */\n  && !isSpace(secondCh)) {\n    return false;\n  } // if first character is '-', then second character must not be a space\n  // (due to parsing ambiguity with list)\n\n\n  if (firstCh === 0x2D\n  /* - */\n  && isSpace(secondCh)) {\n    return false;\n  }\n\n  while (pos < state.eMarks[nextLine]) {\n    ch = state.src.charCodeAt(pos);\n\n    if (ch !== 0x7C\n    /* | */\n    && ch !== 0x2D\n    /* - */\n    && ch !== 0x3A\n    /* : */\n    && !isSpace(ch)) {\n      return false;\n    }\n\n    pos++;\n  }\n\n  lineText = getLine(state, startLine + 1);\n  columns = lineText.split('|');\n  aligns = [];\n\n  for (i = 0; i < columns.length; i++) {\n    t = columns[i].trim();\n\n    if (!t) {\n      // allow empty columns before and after table, but not in between columns;\n      // e.g. allow ` |---| `, disallow ` ---||--- `\n      if (i === 0 || i === columns.length - 1) {\n        continue;\n      } else {\n        return false;\n      }\n    }\n\n    if (!/^:?-+:?$/.test(t)) {\n      return false;\n    }\n\n    if (t.charCodeAt(t.length - 1) === 0x3A\n    /* : */\n    ) {\n      aligns.push(t.charCodeAt(0) === 0x3A\n      /* : */\n      ? 'center' : 'right');\n    } else if (t.charCodeAt(0) === 0x3A\n    /* : */\n    ) {\n      aligns.push('left');\n    } else {\n      aligns.push('');\n    }\n  }\n\n  lineText = getLine(state, startLine).trim();\n\n  if (lineText.indexOf('|') === -1) {\n    return false;\n  }\n\n  if (state.sCount[startLine] - state.blkIndent >= 4) {\n    return false;\n  }\n\n  columns = escapedSplit(lineText);\n  if (columns.length && columns[0] === '') columns.shift();\n  if (columns.length && columns[columns.length - 1] === '') columns.pop(); // header row will define an amount of columns in the entire table,\n  // and align row should be exactly the same (the rest of the rows can differ)\n\n  columnCount = columns.length;\n\n  if (columnCount === 0 || columnCount !== aligns.length) {\n    return false;\n  }\n\n  if (silent) {\n    return true;\n  }\n\n  oldParentType = state.parentType;\n  state.parentType = 'table'; // use 'blockquote' lists for termination because it's\n  // the most similar to tables\n\n  terminatorRules = state.md.block.ruler.getRules('blockquote');\n  token = state.push('table_open', 'table', 1);\n  token.map = tableLines = [startLine, 0];\n  token = state.push('thead_open', 'thead', 1);\n  token.map = [startLine, startLine + 1];\n  token = state.push('tr_open', 'tr', 1);\n  token.map = [startLine, startLine + 1];\n\n  for (i = 0; i < columns.length; i++) {\n    token = state.push('th_open', 'th', 1);\n\n    if (aligns[i]) {\n      token.attrs = [['style', 'text-align:' + aligns[i]]];\n    }\n\n    token = state.push('inline', '', 0);\n    token.content = columns[i].trim();\n    token.children = [];\n    token = state.push('th_close', 'th', -1);\n  }\n\n  token = state.push('tr_close', 'tr', -1);\n  token = state.push('thead_close', 'thead', -1);\n\n  for (nextLine = startLine + 2; nextLine < endLine; nextLine++) {\n    if (state.sCount[nextLine] < state.blkIndent) {\n      break;\n    }\n\n    terminate = false;\n\n    for (i = 0, l = terminatorRules.length; i < l; i++) {\n      if (terminatorRules[i](state, nextLine, endLine, true)) {\n        terminate = true;\n        break;\n      }\n    }\n\n    if (terminate) {\n      break;\n    }\n\n    lineText = getLine(state, nextLine).trim();\n\n    if (!lineText) {\n      break;\n    }\n\n    if (state.sCount[nextLine] - state.blkIndent >= 4) {\n      break;\n    }\n\n    columns = escapedSplit(lineText);\n    if (columns.length && columns[0] === '') columns.shift();\n    if (columns.length && columns[columns.length - 1] === '') columns.pop();\n\n    if (nextLine === startLine + 2) {\n      token = state.push('tbody_open', 'tbody', 1);\n      token.map = tbodyLines = [startLine + 2, 0];\n    }\n\n    token = state.push('tr_open', 'tr', 1);\n    token.map = [nextLine, nextLine + 1];\n\n    for (i = 0; i < columnCount; i++) {\n      token = state.push('td_open', 'td', 1);\n\n      if (aligns[i]) {\n        token.attrs = [['style', 'text-align:' + aligns[i]]];\n      }\n\n      token = state.push('inline', '', 0);\n      token.content = columns[i] ? columns[i].trim() : '';\n      token.children = [];\n      token = state.push('td_close', 'td', -1);\n    }\n\n    token = state.push('tr_close', 'tr', -1);\n  }\n\n  if (tbodyLines) {\n    token = state.push('tbody_close', 'tbody', -1);\n    tbodyLines[1] = nextLine;\n  }\n\n  token = state.push('table_close', 'table', -1);\n  tableLines[1] = nextLine;\n  state.parentType = oldParentType;\n  state.line = nextLine;\n  return true;\n};","map":{"version":3,"sources":["/Users/sam/Desktop/kiwik/node_modules/markdown-it/lib/rules_block/table.js"],"names":["isSpace","require","getLine","state","line","pos","bMarks","tShift","max","eMarks","src","substr","escapedSplit","str","result","length","ch","isEscaped","lastPos","current","charCodeAt","push","substring","module","exports","table","startLine","endLine","silent","lineText","i","l","nextLine","columns","columnCount","token","aligns","t","tableLines","tbodyLines","oldParentType","terminate","terminatorRules","firstCh","secondCh","sCount","blkIndent","split","trim","test","indexOf","shift","pop","parentType","md","block","ruler","getRules","map","attrs","content","children"],"mappings":"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","sourcesContent":["// GFM table, https://github.github.com/gfm/#tables-extension-\n\n'use strict';\n\nvar isSpace = require('../common/utils').isSpace;\n\n\nfunction getLine(state, line) {\n  var pos = state.bMarks[line] + state.tShift[line],\n      max = state.eMarks[line];\n\n  return state.src.substr(pos, max - pos);\n}\n\nfunction escapedSplit(str) {\n  var result = [],\n      pos = 0,\n      max = str.length,\n      ch,\n      isEscaped = false,\n      lastPos = 0,\n      current = '';\n\n  ch  = str.charCodeAt(pos);\n\n  while (pos < max) {\n    if (ch === 0x7c/* | */) {\n      if (!isEscaped) {\n        // pipe separating cells, '|'\n        result.push(current + str.substring(lastPos, pos));\n        current = '';\n        lastPos = pos + 1;\n      } else {\n        // escaped pipe, '\\|'\n        current += str.substring(lastPos, pos - 1);\n        lastPos = pos;\n      }\n    }\n\n    isEscaped = (ch === 0x5c/* \\ */);\n    pos++;\n\n    ch = str.charCodeAt(pos);\n  }\n\n  result.push(current + str.substring(lastPos));\n\n  return result;\n}\n\n\nmodule.exports = function table(state, startLine, endLine, silent) {\n  var ch, lineText, pos, i, l, nextLine, columns, columnCount, token,\n      aligns, t, tableLines, tbodyLines, oldParentType, terminate,\n      terminatorRules, firstCh, secondCh;\n\n  // should have at least two lines\n  if (startLine + 2 > endLine) { return false; }\n\n  nextLine = startLine + 1;\n\n  if (state.sCount[nextLine] < state.blkIndent) { return false; }\n\n  // if it's indented more than 3 spaces, it should be a code block\n  if (state.sCount[nextLine] - state.blkIndent >= 4) { return false; }\n\n  // first character of the second line should be '|', '-', ':',\n  // and no other characters are allowed but spaces;\n  // basically, this is the equivalent of /^[-:|][-:|\\s]*$/ regexp\n\n  pos = state.bMarks[nextLine] + state.tShift[nextLine];\n  if (pos >= state.eMarks[nextLine]) { return false; }\n\n  firstCh = state.src.charCodeAt(pos++);\n  if (firstCh !== 0x7C/* | */ && firstCh !== 0x2D/* - */ && firstCh !== 0x3A/* : */) { return false; }\n\n  if (pos >= state.eMarks[nextLine]) { return false; }\n\n  secondCh = state.src.charCodeAt(pos++);\n  if (secondCh !== 0x7C/* | */ && secondCh !== 0x2D/* - */ && secondCh !== 0x3A/* : */ && !isSpace(secondCh)) {\n    return false;\n  }\n\n  // if first character is '-', then second character must not be a space\n  // (due to parsing ambiguity with list)\n  if (firstCh === 0x2D/* - */ && isSpace(secondCh)) { return false; }\n\n  while (pos < state.eMarks[nextLine]) {\n    ch = state.src.charCodeAt(pos);\n\n    if (ch !== 0x7C/* | */ && ch !== 0x2D/* - */ && ch !== 0x3A/* : */ && !isSpace(ch)) { return false; }\n\n    pos++;\n  }\n\n  lineText = getLine(state, startLine + 1);\n\n  columns = lineText.split('|');\n  aligns = [];\n  for (i = 0; i < columns.length; i++) {\n    t = columns[i].trim();\n    if (!t) {\n      // allow empty columns before and after table, but not in between columns;\n      // e.g. allow ` |---| `, disallow ` ---||--- `\n      if (i === 0 || i === columns.length - 1) {\n        continue;\n      } else {\n        return false;\n      }\n    }\n\n    if (!/^:?-+:?$/.test(t)) { return false; }\n    if (t.charCodeAt(t.length - 1) === 0x3A/* : */) {\n      aligns.push(t.charCodeAt(0) === 0x3A/* : */ ? 'center' : 'right');\n    } else if (t.charCodeAt(0) === 0x3A/* : */) {\n      aligns.push('left');\n    } else {\n      aligns.push('');\n    }\n  }\n\n  lineText = getLine(state, startLine).trim();\n  if (lineText.indexOf('|') === -1) { return false; }\n  if (state.sCount[startLine] - state.blkIndent >= 4) { return false; }\n  columns = escapedSplit(lineText);\n  if (columns.length && columns[0] === '') columns.shift();\n  if (columns.length && columns[columns.length - 1] === '') columns.pop();\n\n  // header row will define an amount of columns in the entire table,\n  // and align row should be exactly the same (the rest of the rows can differ)\n  columnCount = columns.length;\n  if (columnCount === 0 || columnCount !== aligns.length) { return false; }\n\n  if (silent) { return true; }\n\n  oldParentType = state.parentType;\n  state.parentType = 'table';\n\n  // use 'blockquote' lists for termination because it's\n  // the most similar to tables\n  terminatorRules = state.md.block.ruler.getRules('blockquote');\n\n  token     = state.push('table_open', 'table', 1);\n  token.map = tableLines = [ startLine, 0 ];\n\n  token     = state.push('thead_open', 'thead', 1);\n  token.map = [ startLine, startLine + 1 ];\n\n  token     = state.push('tr_open', 'tr', 1);\n  token.map = [ startLine, startLine + 1 ];\n\n  for (i = 0; i < columns.length; i++) {\n    token          = state.push('th_open', 'th', 1);\n    if (aligns[i]) {\n      token.attrs  = [ [ 'style', 'text-align:' + aligns[i] ] ];\n    }\n\n    token          = state.push('inline', '', 0);\n    token.content  = columns[i].trim();\n    token.children = [];\n\n    token          = state.push('th_close', 'th', -1);\n  }\n\n  token     = state.push('tr_close', 'tr', -1);\n  token     = state.push('thead_close', 'thead', -1);\n\n  for (nextLine = startLine + 2; nextLine < endLine; nextLine++) {\n    if (state.sCount[nextLine] < state.blkIndent) { break; }\n\n    terminate = false;\n    for (i = 0, l = terminatorRules.length; i < l; i++) {\n      if (terminatorRules[i](state, nextLine, endLine, true)) {\n        terminate = true;\n        break;\n      }\n    }\n\n    if (terminate) { break; }\n    lineText = getLine(state, nextLine).trim();\n    if (!lineText) { break; }\n    if (state.sCount[nextLine] - state.blkIndent >= 4) { break; }\n    columns = escapedSplit(lineText);\n    if (columns.length && columns[0] === '') columns.shift();\n    if (columns.length && columns[columns.length - 1] === '') columns.pop();\n\n    if (nextLine === startLine + 2) {\n      token     = state.push('tbody_open', 'tbody', 1);\n      token.map = tbodyLines = [ startLine + 2, 0 ];\n    }\n\n    token     = state.push('tr_open', 'tr', 1);\n    token.map = [ nextLine, nextLine + 1 ];\n\n    for (i = 0; i < columnCount; i++) {\n      token          = state.push('td_open', 'td', 1);\n      if (aligns[i]) {\n        token.attrs  = [ [ 'style', 'text-align:' + aligns[i] ] ];\n      }\n\n      token          = state.push('inline', '', 0);\n      token.content  = columns[i] ? columns[i].trim() : '';\n      token.children = [];\n\n      token          = state.push('td_close', 'td', -1);\n    }\n    token = state.push('tr_close', 'tr', -1);\n  }\n\n  if (tbodyLines) {\n    token = state.push('tbody_close', 'tbody', -1);\n    tbodyLines[1] = nextLine;\n  }\n\n  token = state.push('table_close', 'table', -1);\n  tableLines[1] = nextLine;\n\n  state.parentType = oldParentType;\n  state.line = nextLine;\n  return true;\n};\n"]},"metadata":{},"sourceType":"script"}