{"ast":null,"code":"\"use strict\";\n\nimport _classCallCheck from \"/Users/sam/Desktop/kiwik/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/sam/Desktop/kiwik/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/sam/Desktop/kiwik/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/sam/Desktop/kiwik/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport { Coder } from \"./abstract-coder\";\nimport { pack, unpack } from \"./array\";\nexport var TupleCoder = /*#__PURE__*/function (_Coder) {\n  _inherits(TupleCoder, _Coder);\n\n  var _super = _createSuper(TupleCoder);\n\n  function TupleCoder(coders, localName) {\n    var _this;\n\n    _classCallCheck(this, TupleCoder);\n\n    var dynamic = false;\n    var types = [];\n    coders.forEach(function (coder) {\n      if (coder.dynamic) {\n        dynamic = true;\n      }\n\n      types.push(coder.type);\n    });\n    var type = \"tuple(\" + types.join(\",\") + \")\";\n    _this = _super.call(this, \"tuple\", type, localName, dynamic);\n    _this.coders = coders;\n    return _this;\n  }\n\n  _createClass(TupleCoder, [{\n    key: \"defaultValue\",\n    value: function defaultValue() {\n      var values = [];\n      this.coders.forEach(function (coder) {\n        values.push(coder.defaultValue());\n      }); // We only output named properties for uniquely named coders\n\n      var uniqueNames = this.coders.reduce(function (accum, coder) {\n        var name = coder.localName;\n\n        if (name) {\n          if (!accum[name]) {\n            accum[name] = 0;\n          }\n\n          accum[name]++;\n        }\n\n        return accum;\n      }, {}); // Add named values\n\n      this.coders.forEach(function (coder, index) {\n        var name = coder.localName;\n\n        if (!name || uniqueNames[name] !== 1) {\n          return;\n        }\n\n        if (name === \"length\") {\n          name = \"_length\";\n        }\n\n        if (values[name] != null) {\n          return;\n        }\n\n        values[name] = values[index];\n      });\n      return Object.freeze(values);\n    }\n  }, {\n    key: \"encode\",\n    value: function encode(writer, value) {\n      return pack(writer, this.coders, value);\n    }\n  }, {\n    key: \"decode\",\n    value: function decode(reader) {\n      return reader.coerce(this.name, unpack(reader, this.coders));\n    }\n  }]);\n\n  return TupleCoder;\n}(Coder);","map":{"version":3,"sources":["../../src.ts/coders/tuple.ts"],"names":[],"mappings":"AAAA;;;;;;AAEA,SAAS,KAAT,QAAsC,kBAAtC;AACA,SAAS,IAAT,EAAe,MAAf,QAA6B,SAA7B;AAEA,WAAa,UAAb;AAAA;;AAAA;;AAGI,sBAAY,MAAZ,EAAkC,SAAlC,EAAmD;AAAA;;AAAA;;AAC/C,QAAI,OAAO,GAAG,KAAd;AACA,QAAM,KAAK,GAAkB,EAA7B;AACA,IAAA,MAAM,CAAC,OAAP,CAAe,UAAC,KAAD,EAAU;AACrB,UAAI,KAAK,CAAC,OAAV,EAAmB;AAAE,QAAA,OAAO,GAAG,IAAV;AAAiB;;AACtC,MAAA,KAAK,CAAC,IAAN,CAAW,KAAK,CAAC,IAAjB;AACH,KAHD;AAIA,QAAM,IAAI,GAAI,WAAW,KAAK,CAAC,IAAN,CAAW,GAAX,CAAX,GAA6B,GAA3C;AAEA,8BAAM,OAAN,EAAe,IAAf,EAAqB,SAArB,EAAgC,OAAhC;AACA,UAAK,MAAL,GAAc,MAAd;AAV+C;AAWlD;;AAdL;AAAA;AAAA,WAgBI,wBAAY;AACR,UAAM,MAAM,GAAQ,EAApB;AACA,WAAK,MAAL,CAAY,OAAZ,CAAoB,UAAC,KAAD,EAAU;AAC1B,QAAA,MAAM,CAAC,IAAP,CAAY,KAAK,CAAC,YAAN,EAAZ;AACH,OAFD,EAFQ,CAMR;;AACA,UAAM,WAAW,GAAG,KAAK,MAAL,CAAY,MAAZ,CAAmB,UAAC,KAAD,EAAQ,KAAR,EAAiB;AACpD,YAAM,IAAI,GAAG,KAAK,CAAC,SAAnB;;AACA,YAAI,IAAJ,EAAU;AACN,cAAI,CAAC,KAAK,CAAC,IAAD,CAAV,EAAkB;AAAE,YAAA,KAAK,CAAC,IAAD,CAAL,GAAc,CAAd;AAAkB;;AACtC,UAAA,KAAK,CAAC,IAAD,CAAL;AACH;;AACD,eAAO,KAAP;AACH,OAPmB,EAOa,EAPb,CAApB,CAPQ,CAgBR;;AACA,WAAK,MAAL,CAAY,OAAZ,CAAoB,UAAC,KAAD,EAAe,KAAf,EAAgC;AAChD,YAAI,IAAI,GAAG,KAAK,CAAC,SAAjB;;AACA,YAAI,CAAC,IAAD,IAAS,WAAW,CAAC,IAAD,CAAX,KAAsB,CAAnC,EAAsC;AAAE;AAAS;;AAEjD,YAAI,IAAI,KAAK,QAAb,EAAuB;AAAE,UAAA,IAAI,GAAG,SAAP;AAAmB;;AAE5C,YAAI,MAAM,CAAC,IAAD,CAAN,IAAgB,IAApB,EAA0B;AAAE;AAAS;;AAErC,QAAA,MAAM,CAAC,IAAD,CAAN,GAAe,MAAM,CAAC,KAAD,CAArB;AACH,OATD;AAWA,aAAO,MAAM,CAAC,MAAP,CAAc,MAAd,CAAP;AACH;AA7CL;AAAA;AAAA,WA+CI,gBAAO,MAAP,EAAuB,KAAvB,EAAoE;AAChE,aAAO,IAAI,CAAC,MAAD,EAAS,KAAK,MAAd,EAAsB,KAAtB,CAAX;AACH;AAjDL;AAAA;AAAA,WAmDI,gBAAO,MAAP,EAAqB;AACjB,aAAO,MAAM,CAAC,MAAP,CAAc,KAAK,IAAnB,EAAyB,MAAM,CAAC,MAAD,EAAS,KAAK,MAAd,CAA/B,CAAP;AACH;AArDL;;AAAA;AAAA,EAAgC,KAAhC","sourceRoot":"","sourcesContent":["\"use strict\";\nimport { Coder } from \"./abstract-coder\";\nimport { pack, unpack } from \"./array\";\nexport class TupleCoder extends Coder {\n    constructor(coders, localName) {\n        let dynamic = false;\n        const types = [];\n        coders.forEach((coder) => {\n            if (coder.dynamic) {\n                dynamic = true;\n            }\n            types.push(coder.type);\n        });\n        const type = (\"tuple(\" + types.join(\",\") + \")\");\n        super(\"tuple\", type, localName, dynamic);\n        this.coders = coders;\n    }\n    defaultValue() {\n        const values = [];\n        this.coders.forEach((coder) => {\n            values.push(coder.defaultValue());\n        });\n        // We only output named properties for uniquely named coders\n        const uniqueNames = this.coders.reduce((accum, coder) => {\n            const name = coder.localName;\n            if (name) {\n                if (!accum[name]) {\n                    accum[name] = 0;\n                }\n                accum[name]++;\n            }\n            return accum;\n        }, {});\n        // Add named values\n        this.coders.forEach((coder, index) => {\n            let name = coder.localName;\n            if (!name || uniqueNames[name] !== 1) {\n                return;\n            }\n            if (name === \"length\") {\n                name = \"_length\";\n            }\n            if (values[name] != null) {\n                return;\n            }\n            values[name] = values[index];\n        });\n        return Object.freeze(values);\n    }\n    encode(writer, value) {\n        return pack(writer, this.coders, value);\n    }\n    decode(reader) {\n        return reader.coerce(this.name, unpack(reader, this.coders));\n    }\n}\n//# sourceMappingURL=tuple.js.map"]},"metadata":{},"sourceType":"module"}